<!DOCTYPE html>
<title>Content from Imgur</title>
<style>body,iframe{margin:0!important}</style>
<blockquote class="imgur-embed-pub"></blockquote>
<script>
(function()
{
	// Replace %2F with / to handle [media=imgur]gallery/xyz[/media] in XF 1.x
	document.body.firstChild.setAttribute('data-id', location.hash.substr(1).replace('%2F', '/').replace('gallery', 'a'));

	let height, port, width;
	onmessage = function (e)
	{
		if (e.data === 's9e:init')
		{
			port = e.ports[0];
			e.stopImmediatePropagation();
		}
		else if (/^\{.*"message":"resize_imgur"/.test(e.data))
		{
			let data = JSON.parse(e.data);

			// Imgur doesn't include the border's width/height in its dimensions
			height = 2 + data.height;
			width  = 2 + data.width;
		}

		// NOTE: Imgur sometimes reports 0 width
		if (height > 2 && port && width > 2)
		{
			port.postMessage(height + ' ' + width);
		}
	};
})();
</script>
<script src="//s.imgur.com/min/embed.js"></script>