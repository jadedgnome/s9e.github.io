<!DOCTYPE html>
<title>Content from Facebook</title>
<link rel="preconnect" crossorigin="" href="//www.facebook.com">
<!-- Sometimes Facebook tries to resize to 1000px then 552px if it fails -->
<style>iframe{width:100vw !important}</style>
<body style="margin:0">
<script>
((document, hash, window) =>
{
	let body = document.body,
		lang = (window.navigator || {}).language || 'enUS',
		// Facebook insists on having a username for posts. This one is "Bob"
		path = 'Bob/',
		type = 'post',
		height,
		id,
		m,
		port;

	if (m = /^#([.\w]+\/)(\w+)$/.exec(hash))
	{
		// #username/123
		// #username/pfbidXXX
		path = m[1];
		id   = m[2];
	}
	else if (m = /^#([prv])(\d+)$/.exec(hash))
	{
		// #p123, #r123, or #v123
		id = m[2];
		if (m[1] !== 'p')
		{
			type = 'video';
			path = 'v/';
		}
	}
	else
	{
		// #123 or #pfbidXXX
		id = hash.replace(/\W/g, '');
	}

	body.innerHTML = '<div data-href=//www.facebook.com/' + path + type + 's/' + id + ' class=fb-' + type + '>Cannot load Facebook SDK. Disable any adblocker or tracking protection and try again.</div>';

	window.addEventListener(
		'message',
		(event) =>
		{
			const e = /** @type {!MessageEvent} */ (event);

			let m;
			if (m = /type=resize.*height=(\d+)/.exec(e.data))
			{
				height = +m[1];
			}
			else if (e.data === 's9e:init' && !port)
			{
				port = e.ports[0];
			}

			if (port && height)
			{
				port.postMessage(height);
			}
		},
		{ 'capture': true }
	);

	window.onload = () =>
	{
		const script = /** @type {!HTMLScriptElement} */ (document.createElement('script'));
		script.src = '//connect.facebook.net/' + lang.substring(0, 2) + '_' + lang.toUpperCase().substring(lang.length - 2) + '/sdk.js#xfbml=1&version=v14.0';
		body.appendChild(script);
	};
})(document, location.hash, window);
</script>