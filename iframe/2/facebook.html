<!DOCTYPE html>
<title>Content from Facebook</title>
<link rel="preconnect" crossorigin="" href="//www.facebook.com">
<!-- Sometimes Facebook tries to resize to 1000px then 552px if it fails -->
<style>iframe{width:100vw !important}</style>
<body style="margin:0">
<script>
((document, hash, window) =>
{
	const [type, path, id] = ((m) =>
	{
		// #username/123:123
		if (m)
		{
			m[0] = 'post';

			return m;
		}

		// #p123, #r123, or #v123
		if (m = /^#[prv](\d+)$/.exec(hash))
		{
			// Facebook insists on having a username for posts. This one is "Bob"
			return /p/.test(hash)
			     ? ['post',  'Bob/', m[1]]
			     : ['video', 'v/',   m[1]];
		}

		// #pfbidXXX
		return ['post', 'Bob/', hash.replace(/\W/g, '')];
	})(/^#([.\w]+\/)([:\d]+)$/.exec(hash));

	const body = document.body,
	      lang = (window.navigator || {}).language || 'enUS';

	body.innerHTML = '<div data-href=//www.facebook.com/' + path + type + 's/' + id + ' class=fb-' + type + '>Cannot load Facebook SDK. Disable any adblocker or tracking protection and try again.</div>';

	let height, port;
	window.addEventListener(
		'message',
		(event) =>
		{
			const e = /** @type {!MessageEvent} */ (event);

			let m;
			if (m = /type=resize.*height=(\d+)/.exec(e.data))
			{
				height = +m[1];
			}
			else if (e.data === 's9e:init' && !port)
			{
				port = e.ports[0];
			}

			if (port && height)
			{
				port.postMessage(height);
			}
		},
		{ 'capture': true }
	);

	window.onload = () =>
	{
		const script = /** @type {!HTMLScriptElement} */ (document.createElement('script'));
		script.src = '//connect.facebook.net/' + lang.substring(0, 2) + '_' + lang.toUpperCase().substring(lang.length - 2) + '/sdk.js#xfbml=1&version=v14.0';
		body.appendChild(script);
	};
})(document, location.hash, window);
</script>