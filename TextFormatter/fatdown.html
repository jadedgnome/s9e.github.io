<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8" />
	<title>s9e\TextFormatter &bull; Fatdown/JS Demo</title>
	<base href="http://s9e.github.io/TextFormatter/fatdown.html" />
	<style type="text/css">
		#preview
		{
			font-family: sans;
			padding: 5px;
			background-color: #f8f8f8;
			border: dashed 1px #ddd;
			border-radius: 5px;
		}
		pre, code
		{
			padding: 2px;
			background-color: #fff;
			border-radius: 3px;
			border: solid 1px #ddd;
		}
		pre code
		{
			border: 0;
		}
		blockquote
		{
			background-color: #fff;
			border: solid 1px #ddd;
			border-left-width: 4px;
			padding-left: 1em;
		}
		p
		{
			margin: 0;
		}
	</style>

</head>
<body>
	<div style="float:left;width:80%;max-width:800px">
		<form>
			<textarea style="width:99%" rows="15">The Fatdown bundle includes the following plugins:

 - **Autoemail** --- email addresses such as example@example.org are automatically turned into links
 - **Autolink** --- URLs such as http://github.com are automatically turned into links
 - **Escaper** --- special characters can be escaped with a backslash like \*this\*
 - **FancyPants** --- some typography is enhanced, e.g. (c) (tm) and "quotes"
 - **HTMLComments** --- you can use HTML comments <!-- like this one -->
 - **HTMLElements** --- several HTML elements such as <sub>sub</sub> and <sup>sup</sup> are allowed
 - **HTMLEntities** --- HTML entities such as &amp;hearts; are decoded
 - **Litedown** --- a Markdown*-like* syntax
 - **MediaEmbed** --- URLs from media sites are automatically embedded:  
   http://youtu.be/QH2-TGUlwu4

***

The parser/renderer used on this page page has been generated by [this script](https://github.com/s9e/TextFormatter/blob/master/scripts/generateFatdownDemo.php). It's been minified with Google Closure Compiler to 31.6 KB (13.1 KB compressed)</textarea>
		</form>
	</div>

	<div style="float:left;">
		<form><input type="checkbox" id="Autoemail" checked="checked" onchange="toggle(this)"><label for="Autoemail">&nbsp;Autoemail</label><br><input type="checkbox" id="Autolink" checked="checked" onchange="toggle(this)"><label for="Autolink">&nbsp;Autolink</label><br><input type="checkbox" id="Escaper" checked="checked" onchange="toggle(this)"><label for="Escaper">&nbsp;Escaper</label><br><input type="checkbox" id="FancyPants" checked="checked" onchange="toggle(this)"><label for="FancyPants">&nbsp;FancyPants</label><br><input type="checkbox" id="HTMLComments" checked="checked" onchange="toggle(this)"><label for="HTMLComments">&nbsp;HTMLComments</label><br><input type="checkbox" id="HTMLElements" checked="checked" onchange="toggle(this)"><label for="HTMLElements">&nbsp;HTMLElements</label><br><input type="checkbox" id="HTMLEntities" checked="checked" onchange="toggle(this)"><label for="HTMLEntities">&nbsp;HTMLEntities</label><br><input type="checkbox" id="Litedown" checked="checked" onchange="toggle(this)"><label for="Litedown">&nbsp;Litedown</label><br><input type="checkbox" id="MediaEmbed" checked="checked" onchange="toggle(this)"><label for="MediaEmbed">&nbsp;MediaEmbed</label></form>
	</div>

	<div style="clear:both"></div>

	<div id="preview"></div>

	<script type="text/javascript">(function(){var m=[0,0],n=["","id"],da={d:0},fa={d:514},ga={d:3137},ha=[65086,7936],ja={d:3397},ka={d:3073},la={d:3201},ma=[65282,16144],na=[65343,16160],q=[65295,16128],oa={o:!0},pa=[65286,16128],qa=[57119,16160],ra=[65346,16128],r={o:!1},sa=[65282,16128],ta={"class":r},wa=["url",/^(\d+)$/,n],t={C:1,EM:1,EMAIL:1,STRONG:1,URL:1,"html:b":1,"html:code":1,"html:i":1,"html:strong":1,"html:u":1},ya={d:268,q:t},za={d:3460,q:t};function Aa(a,b){return Ba(a,b)}
function Ca(a,b){var c;a:{c=Da;if(b.j){var d,e,f=Ea(a);for(d in f){var h=f[d];if(b.j[d]){if(e=b.j[d],e.b){c.p(d);for(var g=0;g<e.b.length;++g)if(h=e.b[g](h,d),!1===h){delete a.j[d];break}!1!==h&&a.p(d,h)}}else delete a.j[d]}for(d in b.j)if(e=b.j[d],!(d in a.j)&&e.o){c=!1;break a}}else Fa(a,{});c=!0}return c}
var Ia=[function(a){return u(a,/^\d+$/)}],y=[Ca],Ja=[function(a){return u(a,/^[-\w]+$/)}],Ka={b:[function(a){return/^[-\w+., ]+$/.test(a)?a:!1}],o:!1},Pa=[function(a){var b=La.urlConfig,c=Da,d=Ma(a.replace(/^\s+/,"").replace(/\s+$/,""));Na(b,d)?(c&&(d.attrValue=a),a=!1):a=Oa(d);return a}],Qa={w:{"html:td":1,"html:th":1},d:264,q:t},Ra={w:{"html:dd":1,"html:dt":1},d:256,q:t},A={b:Ia,o:!1},Wa={b:Ja,o:!1},E={b:Pa,o:!1},Xa={w:{"html:rb":1,"html:rp":1,"html:rt":1,"html:rtc":1},d:256,q:t},Ya={b:Pa,o:!0},
Za={c:m,f:3,b:y,g:10,e:{d:66},i:1E3},$a={c:q,f:3,b:y,g:10,e:{d:2},i:1E3},ab={c:q,f:3,b:y,g:10,e:da,i:1E3},bb={c:na,f:3,b:y,g:10,e:{d:512},i:1E3},cb={c:pa,j:{"char":oa},f:2,b:y,g:10,e:ka,i:1E3},db=[Aa,Ca],eb={c:q,f:5,b:y,g:10,e:{d:260,q:t},i:1E3},fb={c:ra,f:4,b:y,g:10,e:za,i:1E3},gb={id:{b:Ia,o:!0},url:E},hb={c:na,f:6,b:y,g:10,e:{w:{LI:1,"html:li":1},d:264,q:t},i:1E3};function ib(a){a:{for(var b in Ea(a))if("url"!==b){a=!0;break a}a=!1}return a}
var jb=[Aa,Ca,ib],kb='<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:html="urn:s9e:TextFormatter:html" exclude-result-prefixes="html"><xsl:output method="html" encoding="utf-8" indent="no"/>$aBANDCAMP"><$v$hbandcamp"$j$f400px"><$v$j$e100%"><$s$i"$nno"$j$b><$p$xsrc">//bandcamp.com/EmbeddedPlayer/size=large/minimal=true/<$o><$m$r@album_id">album=$d@album_id"/><$t$r@track_num">/t=$d@track_num"/></$t></$m><$k>track=$d@track_id"/></$k></$o></$p></$s></$v></$v>$c$aC"><code>$g</code>$c$aCODE"><pre><code><$t$r@lang"><$p$xclass">language-$d@lang"/></$p></$t>$g</code></pre>$c$aDAILYMOTION"><$v$hdailymotion"$j$f640px"><$v$j$e56.25%"><$s$i"$nno"$u//www.dailymotion.com/embed/video/{@id}"$j$b/></$v></$v>$c$aDEL|EM|H1|H2|H3|H4|H5|H6|LI|STRONG|SUP|html:b|html:br|html:code|html:dd|html:del|html:dl|html:dt|html:i|html:ins|html:li|html:ol|html:pre|html:rb|html:rp|html:rt|html:rtc|html:ruby|html:strong|html:sub|html:sup|html:table|html:tbody|html:tfoot|html:thead|html:tr|html:u|html:ul|p"><xsl:element$x{translate(local-name(),\'DEGHILMNOPRSTU\',\'deghilmnoprstu\')}">$g</xsl:element>$c$aEMAIL"><a href="mailto:{@email}">$g</a>$c$aESC">$g$c$aFACEBOOK"><$s$hfacebook"$i" onload="var a=Math.random();window.addEventListener(\'message\',function(b){{if(b.data.id==a)style.height=b.data.height+\'px\'}});contentWindow.postMessage(\'s9e:\'+a,\'https://s9e.github.io\')"$nno"$uhttps://s9e.github.io/$s/facebook.min.html#{@id}"$jborder:0;height:360px;max-width:640px;width:100%"/>$c$aFP|HE">$d@char"/>$c$aHC"><xsl:comment>$d@content"/></xsl:comment>$c$aHR"><hr/>$c$aIMG"><img$u{@src}">$lalt|@title"/></img>$c$aLIST"><$o><$m$rnot(@type)"><ul>$g</ul></$m><$k><ol>$lstart"/>$g</ol></$k></$o>$c$aLIVELEAK"><$v$hliveleak"$j$f640px"><$v$j$e56.25%"><$s$i"$nno"$uhttp://www.liveleak.com/ll_embed?i={@id}"$j$b/></$v></$v>$c$aQUOTE"><blockquote>$g</blockquote>$c$aSOUNDCLOUD"><$o><$m$r@playlist_id"><$s$h$w$i"$nno"$uhttps://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/playlists/{@playlist_id}"$jborder:0;height:450px;max-width:900px;width:100%"/></$m><$m$r@track_id"><$s$h$w$i"$nno"$uhttps://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/{@track_id}&amp;secret_token={@secret_token}"$j$q/></$m><$m$rnot(contains(@id,\'://\'))"><$s$h$w$i"$nno"$uhttps://w.soundcloud.com/player/?url=https%3A//soundcloud.com/{@id}"$j$q/></$m><$k><$s$h$w$i"$nno"$uhttps://w.soundcloud.com/player/?url={@id}"$j$q/></$k></$o>$c$aSPOTIFY"><$v$hspotify"$j$f400px"><$v$j$e120%"><$s$i"$nno"$j$b><$p$xsrc">https://embed.spotify.com/?view=coverart&amp;uri=<$o><$m$r@uri">$d@uri"/></$m><$k>spotify:$dtranslate(@path,\'/\',\':\')"/></$k></$o></$p></$s></$v></$v>$c$aTWITCH"><$v$htwitch"$j$f640px"><$v$j$e56.25%"><$s$i"$nno"$j$b><$p$xsrc">//player.twitch.tv/?autoplay=false&amp;<$o><$m$r@archive_id">video=a$d@archive_id"/></$m><$m$r@chapter_id">video=c$d@chapter_id"/></$m><$m$r@video_id">video=v$d@video_id"/></$m><$k>channel=$d@channel"/></$k></$o><$t$r@t">&amp;time=$d@t"/></$t></$p></$s></$v></$v>$c$aURL"><a href="{@url}">$g</a>$c$aVIMEO"><$v$hvimeo"$j$f640px"><$v$j$e56.25%"><$s$i"$nno"$u//player.vimeo.com/video/{@id}"$j$b/></$v></$v>$c$aVINE"><$v$hvine"$j$f480px"><$v$j$e100%"><$s$i"$nno"$uhttps://vine.co/v/{@id}/embed/simple?audio=1"$j$b/></$v></$v>$c$aYOUTUBE"><$v$hyoutube"$j$f640px"><$v$j$e56.25%"><$s$i"$nno"$j$b><$p$xsrc">//www.youtube.com/embed/$d@id"/><$t$r@list">?list=$d@list"/></$t><$t$r@t or@m"><$o><$m$r@list">&amp;</$m><$k>?</$k></$o>start=<$o><$m$r@t">$d@t"/></$m><$m$r@h">$d@h*3600+@m*60+@s"/></$m><$k>$d@m*60+@s"/></$k></$o></$t></$p></$s></$v></$v>$c$abr"><br/>$c$ae|i|s"/>$ahtml:abbr"><abbr>$ltitle"/>$g</abbr>$c$ahtml:$v"><$v>$lclass"/>$g</$v>$c$ahtml:img"><img>$lalt|@height|@src|@title|@width"/>$g</img>$c$ahtml:span"><span>$lclass"/>$g</span>$c$ahtml:td"><td>$lcolspan|@rowspan"/>$g</td>$c$ahtml:th"><th>$lcolspan|@rowspan|@scope"/>$g</th>$c</xsl:stylesheet>'.replace(/\$[a-x]/g,function(a){return{$a:'<xsl:template match="',
$b:'border:0;height:100%;left:0;position:absolute;width:100%"',$c:"</xsl:template>",$d:'<xsl:value-of select="',$e:"overflow:hidden;position:relative;padding-bottom:",$f:"display:inline-block;width:100%;max-width:",$g:"<xsl:apply-templates/>",$h:' data-s9e-mediaembed="',$i:' allowfullscreen="',$j:' style="',$k:"xsl:otherwise",$l:'<xsl:copy-of select="@',$m:"xsl:when",$n:' scrolling="',$o:"xsl:choose",$p:"xsl:attribute",$q:'border:0;height:166px;max-width:900px;width:100%"',$r:' test="',$s:"iframe",
$t:"xsl:if",$u:' src="',$v:"div",$w:'soundcloud"',$x:' name="'}[a]});function lb(a){var b=document.createElement("b");lb=function(a){b.innerHTML=a.replace(/</g,"&lt;");return b.textContent};return lb(a)}function mb(a){var b={"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;"};return a.replace(/[<>&"]/g,function(a){return b[a]})}function nb(a){var b={"<":"&lt;",">":"&gt;","&":"&amp;"};return a.replace(/[<>&]/g,function(a){return b[a]})}function ob(){return!0}
function pb(a){return encodeURIComponent(a).replace(/[!'()*]/g,function(a){return"%"+a.charCodeAt(0).toString(16).toUpperCase()})}function u(a,b){return b.test(a)?a:!1}
function Ma(a){var b=/^(?:([a-z][-+.\w]*):)?(?:\/\/(?:([^:\/?#]*)(?::([^\/?#]*)?)?@)?(?:(\[[a-f\d:]+\]|[^:\/?#]+)(?::(\d*))?)?(?![^\/?#]))?([^?#]*)(?:\?([^#]*))?(?:#(.*))?$/i.exec(a),c={};"scheme user pass host port path query fragment".split(" ").forEach(function(a,e){c[a]=""<b[e+1]?b[e+1]:""});c.scheme=c.scheme.toLowerCase();c.host=c.host.replace(/[\u3002\uff0e\uff61]/g,".").replace(/\.+$/g,"");/[^\x00-\x7F]/.test(c.host)&&punycode&&(c.host=punycode.toASCII(c.host));return c}
function Oa(a){var b="";""!==a.scheme&&(b+=a.scheme+":");""===a.host?"file"===a.scheme&&(b+="//"):(b+="//",""!==a.user&&(b+=pb(decodeURIComponent(a.user)),""!==a.pass&&(b+=":"+pb(decodeURIComponent(a.pass))),b+="@"),b+=a.host,""!==a.port&&(b+=":"+a.port));var c=a.path;""!==a.query&&(c+="?"+a.query);""!==a.fragment&&(c+="#"+a.fragment);c=c.replace(/%.?[a-f]/,function(a){return a[0].toUpperCase()},c);b+=c.replace(/[^\u0020-\u007E]+/g,encodeURIComponent).replace(/%(?![0-9A-Fa-f]{2})|[^!#-&*-;=?-Z_a-z]/g,
escape);a.scheme||(b=b.replace(/^([^\/]*):/,"$1%3A",b));return b}
function Na(a,b){if(""!==b.scheme&&!a.P.test(b.scheme))return"URL scheme is not allowed";if(""===b.host){if("file"!==b.scheme&&""!==b.scheme)return"Missing host"}else{var c;if(c=!/^(?!-)[-a-z0-9]{0,62}[a-z0-9](?:\.(?!-)[-a-z0-9]{0,62}[a-z0-9])*$/i.test(b.host)){a:if(c=b.host,/^\d+\.\d+\.\d+\.\d+$/.test(c))for(var d=4,e=c.split(".");0<=--d;){if("0"===e[d].charAt(0)||255<e[d]){c=!1;break a}}else c=!1;if(c=!c)c=b.host.replace(/^\[(.*)\]$/,"$1",b.host),c=!(/^(\d*:){2,7}\d+(?:\.\d+\.\d+\.\d+)?$/.test(c)&&
c)}if(c)return"URL host is invalid";if(a.S&&a.S.test(b.host)||a.W&&!a.W.test(b.host))return"URL host is not allowed"}}function qb(){}qb.prototype={p:function(){}};function rb(a,b,c,d){this.r=a;this.l=b;this.k=c;this.u=d;this.j={};this.G=[];isNaN(a+c+d)&&F(this)}rb.prototype.E=!1;rb.prototype.n=0;function sb(a,b){a.G.push(b);a.E&&F(b)}function F(a){a.E||(a.E=!0,a.G.forEach(function(a){F(a)}))}
function G(a,b){a.l===b.l&&(1===a.r&&2===b.r&&b.k>=a.k?(a.y=b,b.F=a,sb(a,b)):2===a.r&&1===b.r&&b.k<=a.k&&(a.F=b,b.y=a))}function tb(a){a.n=1E3}function Ea(a){var b={},c;for(c in a.j)b[c]=a.j[c];return b}function ub(a,b){return a.E||a.l!==b.l||1!==b.r||2!==a.r||a.k<b.k||a.F&&a.F!==b||b.y&&b.y!==a?!1:!0}rb.prototype.p=function(a,b){this.j[a]=b};function Fa(a,b){a.j={};for(var c in b)a.j[c]=b[c]}
var vb,wb,xb,J,K,N,yb,Da=new qb,zb,O,Q,Bb={Autoemail:{x:function(a,b){b.forEach(function(a){var b=R(1,"EMAIL",a[0][1],0);b.p("email",a[0][0]);a=R(2,"EMAIL",a[0][1]+a[0][0].length,0);G(b,a)})},z:"@",A:/\b[-a-z0-9_+.]+@[-a-z0-9.]*[a-z0-9]/ig,B:1E4},Autolink:{x:function(a,b){b.forEach(function(b){var d=b[0][1];if(!(0<d&&-1<"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789".indexOf(a.charAt(d-1)))){for(b=b[0][0];;)if(b=b.replace(/[\s!"',.<>?]+$/,""),")"===b.substr(-1)&&b.replace(/[^(]+/g,
"").length<b.replace(/[^)]+/g,"").length)b=b.substr(0,b.length-1);else break;if(/^www\.|^[^:]+:/i.test(b)){var e=R(2,"URL",d+b.length,0);"."===b.charAt(3)&&(b="http://"+b);d=R(1,"URL",d,0);d.p("url",b);d.n=1;G(d,e)}}})},z:"://",A:/(?:ftp|https?):\/\/\S(?:[^\s\[\]]*(?:\[\w*\])?)+/ig,B:1E4},Escaper:{x:function(a,b){b.forEach(function(a){S("ESC",a[0][1],1,a[0][1]+a[0][0].length,0)})},z:"\\",A:/\\[-!#()*+.:<>@[\\\]^_`{}]/g,B:1E4},FancyPants:{x:function(a){function b(a,b,c){a=R(3,g.M,a,b);a.p(g.Q,c);return a}
function c(){for(var c={"--":"\u2013","---":"\u2014","...":"\u2026"},d=/---?|\.\.\./g,e;e=d.exec(a);)b(+e.index,e[0].length,c[e[0]])}function d(c,d,e,h){for(var f;f=d.exec(a);){var g=b(+f.index+f[0].indexOf(c),1,e);f=b(+f.index+f[0].length-1,1,h);sb(g,f)}}function e(a){for(var c,d=/[a-z]'|(?:^|\s)'(?=[a-z]|[0-9]{2})/gi;c=d.exec(a);)b(+c.index+c[0].indexOf("'"),1,"\u2019").n=10}function f(a){for(var c,d,e=/[0-9](?:'s|["']? ?x(?= ?[0-9])|["'])/g;d=e.exec(a);)if("x"===d[0].charAt(d[0].length-1)&&b(+d.index+
d[0].length-1,1,"\u00d7"),c=d[0].charAt(1),"'"===c||'"'===c)c="'s"===d[0].substr(1,2)?"\u2019":"'"===c?"\u2032":"\u2033",b(+d.index+1,1,c)}function h(){for(var c={"(c)":"\u00a9","(r)":"\u00ae","(tm)":"\u2122"},d=/\((?:c|r|tm)\)/gi,e;e=d.exec(a);)b(+e.index,e[0].length,c[e[0].toLowerCase()])}var g={Q:"char",M:"FP"},l=0<=a.indexOf("'"),k=0<=a.indexOf('"');l&&e(a);(l||k||0<=a.indexOf("x"))&&f(a);l&&d("'",/(?:^|\W)'.+?'(?!\w)/g,"\u2018","\u2019");k&&d('"',/(?:^|\W)".+?"(?!\w)/g,"\u201c","\u201d");(0<=
a.indexOf("...")||0<=a.indexOf("--"))&&c();0<=a.indexOf("(")&&h()}},HTMLComments:{x:function(a,b){b.forEach(function(a){var b=lb(a[0][0].substr(4,a[0][0].length-7)),b=b.replace(/[<>]/g,""),b=b.replace(/--/g,"");R(3,"HC",a[0][1],a[0][0].length).p("content",b)})},z:"\x3c!--",A:/\x3c!--(?!\[if)[\s\S]*?--\x3e/ig,B:1E4},HTMLElements:{x:function(a,b){var c={a:{"":"URL",href:"url"},em:{"":"EM"},hr:{"":"HR"},s:{"":"S"},strong:{"":"STRONG"},sup:{"":"SUP"}};b.forEach(function(b){var e="/"===a.charAt(b[0][1]+
1),f=b[0][1],h=b[0][0].length,g=b[2-e][0].toLowerCase(),l=c&&c[g]&&c[g][""]?c[g][""]:"html:"+g;if(e)R(2,l,f,h);else{e=/(<\S+|['"\s])\/>$/.test(b[0][0])?S(l,f,h,f+h,0):R(1,l,f,h);b=b[3][0];for(var f=/[a-z][-a-z0-9]*(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s"'=<>`]+))?/gi,k;l=f.exec(b);)k=l[0].indexOf("="),0>k&&(k=l[0].length,l[0]+="="+l[0].toLowerCase()),h=l[0].substr(0,k).toLowerCase().replace(/^\s+/,"").replace("/s+$/",""),l=l[0].substr(1+k).replace(/^\s+/,"").replace("/s+$/",""),c&&c[g]&&c[g][h]&&(h=c[g][h]),
/^["']/.test(l)&&(l=l.substr(1,l.length-2)),e.p(h,lb(l))}})},z:"<",A:/<(?:\/((?:a(?:bbr)?|br?|code|d(?:[dlt]|el|iv)|em|hr|i(?:mg|ns)?|li|ol|pre|r(?:[bp]|tc?|uby)|s(?:(?:pan|trong|u[bp]))?|t(?:[dr]|able|body|foot|h(?:ead)?)|ul?))|((?:a(?:bbr)?|br?|code|d(?:[dlt]|el|iv)|em|hr|i(?:mg|ns)?|li|ol|pre|r(?:[bp]|tc?|uby)|s(?:(?:pan|trong|u[bp]))?|t(?:[dr]|able|body|foot|h(?:ead)?)|ul?))((?:\s+[a-z][-a-z0-9]*(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s"'=<>`]+))?)*)\s*\/?)\s*>/ig,B:1E4},HTMLEntities:{x:function(a,b){b.forEach(function(a){var b=
a[0][0],e=lb(b);e===b||32>e.charCodeAt(0)||R(3,"HE",a[0][1],b.length).p("char",e)})},z:"&",A:/&(?:[a-z]+|#(?:[0-9]+|x[0-9a-f]+));/ig,B:1E4},Litedown:{x:function(a){function b(a,b){G(R(2,"LIST",b,0),a.T);G(R(2,"LI",b,0),a.K);a.O&&a.L.forEach(function(a){a.d&=-9})}function c(a,b){for(var c=a;0<=--b;)c=c.replace(/^ *> ?/,"");return a.length-c.length}function d(a){x.R&&-1<a.indexOf("&")&&(a=lb(a));a=a.replace(/[\\\x1A]/g,"");ia&&(a=a.replace(/\x1B./g,function(a){return{"\u001b0":"!","\u001b1":'"',"\u001b2":")",
"\u001b3":"*","\u001b4":"[","\u001b5":"\\","\u001b6":"]","\u001b7":"^","\u001b8":"_","\u001b9":"`","\u001bA":"~"}[a]}));return a}function e(a){return d(a.replace(/^\s*(.*?)\s*$/,"$1").replace(/^(['"])(.*)\1$/,"$2"))}function f(a){return a.replace(/\\[!")*[\\\]^_`~]/g,function(a){return{"\\!":"\u001b0",'\\"':"\u001b1","\\)":"\u001b2","\\*":"\u001b3","\\[":"\u001b4","\\\\":"\u001b5","\\]":"\u001b6","\\^":"\u001b7","\\_":"\u001b8","\\`":"\u001b9","\\~":"\u001bA"}[a]})}function h(b,c){return/[ \t]*#*[ \t]*$/.exec(a.substr(b,
c-b))[0].length}function g(a){var b=[d(a[3])];a[4]&&(a=e(a[4]),""<a&&b.push(a));return b}function l(b){if("undefined"===typeof L){L={};for(var c,h=/^(?:> ?)* {0,3}\[([^\x17\]]+)\]: *([^\s\x17]+)([^\n\x17]*)\n?/gm;c=h.exec(a);){Ab(c.index,c[0].length).n=-2;var f=c[1].toLowerCase();L[f]||(L[f]=[d(c[2])],c=e(c[3]),""<c&&L[f].push(c))}}b=b.toLowerCase();return L[b]||[]}function k(){var b={};if(-1===a.indexOf("-")&&-1===a.indexOf("="))return b;for(var c,d=/^(?=[-=>])(?:> ?)*(?=[-=])(?:-+|=+) *$/gm;c=d.exec(a);){var e=
c[0];c=c.index;for(var h=c-1;0<h&&" "===a[h-1];)--h;b[c-1]={H:c+e.length-h,I:h,V:e.length-e.replace(/>/g,"").length,M:"="===e.charAt(0)?"H1":"H2"}}return b}function C(a){return 0<" abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789".indexOf(a)}function v(b){a=a.substr(0,b)+"\u0017"+a.substr(b+1)}function p(b,c){var d=a.indexOf(b);if(-1!==d){var e=[],h=[],f=f=a.indexOf("\u0017",d),g;for(c.lastIndex=d;g=c.exec(a);)d=g.index,g=g[0].length,d>f&&(h.push(e),e=[],f=a.indexOf("\u0017",d)),"_"===
a[d]&&1===g&&0<d&&C(a[d-1])&&C(a[d+g])||e.push([d,g]);h.push(e);h.forEach(H)}}function w(b,c){a=a.substr(0,b)+Array(1+c).join("\u001a")+a.substr(b+c)}function H(a){var b=0,c=-1,d=-1,e;a.forEach(function(a){var h=a[0];a=a[1];var f=Math.min(3,a),g=f&b&1,f=f&b&2,l=h,Hb=h;2<b&&c===d&&(g?c+=2:++d);g&&f&&(c<d?l+=2:++Hb);e=a;g&&(--b,--e,S("EM",c,1,l,1));f&&(b-=2,e-=2,S("STRONG",d,2,Hb,2));e=Math.min(3,e);e&1&&(c=h+a-e);e&2&&(d=h+a-e);b+=e})}function D(a,b,c){(b[3]?g(b):l(b[2]||b[1])).forEach(function(b,
d){a.p(c[d],b)})}var x={R:!0},ia,L,Sa,Ta,Ib,Ua;0>a.indexOf("\\")?ia=!1:(ia=!0,a=f(a));a+="\n\n\u0017";L=void 0;(function(){for(var d,e=4,f,g=!0,l=[],p=0,C=!1,H=[],D=0,x=k(),T=0,L,aa,ua,P,ia,Jb,B,z,Va,Ga,U,V,ea,Kb=[],va,Ha=/^(?:(?=[-*+\d \t>`~#_])((?: {0,3}> ?)+)?([ \t]+)?(\* *\* *\*[* ]*$|- *- *-[- ]*$|_ *_ *_[_ ]*$)?((?:[-*+]|\d+\.)[ \t]+(?=\S))?[ \t]*(#{1,6}[ \t]+|```+[^`\n]*$|~~~+[^~\n]*$)?)?/gm;va=Ha.exec(a);)Kb.push(va),va.index===Ha.lastIndex&&++Ha.lastIndex;Kb.forEach(function(k){var I=k.index,
xa=k[0].length;U=P=0;aa=!g;B=a.indexOf("\n",I);g=B===I+xa&&!k[3]&&!k[4]&&!k[5];xa||++Ha.lastIndex;L=g&&aa;k[1]&&(U=k[1].length-k[1].replace(/>/g,"").length,P=k[1].length,f&&"quoteDepth"in f.j&&(U=Math.min(U,f.j.quoteDepth),P=c(k[1],U)));if(U<D&&!aa&&!g){C=!0;do G(R(2,"QUOTE",T,0),H.pop());while(U<--D)}if(U>D&&!g){C=!0;do{var ba=R(1,"QUOTE",I,0);ba.n=D;H.push(ba)}while(U>++D)}var M=0,ca=0;if(k[2]&&!d){ia=k[2];Jb=ia.length;do" "===ia.charAt(ca)?++M:M=M+4&-4;while(++ca<Jb&&M<e)}f&&!d&&M<e&&!g&&(C=!0);
C&&(C=!1,f&&(w(f.k,T-f.k),ua=R(2,"CODE",T,0),G(ua,f),ua.n=-1,d=f=null),l.forEach(function(a){b(a,T)}),l=[],p=0,I&&v(I-1));if(M>=e){if(f||!aa)P=(k[1]||"").length+ca,f||(f=R(1,"CODE",I+P,0)),k={}}else{ba=!!k[4];if(M||aa||ba||g)if(aa&&!ba)z=p-1;else if(p)for(z=0;z<p&&M>l[z].N;)++z;else z=!ba||aa&&"\u0017"!==a.charAt(I-1)?-1:0;else z=-1;for(;z<p-1;)b(l.pop(),T),--p;z!==p||ba||--z;if(ba&&0<=z)if(L=!0,V=I+P+ca,ea=k[4].length,ca=R(1,"LI",V,ea),w(V,ea),z<p)G(R(2,"LI",T,0),l[z].K),l[z].K=ca,l[z].L.push(ca);
else{++p;z?(Ga=l[z-1].N+1,Va=Math.max(Ga,4*z)):(Ga=0,Va=M);M=R(1,"LIST",V,0);if(-1<k[4].indexOf(".")){M.p("type","decimal");var va=+k[4];1!==va&&M.p("start",va)}l.push({T:M,K:ca,L:[ca],X:Ga,N:Va,O:!0})}!p||aa||g||(1<l[0].L.length||!ba)&&l.forEach(function(a){a.O=!1});e=4*(p+1)}if(k[5])if("#"===k[5].charAt(0))Sa=k[5].length,Ta=I+xa-Sa,Ua=h(I+xa,B),Ib=B-Ua,S("H"+/#{1,6}/.exec(k[5])[0].length,Ta,Sa,Ib,Ua),v(Ta),v(B),aa&&(L=!0);else{if("`"===k[5].charAt(0)||"~"===k[5].charAt(0))V=I+P,ea=B-V,f&&k[5]===
d?(ua=R(2,"CODE",V,ea),G(ua,f),ua.n=-1,Ab(T,V-T),w(f.k,V+ea-f.k),d=f=null):f||(f=R(1,"CODE",V,ea),d=k[5].replace(/[^`~]+/,""),f.p("quoteDepth",U),Ab(V+ea,1),k=k[5].replace(/^[`~\s]*/,"").replace(/\s+$/,""),""!==k&&f.p("lang",k))}else k[3]&&!p&&"\u001a"!==a.charAt(I)?(R(3,"HR",I+P,xa-P),L=!0,v(B)):!x[B]||x[B].V!==U||g||p||f||(S(x[B].M,I+P,0,x[B].I,x[B].H),w(x[B].I,x[B].H),v(x[B].I+x[B].H));L&&(R(3,"pb",T,0),v(T));g||(T=B);P&&tb(Ab(I,P))})})();(function(){if(-1!==a.indexOf("`"))for(var b,c=/((`+)(?!`)\s*)(?:[^\x17]*?[^`\s])?(\s*\2)(?!`)/g;b=
c.exec(a);){var d=b.index,e=b[0].length,f=b[3].length;S("C",d,b[1].length,d+e-f,f);w(d,e)}})();(function(){if(-1!==a.indexOf("!["))for(var b,c=/!\[([^\x17]*?(?=] ?\()|[^\x17\]]*)](?: ?\[([^\x17\]]+)\]| ?\(([^\x17 ")]+)( *(?:"[^\x17"]*"|\'[^\x17\']*\'|[^\x17\)]*))?\))?/g;b=c.exec(a);){var e=b.index,f=b[0].length,h=b[1].length,g=e,h=S("IMG",g,2,g+2+h,f-2-h);h.p("alt",d(b[1]));D(h,b,["src","title"]);w(e,f)}})();(function(){if(-1!==a.indexOf("["))for(var b,c=/\[([^\x17]*?(?=]\()|[^\x17\]]*)](?: ?\[([^\x17\]]+)\]|\(([^\x17 ()]+(?:\([^\x17 ()]+\)[^\x17 ()]*)*[^\x17 )]*)( *(?:"[^\x17"]*"|\'[^\x17\']*\'|[^\x17\)]*))?\))?/g;b=
c.exec(a);){var d=b[1].length,e=b.index,f=e+1+d,d=b[0].length-1-d,h=S("URL",e,1,f,d);D(h,b,["url","title"]);h.n=-1;w(e,1);w(f,d)}})();(function(){if(-1!==a.indexOf("~~"))for(var b,c=/~~[^\x17]+?~~/g;b=c.exec(a);){var d=b.index;S("DEL",d,2,d+b[0].length-2,2)}})();(function(){if(-1!==a.indexOf("^"))for(var b,c=/\^[^\x17\s]+/g;b=c.exec(a);){var d=b[0],e=b=b.index,f=b+d.length,d=d.split("^");d.shift();d.forEach(function(a){S("SUP",e,1,f,0);e+=1+a.length})}})();p("*",/\*+/g);p("_",/_+/g);(function(){for(var b=
a.indexOf("  \n");-1!==b;)R(3,"br",b+2,0),b=a.indexOf("  \n",b+3)})()}},MediaEmbed:{x:function(a,b){b.forEach(function(a){var b=a[0][0];a=R(3,"MEDIA",a[0][1],b.length);a.p("url",b);a.n=-10})},z:":",A:/\b(?:spotify:|https?:\/\/)[^["'\s]+/g,B:1E4}},W,La={mediasites:{"bandcamp.com":"bandcamp","dailymotion.com":"dailymotion","facebook.com":"facebook","liveleak.com":"liveleak","open.spotify.com":"spotify","play.spotify.com":"spotify","soundcloud.com":"soundcloud","spotify:":"spotify","twitch.tv":"twitch",
"vimeo.com":"vimeo","vine.co":"vine","youtu.be":"youtube","youtube.com":"youtube"},urlConfig:{P:/^(?:ftp|https?)$/i}},Cb={c:na,d:8},X={BANDCAMP:{c:m,j:{album_id:A,track_id:A,track_num:A,url:E},f:13,b:[ob,Ca,ib],g:10,e:ja,i:1E3},C:Za,CODE:{c:m,j:{lang:Ka},f:4,b:y,g:10,e:{d:4436,q:t},i:1E3},DAILYMOTION:{c:m,v:[["url",/dailymotion\.com\/(?:live\/|swf\/|user\/[^#]+#video=|(?:related\/\d+\/)?video\/)([A-Za-z0-9]+)/,n],["url",/^([A-Za-z0-9]+)$/,n]],j:{id:{b:[function(a){return u(a,/^[A-Za-z0-9]+$/)}],o:!0},
url:E},f:13,b:db,g:10,e:ja,i:1E3},DEL:bb,EM:$a,EMAIL:{c:ha,j:{email:{b:[function(a){return/^[-\w.+]+@[-\w.]+$/.test(a)?a:!1}],o:!0}},f:0,b:y,g:10,e:fa,i:1E3},ESC:{c:m,f:1,b:y,g:10,e:{d:1616},i:1E3},FACEBOOK:{c:m,v:[["url",/\/(?!(?:apps|developers|graph)\.)[-\w.]*facebook\.com\/(?:[\/\w]+\/permalink|(?!pages\/|groups\/).*?)(?:\/|fbid=|\?v=)(\d+)(?=$|[\/?&#])/,n],wa],j:gb,f:0,b:db,g:10,e:ga,i:1E3},FP:cb,H1:eb,H2:eb,H3:eb,H4:eb,H5:eb,H6:eb,HC:{c:m,j:{content:oa},f:1,b:y,g:10,e:ga,i:1E3},HE:cb,HR:{c:pa,
f:4,b:y,g:10,e:{d:3333},i:1E3},IMG:{c:pa,j:{alt:r,src:Ya,title:r},f:3,b:y,g:10,e:ka,i:1E3},LI:hb,LIST:{c:ra,j:{start:{b:[function(a){return/^(?:0|[1-9]\d*)$/.test(a)?a:!1}],o:!1},type:Ka},f:4,b:y,g:10,e:za,i:1E3},LIVELEAK:{c:m,v:[["url",/liveleak\.com\/view\?i=([a-f_0-9]+)/,n],["url",/^([a-f_0-9]+)$/,n]],j:{id:{b:[function(a){return u(a,/^[a-f_0-9]+$/)}],o:!0},url:E},f:13,b:db,g:10,e:ja,i:1E3},MEDIA:{c:m,f:1,b:[function(a){return function(a,c){function d(a,b){var c=a.y||a,d=a.k,c=R(3,b.toUpperCase(),
d,c.k+c.u-d);Fa(c,Ea(a));c.n=a.n}return function(a,b){if("media"in a.j){var c=a.j.media.toLowerCase(),g;a:{for(g in b)if(b[g]===c){g=!0;break a}g=!1}g&&d(a,c)}else if("url"in a.j){g=/^(?:([^:]+):)?(?:\/\/([^\/]+))?/.exec(a.j.url);if(g[1]&&b[g[1]+":"])c=b[g[1]+":"];else if(g[2])a:{c=g[2];do{if(b[c]){c=b[c];break a}g=c.indexOf(".");if(0>g)break;c=c.substr(1+g)}while(""<c);c=!1}c&&d(a,c)}return!1}(a,c)}(a,La.mediasites)}],g:10,e:{d:577},i:1E3},QUOTE:{c:na,f:4,b:y,g:10,e:ya,i:1E3},SOUNDCLOUD:{c:m,v:[["url",
/(https?:\/\/(?:api\.)?soundcloud\.com\/(?!pages\/)[-\/\w]+\/[-\/\w]+|^[^\/]+\/[^\/]+$)/,n],["url",/api.soundcloud.com\/playlists\/(\d+)/,["","playlist_id"]],["url",/api.soundcloud.com\/tracks\/(\d+)(?:\?secret_token=([-\w]+))?/,["","track_id","secret_token"]],["url",/soundcloud\.com\/(?!playlists|tracks)[-\w]+\/[-\w]+\/(?=s-)([-\w]+)/,["","secret_token"]],["url",/^((?:https?:\/\/(?:api\.)?soundcloud\.com\/(?!pages\/)[-\/\w]+\/[-\/\w]+|^[^\/]+\/[^\/]+$))$/,n]],j:{id:{b:[function(a){return u(a,/^(?:https?:\/\/(?:api\.)?soundcloud\.com\/(?!pages\/)[-\/\w]+\/[-\/\w]+|^[^\/]+\/[^\/]+$)$/)}],
o:!0},playlist_id:A,secret_token:Wa,track_id:A,url:E},f:0,b:[Aa,ob,Ca],g:10,e:ga,i:1E3},SPOTIFY:{c:m,v:[["url",/(spotify:(?:album|artist|user|track(?:set)?):[,:\w]+)/,["","uri"]],["url",/(?:open|play)\.spotify\.com\/((?:album|artist|track|user)\/[\/\w]+)/,["","path"]]],j:{path:{b:[function(a){return u(a,/^(?:(?:album|artist|track|user)\/[\/\w]+)$/)}],o:!1},uri:{b:[function(a){return u(a,/^(?:spotify:(?:album|artist|user|track(?:set)?):[,:\w]+)$/)}],o:!1},url:E},f:13,b:jb,g:10,e:ja,i:1E3},STRONG:$a,
SUP:ab,TWITCH:{c:m,v:[["url",/twitch\.tv\/(\w+)(?:\/b\/(\d+)|\/c\/(\d+)|\/v\/(\d+))?/,["","channel","archive_id","chapter_id","video_id"]],["url",/t=((?:(?:\d+h)?\d+m)?\d+s)/,["","t"]]],j:{archive_id:A,channel:{b:[function(a){return u(a,/^\w+$/)}],o:!1},chapter_id:A,t:{b:[function(a){return u(a,/^(?:(?:\d+h)?\d+m)?\d+s$/)}],o:!1},url:E,video_id:A},f:13,b:jb,g:10,e:ja,i:1E3},URL:{c:ha,j:{url:Ya},f:0,b:y,g:10,e:fa,i:1E3},VIMEO:{c:m,v:[["url",/vimeo\.com\/(?:channels\/[^\/]+\/|video\/)?(\d+)/,n],wa],
j:gb,f:13,b:db,g:10,e:ja,i:1E3},VINE:{c:m,v:[["url",/vine\.co\/v\/([^\/]+)/,n],["url",/^([^\/]+)$/,n]],j:{id:{b:[function(a){return u(a,/^[^\/]+$/)}],o:!0},url:E},f:13,b:db,g:10,e:ja,i:1E3},YOUTUBE:{c:m,v:[["url",/youtube\.com\/(?:watch.*?v=|v\/)([-\w]+)/,n],["url",/youtu\.be\/([-\w]+)/,n],["url",/[#&?]t=(?:(?:(\d+)h)?(\d+)m(\d+)|(\d+))/,["","h","m","s","t"]],["url",/&list=([-\w]+)/,["","list"]],["url",/^([-\w]+)$/,n]],j:{h:A,id:{b:Ja,o:!0},list:Wa,m:A,s:A,t:A,url:E},f:13,b:db,g:10,e:ja,i:1E3},"html:abbr":{c:q,
j:{title:r},f:3,b:y,g:10,e:da,i:1E3},"html:b":$a,"html:br":{c:sa,f:3,b:y,g:10,e:la,i:1E3},"html:code":Za,"html:dd":{c:na,f:7,b:y,g:10,e:Ra,i:1E3},"html:del":bb,"html:div":{c:na,j:ta,f:4,b:y,g:10,e:ya,i:1E3},"html:dl":{c:[65410,16128],f:4,b:y,g:10,e:za,i:1E3},"html:dt":{c:qa,f:7,b:y,g:10,e:Ra,i:1E3},"html:i":$a,"html:img":{c:sa,j:{alt:r,height:r,src:E,title:r,width:r},f:3,b:y,g:10,e:la,i:1E3},"html:ins":bb,"html:li":hb,"html:ol":fb,"html:pre":{c:q,f:4,b:y,g:10,e:{d:276,q:t},i:1E3},"html:rb":{c:q,f:8,
b:y,g:10,e:Xa,i:1E3},"html:rp":{c:q,f:8,b:y,g:10,e:{w:{"html:rb":1,"html:rp":1,"html:rtc":1},d:256,q:t},i:1E3},"html:rt":{c:q,f:9,b:y,g:10,e:{w:{"html:rb":1,"html:rp":1,"html:rt":1},d:256,q:t},i:1E3},"html:rtc":{c:[65295,16130],f:8,b:y,g:10,e:Xa,i:1E3},"html:ruby":{c:[65295,16131],f:3,b:y,g:10,e:da,i:1E3},"html:span":{c:q,j:ta,f:3,b:y,g:10,e:da,i:1E3},"html:strong":$a,"html:sub":ab,"html:sup":ab,"html:table":{c:[65282,16148],f:4,b:y,g:10,e:za,i:1E3},"html:tbody":{c:ma,f:10,b:y,g:10,e:{w:{"html:tbody":1,
"html:tfoot":1,"html:thead":1},d:3456,q:t},i:1E3},"html:td":{c:na,j:{colspan:r,rowspan:r},f:11,b:y,g:10,e:Qa,i:1E3},"html:tfoot":{c:ma,f:10,b:y,g:10,e:{w:{"html:tbody":1,"html:thead":1},d:3456,q:t},i:1E3},"html:th":{c:qa,j:{colspan:r,rowspan:r,scope:r},f:11,b:y,g:10,e:Qa,i:1E3},"html:thead":{c:ma,f:10,b:y,g:10,e:{d:3456,q:t},i:1E3},"html:tr":{c:[65282,16136],f:12,b:y,g:10,e:{w:{"html:tr":1},d:3456,q:t},i:1E3},"html:u":$a,"html:ul":fb},Y,Db,Z,Eb,Fb=0,Gb;
function Lb(a){a=a.replace(/\r\n?/g,"\n");a=a.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F]+/g,"");wb={};xb={};vb=[];K=0;N=null;yb=!1;zb={};O=[];Q="";W=0;Y=[];Db=!0;Z=a;Eb=Z.length;Gb=0;J=Cb;J.D=!1;++Fb;a=Fb;for(var b in Bb)if(!Bb[b].J)a:{var c=b,d=Bb[c];if(!(d.z&&0>Z.indexOf(d.z))){var e=[];if(d.A){e=d.A;d=d.B;e.lastIndex=0;for(var f=[],h=0,g=void 0;++h<=d&&(g=e.exec(Z));){for(var l=+g.index,k=[[g[0],l]],C=0;++C<g.length;){var v=g[C];void 0===v?k.push(["",-1]):(k.push([v,Z.indexOf(v,l)]),l+=v.length)}f.push(k)}e=
f;if(!e.length)break a}(0,Bb[c].x)(Z,e)}}Mb();Nb();Ob(Eb,0,!0);do b=Q,Q=Q.replace(/<([^ />]+)><\/\1>/g,"");while(Q!==b);Q=Q.replace(/<\/i><i>/g,"",Q);Q=Q.replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,Pb);c=yb?"r":"t";b="<"+c;for(var p in zb)b+=" xmlns:"+p+'="urn:s9e:TextFormatter:'+p+'"';Q=b+">"+Q+"</"+c+">";if(Fb!==a)throw"The parser has been reset during execution";return Q}function Nb(){vb.forEach(function(a){a.G=[];delete a.y;delete a.F});vb=[]}
function Ba(a,b){b.v&&b.v.forEach(function(b){var d=b[0],e=b[1];b=b[2];if(d in a.j){var e=Qb(a.j[d],e,b),f;for(f in e)f!==d&&f in a.j||a.p(f,e[f])}});return!0}function Qb(a,b,c){var d=b.exec(a);if(!d)return[];var e={};c.forEach(function(a,b){"string"===typeof d[b]&&""!==d[b]&&(e[a]=d[b])});return e}function Pb(a){return"&#"+((a.charCodeAt(0)<<10)+a.charCodeAt(1)-56613888)+";"}
function Rb(a){yb=!0;var b=a.l,c=a.k,d=a.u,e=a.d,f=0,h=0;e&256&&(f=1,h=a.r&2?2:1);var g=!1;a.r&1?e&4&&(g=!0):g=!0;Ob(c,f,g);f=d?nb(Z.substr(c,d)):"";if(a.r&1){e&4||Sb(c);e=b.indexOf(":");0<e&&(zb[b.substr(0,e)]=0);Q+="<"+b;var l=Ea(a),e=[],k;for(k in l)e.push(k);e.sort(function(a,b){return a>b?1:-1});e.forEach(function(a){Q+=" "+a+'="'+mb(l[a].toString())+'"'});Q=3===a.r?d?Q+(">"+f+"</"+b+">"):Q+"/>":d?Q+("><s>"+f+"</s>"):Q+">"}else d&&(Q+="<e>"+f+"</e>"),Q+="</"+b+">";for(Gb=W=c+d;h&&Gb<Eb&&"\n"===
Z.charAt(Gb);)--h,++Gb}
function Ob(a,b,c){c&&(J.d&8?b=-1:c=!1);W>=a&&c&&Tb();if(Gb>W){var d=Math.min(a,Gb);Q+=Z.substr(W,d-W);W=d;W>=a&&c&&Tb()}if(J.d&128)d=a-W,b=Z.substr(W,d),/^[ \n\t]*$/.test(b)||(b="<i>"+b+"</i>"),Q+=b,W=a,c&&Tb();else{for(var e=a,d=0;b&&--e>=W;){var f=Z.charAt(e);if(" "!==f&&"\n"!==f&&"\t"!==f)break;"\n"===f&&--b;++d}a-=d;if(J.d&8)for(J.D||(Ub(a),a>W&&Sb(a)),b=Z.indexOf("\n\n",W);-1<b&&b<a;)Ob(b,0,!0),Sb(a),b=Z.indexOf("\n\n",W);a>W&&(b=nb(Z.substr(W,a-W)),Q+=b);c&&Tb();d&&(Q+=Z.substr(a,d));W=a+d}}
function Vb(a){var b=a.k;a=a.u;var c=Z.substr(b,a);Ob(b,0,!1);Q+="<i>"+nb(c)+"</i>";yb=!0;W=b+a}function Sb(a){!J.D&&J.d&8&&(Ub(a),W<Eb&&(Q+="<p>",J.D=!0))}function Tb(){J.D&&(Q+="</p>",J.D=!1)}function Ub(a){for(;W<a&&-1<" \n\t".indexOf(Z.charAt(W));)Q+=Z.charAt(W),++W}function Wb(a,b){var c=a.l;a.d&256&&(b=Xb(b));c=R(2,c,b,0);G(c,a);return c}function Xb(a){for(;a>W&&-1<" \n\t".indexOf(Z.charAt(a-1));)--a;return a}
function Mb(){if(Y.length){for(var a in X)wb[a]=0,xb[a]=0;do{for(;Y.length;)Db||(Y.sort(Yb),Db=!0),N=Y.pop(),J.d&64&&!(ub(N,O[O.length-1])||-1<"br i pb v".indexOf(N.l))||Zb();O.forEach(function(a){Wb(a,Eb)})}while(Y.length)}}
function Zb(){if(!N.E){var a=N.k,b=N.u;if(W>a){var c;if((c=N.F)&&0<=O.indexOf(c))G(R(2,c.l,W,Math.max(0,a+b-W)),c);else{if("i"===N.l&&(a=a+b-W,0<a)){Ab(W,a);return}F(N)}}else if("i"===N.l)Vb(N);else if("br"===N.l)J.d&1024||(Ob(N.k,0,!1),Q+="<br/>");else if("pb"===N.l)Ob(N.k,0,!0);else if("v"===N.l)a=J.d,J.d=N.d,Ob(N.k+N.u,0,!1),J.d=a;else if(N.r&1)if(a=N,b=a.l,c=X[b],xb[b]>=c.i)F(a);else{var d=a,e=X[d.l],f=!0;if(e.b)for(var h=0;h<e.b.length;++h)if(!e.b[h](d,e)){f=!1;break}if(f){a:{d=a;if(O.length&&
(f=d.l,h=X[f],h.e.q)){var e=O[O.length-1],g=e.l;if(h.e.q[g]){g!==f&&1E3>K&&(f=$b(e,d.k+d.u),sb(d,f),f.n=d.n+1);Y.push(d);Wb(e,d.k).n=d.n-1;K+=Y.length;d=!0;break a}}d=!1}if(!d)a:{d=a;if(O.length&&(e=X[d.l],e.e.w&&(f=O[O.length-1],e.e.w[f.l]))){Y.push(d);Wb(f,d.k);d=!0;break a}d=!1}d||(wb[b]>=c.g?F(a):(c=X[b].f,J.c[c>>3]&1<<(c&7)?(!(a.d&1)||a.y||Y.length&&ub(Y[Y.length-1],a)||(b=new rb(3,b,a.k,a.u),Fa(b,Ea(a)),b.d=a.d,a=b),a.d&4096&&!a.y&&"\n"===Z.charAt(a.k+a.u)&&Ab(a.k+a.u,1),Rb(a),ac(a)):F(a)))}else F(a)}else bc()}}
function bc(){var a=N;if(wb[a.l]){for(var b=[],c=O.length;0<=--c;){var d=O[c];if(ub(a,d))break;b.push(d);++K}if(!(0>c)){var e=1E3>K,f=[];b.forEach(function(b){var c=b.l;e&&(b.d&2?f.push(b):e=!1);var d=a.k;b.d&256&&(d=Xb(d));c=new rb(2,c,d,0);c.d=b.d;Rb(c);cc()});Rb(a);cc();if(b.length&&1E3>K){d=W;for(c=Y.length;0<=--c&&1E3>++K;){var h=Y[c];if(h.k>d||h.r&1)break;for(var g=b.length;0<=--g&&1E3>++K;)if(ub(h,b[g])){b.splice(g,1);f[g]&&f.splice(g,1);d=Math.max(d,h.k+h.u);break}}d>W&&Vb(new rb(3,"i",W,
d-W))}f.forEach(function(a){var b=$b(a,W);(a=a.y)&&G(b,a)})}}}function cc(){var a=O.pop();--wb[a.l];J=J.U}function ac(a){var b=a.l,c=a.d,d=X[b];++xb[b];if(3!==a.r){var e=[];c&512?J.c.forEach(function(a,b){e.push(d.c[b]&a)}):J.c.forEach(function(a,b){e.push(d.c[b]&(a&65280|a>>8))});c|=J.d&32;c&16&&(c&=-33);++wb[b];O.push(a);J={c:e,d:c,U:J}}}function Ab(a,b){return R(3,"i",a,Math.min(b,Eb-a))}function $b(a,b){var c=R(a.r,a.l,b,0);Fa(c,Ea(a));c.n=a.n;return c}
function R(a,b,c,d){a=new rb(a,b,c,d);vb.push(a);X[b]&&(a.d=X[b].e.d);X[b]||-1<"br i pb v".indexOf(a.l)?X[b]&&X[b].J?F(a):0>d||0>c||c+d>Eb?F(a):(Db&&Y.length&&a.k>=Y[Y.length-1].k&&(Db=!1),Y.push(a)):F(a);return a}function S(a,b,c,d,e){b=R(1,a,b,c);G(b,R(2,a,d,e));return b}function Yb(a,b){var c=a.k,d=b.k;if(c!==d)return d-c;if(a.n!==b.n)return b.n-a.n;c=a.u;d=b.u;return c&&d?c-d:c||d?c?-1:1:(c={2:0,3:1,1:2},c[b.r]-c[a.r])}var dc="undefined"===typeof DOMParser||"undefined"===typeof XSLTProcessor;
function ec(a,b){if(dc){var c=new ActiveXObject(b);c.async=!1;c.validateOnParse=!1;c.loadXML(a);return c}return(new DOMParser).parseFromString(a,"text/xml")}function fc(a,b){if(dc){var c=b.createElement("div"),d=b.createDocumentFragment();gc.input=ec(a,"MSXML2.DOMDocument.6.0");gc.transform();for(c.innerHTML=gc.output;c.firstChild;)d.appendChild(c.removeChild(c.firstChild));return d}return b.importNode(gc.transformToFragment(ec(a),b),!0)}var gc,hc=ec(kb,"MSXML2.FreeThreadedDOMDocument.6.0");
if(dc){var ic=new ActiveXObject("MSXML2.XSLTemplate.6.0");ic.stylesheet=hc;gc=ic.createProcessor()}else gc=new XSLTProcessor,gc.importStylesheet(hc);
window.s9e={TextFormatter:{disablePlugin:function(a){Bb[a]&&(Bb[a].J=!0)},enablePlugin:function(a){Bb[a]&&(Bb[a].J=!1)},preview:function(a,b){function c(a,b){for(var c=a.childNodes,f=b.childNodes,C=c.length,v=f.length,p,w,H=0,D=0;H<C&&H<v;){p=c[H];w=f[H];if(!d(p,w))break;++H}for(var x=Math.min(C-H,v-H);D<x;){p=c[C-(D+1)];w=f[v-(D+1)];if(!d(p,w))break;++D}p=e.createDocumentFragment();for(x=H;x<v-D;)w=f[x].cloneNode(!0),p.appendChild(w),++x;for(x=C-D;--x>=H;)a.removeChild(c[x]);D?a.insertBefore(p,a.childNodes[H]):
a.appendChild(p)}function d(a,b){if(a.nodeName!==b.nodeName||a.nodeType!==b.nodeType)return!1;if(3===a.nodeType||8===a.nodeType)return a.nodeValue!==b.nodeValue&&(a.nodeValue=b.nodeValue),!0;if(a.isEqualNode&&a.isEqualNode(b))return!0;for(var d=a.attributes,e=b.attributes,f=e.length,v=d.length;0<=--v;){var p=d[v],w=p.namespaceURI,p=p.name;b.hasAttributeNS(w,p)||a.removeAttributeNS(w,p)}for(v=f;0<=--v;)d=e[v],w=d.namespaceURI,p=d.name,d=d.value,d!==a.getAttributeNS(w,p)&&a.setAttributeNS(w,p,d);c(a,
b);return!0}var e=b.ownerDocument,f=fc(Lb(a),e);c(b,f)}}};})();

		var text,
			textareaEl = document.getElementsByTagName('textarea')[0],
			previewEl = document.getElementById('preview');

		setInterval(function()
		{
			if (textareaEl.value === text)
			{
				return;
			}

			text = textareaEl.value;
			s9e.TextFormatter.preview(text, previewEl);
		}, 20);

		function toggle(el)
		{
			(el.checked) ? s9e.TextFormatter.enablePlugin(el.id)
			             : s9e.TextFormatter.disablePlugin(el.id);

			text = '';
		}
	</script>
	<script type="text/javascript" src="http://cdnjs.cloudflare.com/ajax/libs/punycode/1.3.2/punycode.min.js"></script>
</body>
</html>