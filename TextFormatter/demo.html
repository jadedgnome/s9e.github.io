<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8" />
	<title>s9e\TextFormatter &bull; Demo</title>
	<base href="http://s9e.github.io/TextFormatter/demo.html" />
	<style type="text/css">
		#preview
		{
			font-family: sans;
			padding: 5px;
			background-color: #f8f8f8;
			border: dashed 1px #ddd;
			border-radius: 5px;
		}

		code
		{
			padding: 2px;
			background-color: #fff;
			border-radius: 3px;
			border: solid 1px #ddd;
		}
	</style>

</head>
<body>
	<div style="float:left;width:80%;max-width:800px">
		<form>
			<textarea style="width:99%" rows="15">[float=right][youtube]http://www.youtube.com/watch?v=QH2-TGUlwu4[/youtube][/float]

This is a demo of the JavaScript port of [url=https://github.com/s9e/TextFormatter/tree/master/src/ title="s9e\TextFormatter at GitHub.com"]s9e\TextFormatter[/url].

The following plugins have been enabled:

[list]
  [*][b]Autolink[/b] --- loose URLs such as http://github.com are automatically turned into links
  [*][b]BBCodes[/b]
  [list=circle]
    [*][b]bold[/b], [i]italic[/i], [u]underline[/u], [s]strikethrough[/s],
    [*][color=#f05]co[/color][color=#2f2]lo[/color][color=#02f]r,[/color]
    [*][C][URL][/C], [C:123][C][/C:123], [C][YOUTUBE][/C], [C][FLOAT][/C], and [C][LIST][/C]
    [*][C][CODE][/C] with real-time syntax highlighting via [url=http://softwaremaniacs.org/soft/highlight/en/]Highlight.js[/url]
	[code]$who = "world";
printf("Hello %s\n", $who);[/code]
  [/list]
  [*][b]Censor[/b] --- the word "apple" is censored and automatically replaced with "banana"
  [*][b]Emoticons[/b] --- one emoticon :) has been added
  [*][b]FancyPants[/b] --- some typography is enhanced, e.g. (c) (tm) and "quotes"
  [*][b]Preg[/b] --- the Preg plugin provides a way to perform generic regexp-based replacements that are HTML-safe. Here, text that matches [C]/#(?<tag>[a-z0-9]+)/i[/C] is replaced with the template [C]<a href="https://twitter.com/#!/search/%23{@tag}"><xsl:apply-templates/></a>[/C] -- For example: #PHP, #fml
  [*][b]HTMLElements[/b] --- [C]<a>[/C] and [C]<b>[/C] tags are allowed, with two whitelisted attributes for [C]<a>[/C]: [C]href[/C] and [C]title[/C]. Example: <a href="https://github.com" title="GitHub - Social Coding"><b>GitHub</b></a>
  [*][b]HTMLEntities[/b] --- HTML entities such as &amp;hearts; are decoded
[/list]

[hr]

The parser/renderer used on this page page has been generated by [url=https://github.com/s9e/TextFormatter/blob/master/scripts/generateLiveDemo.php]this script[/url]. It's been minified with Google Closure Compiler to 21.3 KB (9.1 KB compressed)</textarea>
		</form>
	</div>

	<div style="float:left;">
		<form><input type="checkbox" id="Autolink" checked="checked" onchange="toggle(this)"><label for="Autolink">&nbsp;Autolink</label><br><input type="checkbox" id="BBCodes" checked="checked" onchange="toggle(this)"><label for="BBCodes">&nbsp;BBCodes</label><br><input type="checkbox" id="Censor" checked="checked" onchange="toggle(this)"><label for="Censor">&nbsp;Censor</label><br><input type="checkbox" id="Emoticons" checked="checked" onchange="toggle(this)"><label for="Emoticons">&nbsp;Emoticons</label><br><input type="checkbox" id="FancyPants" checked="checked" onchange="toggle(this)"><label for="FancyPants">&nbsp;FancyPants</label><br><input type="checkbox" id="HTMLElements" checked="checked" onchange="toggle(this)"><label for="HTMLElements">&nbsp;HTMLElements</label><br><input type="checkbox" id="HTMLEntities" checked="checked" onchange="toggle(this)"><label for="HTMLEntities">&nbsp;HTMLEntities</label><br><input type="checkbox" id="MediaEmbed" checked="checked" onchange="toggle(this)"><label for="MediaEmbed">&nbsp;MediaEmbed</label><br><input type="checkbox" id="Preg" checked="checked" onchange="toggle(this)"><label for="Preg">&nbsp;Preg</label></form>
	</div>

	<div style="clear:both"></div>

	<div id="preview"></div>

	<script type="text/javascript">(function(){var m=[aa],p={B:1,C:1,COLOR:1,I:1,S:1,U:1,URL:1,PREG_60D5AB76:1,"html:a":1,"html:b":1},ba={d:m,l:10,j:{G:p,R:{LI:1},c:256},n:1E3,k:0,f:[16190]},ca={c:2},q={d:m,l:10,j:ca,n:1E3,k:1,f:[16186]},da={d:m,l:10,j:{c:66},n:1E3,k:1,f:[0]},fa={b:{lang:{d:[ea],q:!1}},d:m,l:10,j:{G:p,c:4432},n:1E3,k:2,f:[0]},ha={b:{color:{d:[ga],q:!0}},d:m,l:10,j:ca,n:1E3,k:1,f:[16186]},ja={G:p,c:256},la={b:{"float":{d:[ka],q:!0}},d:m,l:10,j:ja,n:1E3,k:2,f:[16190]},ma={d:m,l:10,j:{G:p,c:3329},n:1E3,k:2,f:[16176]},pa={b:{type:{d:[na,
oa],q:!1}},d:m,l:10,j:{G:p,c:3456},n:1E3,k:2,f:[16161]},r={q:!1},qa={b:{author:r},d:m,l:10,j:ja,n:1E3,k:2,f:[16190]},sa=[ra],ta={c:514},ua={b:{url:{d:sa,q:!0},title:r},d:m,l:10,j:ta,n:1E3,k:3,f:[14134]},va={c:3137},wa={b:{"with":r},d:m,l:10,j:va,n:1E3,k:4,f:[0]},xa={c:3073},ya={d:m,l:10,j:xa,n:1E3,k:1,f:[16176]},Aa={b:{tag:{d:[za],q:!0}},d:m,l:10,j:ta,n:1E3,k:3,f:[14134]},Ba={d:sa,q:!1},Ca={b:{href:Ba,title:r},d:m,l:10,j:ta,n:1E3,k:3,f:[14134]},Da={b:{"char":{q:!0}},d:m,l:10,j:xa,n:1E3,k:4,f:[16176]},
Fa={d:[Ea],l:10,j:{c:577},n:1E3,k:5,f:[0]},Ha=[Ga],t={d:[Ia],q:!1},Ja=["","id"],La={b:{url:Ba,id:{d:Ha,q:!0},h:t,m:t,s:t,t:t,list:{d:Ha,q:!1}},Q:[["url",/youtube\.com\/(?:watch.*?v=|v\/)([-\w]+)/,Ja],["url",/youtu\.be\/([-\w]+)/,Ja],["url",/[#&?]t=(?:(?:(\d+)h)?(\d+)m(\d+)|(\d+))/,["","h","m","s","t"]],["url",/&list=([-\w]+)/,["","list"]],["url",/^([-\w]+)$/,Ja]],d:[Ka,aa],l:10,j:va,n:1E3,k:3,f:[0]};
function Ma(a){var b=document.createElement("b");b.innerHTML=a.replace(/</g,"&lt;");return b.textContent}function Na(a){var b={"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;"};return a.replace(/[<>&"]/g,function(a){return b[a]})}function Oa(a){var b={"<":"&lt;",">":"&gt;","&":"&amp;"};return a.replace(/[<>&]/g,function(a){return b[a]})}function Pa(a){return encodeURIComponent(a).replace(/[!'()*]/g,function(a){return"%"+a.charCodeAt(0).toString(16).toUpperCase()})}
function u(a,b){return b.test(a)?a:!1}
function Qa(a){var b=/^(?:([a-z][-+.\w]*):)?(?:\/\/(?:([^:\/?#]*)(?::([^\/?#]*)?)?@)?(?:(\[[a-f\d:]+\]|[^:\/?#]+)(?::(\d*))?)?(?![^\/?#]))?([^?#]*)(?:\?([^#]*))?(?:#(.*))?$/i.exec(a),c={};"scheme user pass host port path query fragment".split(" ").forEach(function(a,e){c[a]=""<b[e+1]?b[e+1]:""});c.scheme=c.scheme.toLowerCase();c.host=c.host.replace(/[\u3002\uff0e\uff61]/g,".").replace(/\.+$/g,"");/[^\x00-\x7F]/.test(c.host)&&punycode&&(c.host=punycode.toASCII(c.host));return c}
function Ra(a){var b="";""!==a.scheme&&(b+=a.scheme+":");""===a.host?"file"===a.scheme&&(b+="//"):(b+="//",""!==a.user&&(b+=Pa(decodeURIComponent(a.user)),""!==a.pass&&(b+=":"+Pa(decodeURIComponent(a.pass))),b+="@"),b+=a.host,""!==a.port&&(b+=":"+a.port));var c=a.path;""!==a.query&&(c+="?"+a.query);""!==a.fragment&&(c+="#"+a.fragment);c=c.replace(/%.?[a-f]/,function(a){return a[0].toUpperCase()},c);b+=c.replace(/[^\u0020-\u007E]+/g,encodeURIComponent).replace(/%(?![0-9A-Fa-f]{2})|[^!#-&*-;=?-Z_a-z]/g,
escape);a.scheme||(b=b.replace(/^([^\/]*):/,"$1%3A",b));return b}
function Sa(a,b){if(""!==b.scheme&&!a.W.test(b.scheme))return"URL scheme is not allowed";if(""===b.host){if("file"!==b.scheme&&""!==b.scheme)return"Missing host"}else{var c;if(c=!/^(?!-)[-a-z0-9]{0,62}[a-z0-9](?:\.(?!-)[-a-z0-9]{0,62}[a-z0-9])*$/i.test(b.host)){a:if(c=b.host,/^\d+\.\d+\.\d+\.\d+$/.test(c))for(var d=4,e=c.split(".");0<=--d;){if("0"===e[d].charAt(0)||255<e[d]){c=!1;break a}}else c=!1;if(c=!c)c=b.host.replace(/^\[(.*)\]$/,"$1",b.host),c=!(/^(\d*:){2,7}\d+(?:\.\d+\.\d+\.\d+)?$/.test(c)&&
c)}if(c)return"URL host is invalid";if(a.X&&a.X.test(b.host)||a.aa&&!a.aa.test(b.host))return"URL host is not allowed"}}function Ta(){}Ta.prototype={r:function(){}};function v(a,b,c,d){this.o=a;this.g=b;this.e=c;this.p=d;this.b={};this.O=[];isNaN(a+c+d)&&w(this)}v.prototype.J=!1;v.prototype.u=0;function Ua(a,b){a.O.push(b);a.J&&w(b)}function w(a){a.J||(a.J=!0,a.O.forEach(function(a){w(a)}))}
function x(a,b){a.g===b.g&&(1===a.o&&2===b.o&&b.e>=a.e?(a.x=b,b.K=a,Ua(a,b)):2===a.o&&1===b.o&&b.e<=a.e&&(a.K=b,b.x=a))}function A(a){var b={},c;for(c in a.b)b[c]=a.b[c];return b}function B(a,b){return a.J||a.g!==b.g||1!==b.o||2!==a.o||a.e<b.e||a.K&&a.K!==b||b.x&&b.x!==a?!1:!0}v.prototype.r=function(a,b){this.b[a]=b};function E(a,b){a.b={};for(var c in b)a.b[c]=b[c]}
var G,H,Va,J,K,L,Wa,Xa=new Ta,Ya,M,N,Q={BBCodes:{D:"[",y:/\[\/?(\*|[-\w]+)(?=[\]\s=:\/])/g,F:1E4,w:function(a,b){function c(){var a=P(3,n.v||y,D,l-D);E(a,h)}function d(){var a=P(1,n.v||y,D,l-D);E(a,h);return a}function e(){var c="[/"+y+z+"]",b=a.toUpperCase().indexOf(c,l);return 0>b?null:P(2,n.v||y,b,c.length)}function f(){var c=l,b;for(h={};l<ia;)if(b=a.charAt(l),-1<" \n\t".indexOf(b))++l;else{if(-1<"/]".indexOf(b))break;var d=/^[-\w]*/.exec(a.substr(l,100))[0].length;if(d){b=a.substr(l,d).toLowerCase();
l+=d;if(l>=ia)throw"";if("="!==a.charAt(l))continue}else if("="===b&&l===c)b=n.L||y.toLowerCase();else throw"";if(++l>=ia)throw"";var d=h,e;if('"'===a.charAt(l)||"'"===a.charAt(l)){e=a.charAt(l);for(var f=l+1;;){l=a.indexOf(e,l+1);if(0>l)throw"";var g=0;do++g;while("\\"===a.charAt(l-g));if(g%2)break}e=a.substr(f,l-f).replace(/\\([\\'"])/g,"$1");++l}else{e=/[^\]\n]*?(?=\s*(?:\s\/)?\]|\s+[-\w]+=)/.exec(a.substr(l));if(!e)throw"";e=e[0];l+=e.length}d[b]=e}}function g(){z="";":"===a[l]&&(z=/^:\d*/.exec(a.substr(l))[0],
l+=z.length);if("/"===a.charAt(D+1))"]"===a.charAt(l)&&""===z&&(++l,P(2,n.v||y,D,l-D));else{f();if(n.V)for(var b in n.V)b in h||(h[b]=n.V[b]);if("]"===a.charAt(l)){++l;var g=[];n.H&&n.H&&n.H.forEach(function(a){a in h||g.push(a)});var k=(b=z||n.ba)||g.length?e():null;if(k)g.forEach(function(b){h[b]=a.substr(l,k.e-l)});else if(b)return;b=d();k&&x(b,k)}else"/]"===a.substr(l,2)&&(l+=2,c())}}var k={"*":{v:"LI"},B:{},C:{},CODE:{L:"lang"},COLOR:{},FLOAT:{},HR:{},I:{},LIST:{L:"type"},QUOTE:{L:"author"},
S:{},U:{},URL:{H:["url"]},MEDIA:{H:["url"]},YOUTUBE:{H:["url"],L:"url"}},h,n,y,z,l,D,ia=a.length;b.forEach(function(a){y=a[1][0].toUpperCase();if(y in k){n=k[y];D=a[0][1];l=D+a[0][0].length;try{g()}catch(b){}}})}},Censor:{y:/(?:^|\W)apple(?!\w)/ig,F:1E4,w:function(a,b){var c={N:"with",v:"CENSOR",M:[[/^apple$/i,"banana"]]},d=c.v,e=c.N;b.forEach(function(a){if(!c.f||!c.f.test(a[0][0])){var b=/^\W/.test(a[0][0])?1:0,k=a[0][0].substr(b);a=P(3,d,a[0][1]+b,k.length);if(c.M)for(b=0;b<c.M.length;++b){var h=
c.M[b][1];if(c.M[b][0].test(k)){a.r(e,h);break}}}})}},Emoticons:{D:":)",y:/:\)/g,F:1E4,w:function(a,b){var c={v:"E"};b.forEach(function(b){c.Y&&b[0][1]&&c.Y.test(a.charAt(b[0][1]-1))||P(3,c.v,b[0][1],b[0][0].length)})}},Preg:{w:function(a){[["PREG_60D5AB76",/#([a-z0-9]+)/ig,0,["","tag"]]].forEach(function(b){var c=b[0],d=b[1],e=b[2];b=b[3];var f;for(d.lastIndex=0;f=d.exec(a);){var g=f.index,k=f[0].length,h;if(e&&""!==f[e]){var n=a.indexOf(f[e],g),y=f[e].length,z=n-g;h=Za(c,g,z,n+y,k-(z+y))}else h=
P(3,c,g,k);b.forEach(function(a,b){a&&"undefined"!==typeof f[b]&&h.r(a,f[b])})}})}},HTMLElements:{D:"<",y:/<(?:\/([ab])|([ab])((?:\s+[a-z][-a-z0-9]*(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s"'=<>`]+))?)*)\s*\/?)\s*>/ig,F:1E4,w:function(a,b){var c={$:"html"};b.forEach(function(b){var e="/"===a.charAt(b[0][1]+1),f=b[0][1],g=b[0][0].length,k=b[2-e][0].toLowerCase(),h=c.z&&c.z[k]&&c.z[k][""]?c.z[k][""]:c.$+":"+k;if(e)P(2,h,f,g);else{e="/>"===b[0][0].substr(g-2)?Za(h,f,g,f+g,0):P(1,h,f,g);b=b[3][0];for(var f=/[a-z][-a-z0-9]*(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s"'=<>`]+))?/gi,
n;h=f.exec(b);)n=h[0].indexOf("="),0>n&&(n=h[0].length,h[0]+="="+h[0].toLowerCase()),g=h[0].substr(0,n).toLowerCase().replace(/^\s+/,"").replace("/s+$/",""),h=h[0].substr(1+n).replace(/^\s+/,"").replace("/s+$/",""),c.z&&c.z[k]&&c.z[k][g]&&(g=c.z[k][g]),/^["']/.test(h)&&(h=h.substr(1,h.length-2)),e.r(g,Ma(h))}})}},Autolink:{y:/https?:\/\/\S(?:[^\s\[\]]*(?:\[\w*\])?)+/ig,D:"://",F:1E4,w:function(a,b){b.forEach(function(b){var d=b[0][1];if(!(0<d&&-1<"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789".indexOf(a.charAt(d-
1)))){for(b=b[0][0];;)if(b=b.replace(/[\s!"',.<>?]+$/,""),")"===b.substr(-1)&&b.replace(/[^(]+/g,"").length<b.replace(/[^)]+/g,"").length)b=b.substr(0,b.length-1);else break;if(/^www\.|^[^:]+:/i.test(b)){var e=P(2,"URL",d+b.length,0);"."===b.charAt(3)&&(b="http://"+b);d=P(1,"URL",d,0);d.r("url",b);d.u=1;x(d,e)}}})}},HTMLEntities:{D:"&",y:/&(?:[a-z]+|#(?:[0-9]+|x[0-9a-f]+));/ig,F:1E4,w:function(a,b){b.forEach(function(a){var b=a[0][0],e=Ma(b);e!==b&&P(3,"HE",a[0][1],b.length).r("char",e)})}},FancyPants:{w:function(a){function b(a,
b,c){a=P(3,k.v,a,b);a.r(k.N,c);return a}function c(){for(var c={"--":"\u2013","---":"\u2014","...":"\u2026"},d=/---?|\.\.\./g,e;e=d.exec(a);)b(+e.index,e[0].length,c[e[0]])}function d(c,d,e,g){for(var f;f=d.exec(a);){var n=b(+f.index+f[0].indexOf(c),1,e);f=b(+f.index+f[0].length-1,1,g);Ua(n,f)}}function e(a){for(var c,d=/[a-z]'|(?:^|\s)'(?=[a-z]|[0-9]{2})/gi;c=d.exec(a);)b(+c.index+c[0].indexOf("'"),1,"\u2019").u=10}function f(a){for(var c,d,e=/[0-9](?:'s|["']? ?x(?= ?[0-9])|["'])/g;d=e.exec(a);)if("x"===
d[0].charAt(d[0].length-1)&&b(+d.index+d[0].length-1,1,"\u00d7"),c=d[0].charAt(1),"'"===c||'"'===c)c="'s"===d[0].substr(1,2)?"\u2019":"'"===c?"\u2032":"\u2033",b(+d.index+1,1,c)}function g(){for(var c={"(c)":"\u00a9","(r)":"\u00ae","(tm)":"\u2122"},d=/\((?:c|r|tm)\)/gi,e;e=d.exec(a);)b(+e.index,e[0].length,c[e[0].toLowerCase()])}var k={N:"char",v:"FP"},h=0<=a.indexOf("'"),n=0<=a.indexOf('"');h&&e(a);(h||n||0<=a.indexOf("x"))&&f(a);h&&d("'",/(?:^|\W)'.+?'(?!\w)/g,"\u2018","\u2019");n&&d('"',/(?:^|\W)".+?"(?!\w)/g,
"\u201c","\u201d");(0<=a.indexOf("...")||0<=a.indexOf("--"))&&c();0<=a.indexOf("(")&&g()}},MediaEmbed:{D:"://",y:/\bhttps?:\/\/(?:[-.\w]+\.)?youtu(?:\.be|be\.com)\/[^["'\s]+(?!\S)/g,F:1E4,w:function(a,b){b.forEach(function(a){var b=a[0][0];a=P(3,"MEDIA",a[0][1],b.length);a.r("url",b);a.u=-10})}}},R,$a={urlConfig:{W:/^https?$/i},mediasites:{"youtube.com":"youtube","youtu.be":"youtube"}},ab={f:[16190],c:32},S={LI:ba,B:q,C:da,CODE:fa,COLOR:ha,FLOAT:la,HR:ma,I:q,LIST:pa,QUOTE:qa,S:q,U:q,URL:ua,CENSOR:wa,
E:ya,PREG_60D5AB76:Aa,"html:a":Ca,"html:b":q,HE:Da,FP:Da,MEDIA:Fa,YOUTUBE:La},T,U,V,W,bb=0,X;
function cb(a){a=a.replace(/\r\n?/g,"\n");a=a.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F]+/g,"");H={};Va={};G=[];K=0;L=null;Wa=!1;Ya={};M=[];N="";R=0;T=[];U=!0;V=a;W=V.length;X=0;J=ab;J.T=!1;++bb;a=bb;for(var b in Q)if(!Q[b].P)a:{var c=b,d=Q[c];if(!(d.D&&0>V.indexOf(d.D))){var e=[];if(d.y){e=d.y;d=d.F;e.lastIndex=0;for(var f=[],g=0,k=void 0;++g<=d&&(k=e.exec(V));){for(var h=+k.index,n=[[k[0],h]],y=0;++y<k.length;){var z=k[y];void 0===z?n.push(["",-1]):(n.push([z,V.indexOf(z,h)]),h+=z.length)}f.push(n)}e=
f;if(!e.length)break a}(0,Q[c].w)(V,e)}}db();eb();Y(W,0,!0);do b=N,N=N.replace(/<(?!\/)[^>]+><\/[\w:]+>/g,"");while(N!==b);N=N.replace(/<\/i><i>/g,"",N);N=N.replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,fb);c=Wa?"r":"t";b="<"+c;for(var l in Ya)b+=" xmlns:"+l+'="urn:s9e:TextFormatter:'+l+'"';N=b+">"+N+"</"+c+">";if(bb!==a)throw"The parser has been reset during execution";return N}function eb(){G.forEach(function(a){a.O=[];delete a.x;delete a.K});G=[]}
function gb(a,b){b.Q&&b.Q.forEach(function(b){var d=b[0],e=b[1];b=b[2];if(d in a.b){var e=hb(a.b[d],e,b),f;for(f in e)f!==d&&f in a.b||a.r(f,e[f])}});return!0}function hb(a,b,c){var d=b.exec(a);if(!d)return[];var e={};c.forEach(function(a,b){"string"===typeof d[b]&&""!==d[b]&&(e[a]=d[b])});return e}function fb(a){return"&#"+((a.charCodeAt(0)<<10)+a.charCodeAt(1)-56613888)+";"}
function ib(a){Wa=!0;var b=a.g,c=a.e,d=a.p,e=0,f=0;a.c&256&&(e=1,f=a.o&2?2:1);var g=!1;a.o&1||(g=!0);Y(c,e,g);e=d?Oa(V.substr(c,d)):"";if(a.o&1){g=b.indexOf(":");0<g&&(Ya[b.substr(0,g)]=0);N+="<"+b;var k=A(a),g=[],h;for(h in k)g.push(h);g.sort(function(a,b){return a>b?1:-1});g.forEach(function(a){N+=" "+a+'="'+Na(k[a].toString())+'"'});N=3===a.o?d?N+(">"+e+"</"+b+">"):N+"/>":d?N+("><s>"+e+"</s>"):N+">"}else d&&(N+="<e>"+e+"</e>"),N+="</"+b+">";for(X=R=c+d;f&&X<W&&"\n"===V.charAt(X);)--f,++X}
function Y(a,b,c){c&&(J.c&8?b=-1:c=!1);R>=a&&c&&jb();if(X>R){var d=Math.min(a,X);N+=V.substr(R,d-R);R=d;R>=a&&c&&jb()}if(J.c&128)b=a-R,b=V.substr(R,b),/^[ \n\t]*$/.test(b)||(b="<i>"+b+"</i>"),N+=b,R=a,c&&jb();else{for(var e=a,d=0;b&&--e>=R;){var f=V.charAt(e);if(" "!==f&&"\n"!==f&&"\t"!==f)break;"\n"===f&&--b;++d}a-=d;a>R&&(b=Oa(V.substr(R,a-R)),32===(J.c&2096)&&(b=b.replace(/\n/g,"<br/>\n")),N+=b);c&&jb();d&&(N+=V.substr(a,d));R=a+d}}
function kb(a){var b=a.e;a=a.p;var c=V.substr(b,a);Y(b,0,!1);N+="<i>"+Oa(c)+"</i>";Wa=!0;R=b+a}function jb(){J.T&&(N+="</p>",J.T=!1)}function lb(a,b){var c=a.g;a.c&256&&(b=mb(b));x(P(2,c,b,0),a)}function mb(a){for(;a>R&&-1<" \n\t".indexOf(V.charAt(a-1));)--a;return a}function db(){if(T.length){for(var a in S)H[a]=0,Va[a]=0;do{for(;T.length;)U||(T.sort(nb),U=!0),L=T.pop(),J.c&64&&!(B(L,M[M.length-1])||-1<"br i pb v".indexOf(L.g))||ob();M.forEach(function(a){lb(a,W)})}while(T.length)}}
function ob(){if(!L.J){var a=L.e,b=L.p;if(R>a){var c;if((c=L.K)&&0<=M.indexOf(c))a=Math.max(0,a+b-R),a=P(2,c.g,R,a),x(a,c);else{if("i"===L.g&&(c=a+b-R,0<c)){P(3,"i",R,c);return}w(L)}}else if("i"===L.g)kb(L);else if("br"===L.g)J.c&1024||(Y(L.e,0,!1),N+="<br/>");else if("pb"===L.g)Y(L.e,0,!0);else if("v"===L.g)c=J.c,J.c=L.c,Y(L.e+L.p,0,!1),J.c=c;else if(L.o&1)if(c=L,a=c.g,b=S[a],Va[a]>=b.n)w(c);else{var d=c,e=S[d.g],f=!0;if(e.d)for(var g=0;g<e.d.length;++g)if(!e.d[g](d,e)){f=!1;break}if(f){a:{d=c;if(M.length&&
(f=d.g,g=S[f],g.j.G)){var e=M[M.length-1],k=e.g;if(g.j.G[k]){k!==f&&1E3>K&&(f=pb(e,d.e+d.p),Ua(d,f));++K;T.push(d);lb(e,d.e);d=!0;break a}}d=!1}if(!d)a:{d=c;if(M.length&&(e=S[d.g],e.j.R&&(f=M[M.length-1],e.j.R[f.g]))){T.push(d);lb(f,d.e);d=!0;break a}d=!1}d||(H[a]>=b.l?w(c):(b=S[a].k,J.f[b>>3]&1<<(b&7)?(!(c.c&1)||c.x||T.length&&B(T[T.length-1],c)||(a=new v(3,a,c.e,c.p),E(a,A(c)),a.c=c.c,c=a),c.c&4096&&!c.x&&"\n"===V.charAt(c.e+c.p)&&P(3,"i",c.e+c.p,1),ib(c),qb(c)):w(c)))}else w(c)}else rb()}}
function rb(){var a=L;if(H[a.g]){for(var b=[],c=M.length;0<=--c;){var d=M[c];if(B(a,d))break;b.push(d);++K}if(!(0>c)){var e=1E3>K,f=[];b.forEach(function(b){var c=b.g;e&&(b.c&2?f.push(b):e=!1);var d=a.e;b.c&256&&(d=mb(d));c=new v(2,c,d,0);c.c=b.c;ib(c);sb()});ib(a);sb();if(b.length&&1E3>K){d=R;for(c=T.length;0<=--c&&1E3>++K;){var g=T[c];if(g.e>d||g.o&1)break;for(var k=b.length;0<=--k&&1E3>++K;)if(B(g,b[k])){b.splice(k,1);f[k]&&f.splice(k,1);d=Math.max(d,g.e+g.p);break}}d>R&&kb(new v(3,"i",R,d-R))}f.forEach(function(a){var b=
pb(a,R);(a=a.x)&&x(b,a)})}}}function sb(){var a=M.pop();--H[a.g];J=J.Z}function qb(a){var b=a.g,c=a.c,d=S[b];++Va[b];if(3!==a.o){var e=[];c&512?J.f.forEach(function(a,b){e.push(d.f[b]&a)}):J.f.forEach(function(a,b){e.push(d.f[b]&(a&65280|a>>8))});c|=J.c&32;c&16&&(c&=-33);++H[b];M.push(a);J={f:e,c:c,Z:J}}}function pb(a,b){var c=P(a.o,a.g,b,0);E(c,A(a));c.u=a.u;return c}
function P(a,b,c,d){a=new v(a,b,c,d);G.push(a);S[b]&&(a.c=S[b].j.c);S[b]||-1<"br i pb v".indexOf(a.g)?S[b]&&S[b].P?w(a):0>d||0>c||c+d>W?w(a):(U&&T.length&&a.e>=T[T.length-1].e&&(U=!1),T.push(a)):w(a);return a}function Za(a,b,c,d,e){b=P(1,a,b,c);x(b,P(2,a,d,e));return b}function nb(a,b){var c=a.e,d=b.e;if(c!==d)return d-c;if(a.u!==b.u)return b.u-a.u;c=a.p;d=b.p;return c&&d?c-d:c||d?c?-1:1:(c={2:0,3:1,1:2},c[b.o]-c[a.o])}var tb="undefined"===typeof DOMParser||"undefined"===typeof XSLTProcessor;
function ub(a,b){if(tb){var c=new ActiveXObject(b);c.async=!1;c.validateOnParse=!1;c.loadXML(a);return c}return(new DOMParser).parseFromString(a,"text/xml")}function vb(a,b){if(tb){var c=b.createElement("div"),d=b.createDocumentFragment();Z.input=ub(a,"MSXML2.DOMDocument.6.0");Z.transform();for(c.innerHTML=Z.output;c.firstChild;)d.appendChild(c.removeChild(c.firstChild));return d}return b.importNode(Z.transformToFragment(ub(a),b),!0)}
var Z,wb=ub('<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:html="urn:s9e:TextFormatter:html" exclude-result-prefixes="html"><xsl:output method="html" encoding="utf-8" indent="no"/><xsl:template match="B|I|LI|S|U|html:b|p"><xsl:element name="{translate(local-name(),\'BILSU\',\'bilsu\')}"><xsl:apply-templates/></xsl:element></xsl:template><xsl:template match="C"><code class="inline"><xsl:apply-templates/></code></xsl:template><xsl:template match="CENSOR"><xsl:choose><xsl:when test="@with"><xsl:value-of select="@with"/></xsl:when><xsl:otherwise>****</xsl:otherwise></xsl:choose></xsl:template><xsl:template match="CODE"><pre data-s9e-livepreview-postprocess="if(\'undefined\'!==typeof hljs){{var a=this.innerHTML;a in hljs._?this.innerHTML=hljs._[a]:(Object.keys&amp;&amp;7&lt;Object.keys(hljs._).length&amp;&amp;(hljs._={{}}),hljs.highlightBlock(this.firstChild),hljs._[a]=this.innerHTML)}}"><code class="{@lang}"><xsl:apply-templates/></code></pre><script>if("undefined"===typeof hljs){var a=document.getElementsByTagName("head")[0],b=document.createElement("link");b.type="text/css";b.rel="stylesheet";b.href=\'//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.7/styles/default.min.css\';a.appendChild(b);b=document.createElement("script");b.type="text/javascript";b.onload=function(){hljs._={};hljs.initHighlighting()};b.async=!0;b.src=\'//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.7/highlight.min.js\';a.appendChild(b)}\x3c/script></xsl:template><xsl:template match="COLOR"><span style="color:{@color}"><xsl:apply-templates/></span></xsl:template><xsl:template match="E"><xsl:choose><xsl:when test=".=\':)\'"><img src="s.png" alt=":)"/></xsl:when><xsl:otherwise><xsl:value-of select="."/></xsl:otherwise></xsl:choose></xsl:template><xsl:template match="FLOAT"><div style="float:{@float}"><xsl:apply-templates/></div></xsl:template><xsl:template match="FP|HE"><xsl:value-of select="@char"/></xsl:template><xsl:template match="HR"><hr/></xsl:template><xsl:template match="LIST"><xsl:choose><xsl:when test="not(@type)"><ul><xsl:apply-templates/></ul></xsl:when><xsl:when test="starts-with(@type,\'decimal\')or starts-with(@type,\'lower\')or starts-with(@type,\'upper\')"><ol style="list-style-type:{@type}"><xsl:apply-templates/></ol></xsl:when><xsl:otherwise><ul style="list-style-type:{@type}"><xsl:apply-templates/></ul></xsl:otherwise></xsl:choose></xsl:template><xsl:template match="PREG_60D5AB76"><a href="https://twitter.com/#!/search/%23{@tag}"><xsl:apply-templates/></a></xsl:template><xsl:template match="QUOTE"><blockquote><xsl:if test="not(@author)"><xsl:attribute name="class">uncited</xsl:attribute></xsl:if><div><xsl:if test="@author"><cite><xsl:value-of select="@author"/> wrote:</cite></xsl:if><xsl:apply-templates/></div></blockquote></xsl:template><xsl:template match="URL"><a href="{@url}"><xsl:copy-of select="@title"/><xsl:apply-templates/></a></xsl:template><xsl:template match="YOUTUBE"><iframe width="240" height="180" src="http://www.youtube.com/embed/{@id}" allowfullscreen=""/></xsl:template><xsl:template match="br"><br/></xsl:template><xsl:template match="e|i|s"/><xsl:template match="html:a"><a><xsl:copy-of select="@href|@title"/><xsl:apply-templates/></a></xsl:template></xsl:stylesheet>',"MSXML2.FreeThreadedDOMDocument.6.0");
if(tb){var xb=new ActiveXObject("MSXML2.XSLTemplate.6.0");xb.stylesheet=wb;Z=xb.createProcessor()}else Z=new XSLTProcessor,Z.importStylesheet(wb);var yb={};function Ga(a){return u(a,/^(?:[-\w]+)$/)}function Ka(a,b){return gb(a,b)}
function aa(a,b){var c;a:{c=Xa;if(b.b){var d,e,f=A(a);for(d in f){var g=f[d];if(b.b[d]){if(e=b.b[d],e.d){c.r(d);for(var k=0;k<e.d.length;++k)if(g=e.d[k](g,d),!1===g){delete a.b[d];break}!1!==g&&a.r(d,g)}}else delete a.b[d]}for(d in b.b)if(e=b.b[d],!(d in a.b)&&e.q){c=!1;break a}}else E(a,{});c=!0}return c}function Ia(a){return u(a,/^(?:\d+)$/)}function ra(a){var b=$a.urlConfig,c=Xa,d=Qa(a.replace(/^\s+/,"").replace(/\s+$/,""));Sa(b,d)?(c&&(d.attrValue=a),a=!1):a=Ra(d);return a}
function Ea(a){var b=$a.mediasites,c;if("media"in a.b)c=a.b.media,!("id"in a.b)&&"url"in a.b&&-1===a.b.url.indexOf("://")&&a.r("id",a.b.url);else if("url"in a.b){var d=/^(?:([^:]+):)?(?:\/\/([^\/]+))?/.exec(a.b.url);if(d[1]&&b[d[1]+":"])c=b[d[1]+":"];else if(d[2]){d=d[2];do{if(b[d]){c=b[d];break}var e=d.indexOf(".");if(-1==e)break;d=d.substr(1+e)}while(""<d)}}c&&(b=a.x||a,d=a.e,c=P(3,c.toUpperCase(),d,b.e+b.p-d),E(c,A(a)),c.u=a.u);return!1}function oa(a){return/^[-\w+., ]+$/.test(a)?a:!1}
function ea(a){return/^[-\w]+$/.test(a)?a:!1}function za(a){return u(a,/^[a-z0-9]+$/i)}function ga(a){return/^(?:#[0-9a-f]{3,6}|rgb\(\d{1,3}, *\d{1,3}, *\d{1,3}\)|[a-z]+)$/i.test(a)?a:!1}function na(a){var b={A:"upper-alpha",I:"upper-roman",a:"lower-alpha",i:"lower-roman",1:"decimal"};return a in b?b[a]:a}function ka(a){return u(a,/^(?:left|none|right)$/i)}
window.s9e={TextFormatter:{disablePlugin:function(a){Q[a]&&(Q[a].P=!0)},enablePlugin:function(a){Q[a]&&(Q[a].P=!1)},preview:function(a,b){function c(a,b){for(var c=a.childNodes,f=b.childNodes,g=c.length,k=f.length,h,O,C=0,I=0;C<g&&C<k;){h=c[C];O=f[C];if(!d(h,O))break;++C}for(var F=Math.min(g-C,k-C);I<F;){h=c[g-(I+1)];O=f[k-(I+1)];if(!d(h,O))break;++I}h=e.createDocumentFragment();for(F=C;F<k-I;)O=f[F].cloneNode(!0),h.appendChild(O),++F;for(F=g-I;--F>=C;)a.removeChild(c[F]);I?a.insertBefore(h,a.childNodes[C]):
a.appendChild(h)}function d(a,b){if(a.nodeName!==b.nodeName||a.nodeType!==b.nodeType)return!1;if(3===a.nodeType||8===a.nodeType)return a.nodeValue!==b.nodeValue&&(a.nodeValue=b.nodeValue),!0;if(a.isEqualNode&&a.isEqualNode(b))return!0;for(var d=a.attributes,e=b.attributes,f=e.length,g=d.length;0<=--g;){var h=d[g],k=h.namespaceURI,h=h.name;b.hasAttributeNS(k,h)||a.removeAttributeNS(k,h)}for(g=f;0<=--g;)d=e[g],k=d.namespaceURI,h=d.name,d=d.value,d!==a.getAttributeNS(k,h)&&a.setAttributeNS(k,h,d);c(a,
b);return!0}for(var e=b.ownerDocument,f=vb(cb(a),e),g=f.querySelectorAll("[data-s9e-livepreview-postprocess]"),k=g.length;0<=--k;){var h=g[k].getAttribute("data-s9e-livepreview-postprocess");yb[h]||(yb[h]=new Function(h));yb[h].call(g[k])}c(b,f)}}};})();

		var text,
			textareaEl = document.getElementsByTagName('textarea')[0],
			previewEl = document.getElementById('preview');

		setInterval(function()
		{
			if (textareaEl.value === text)
			{
				return;
			}

			text = textareaEl.value;
			s9e.TextFormatter.preview(text, previewEl);
		}, 20);

		function toggle(el)
		{
			(el.checked) ? s9e.TextFormatter.enablePlugin(el.id)
			             : s9e.TextFormatter.disablePlugin(el.id);

			text = '';
		}
	</script>
	<script type="text/javascript" src="http://cdnjs.cloudflare.com/ajax/libs/punycode/1.3.2/punycode.min.js"></script>
</body>
</html>