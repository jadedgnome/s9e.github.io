<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8" />
	<title>s9e\TextFormatter &bull; Demo</title>
	<base href="http://s9e.github.io/TextFormatter/demo.html" />
	<style type="text/css">
		#preview
		{
			font-family: sans;
			padding: 5px;
			background-color: #f8f8f8;
			border: dashed 1px #ddd;
			border-radius: 5px;
		}

		code
		{
			padding: 2px;
			background-color: #fff;
			border-radius: 3px;
			border: solid 1px #ddd;
		}
	</style>

</head>
<body>
	<div style="float:left;width:80%;max-width:800px">
		<form>
			<textarea style="width:99%" rows="15">[float=right][youtube]http://www.youtube.com/watch?v=QH2-TGUlwu4[/youtube][/float]

This is a demo of the JavaScript port of [url=https://github.com/s9e/TextFormatter/tree/master/src/ title="s9e\TextFormatter at GitHub.com"]s9e\TextFormatter[/url].

The following plugins have been enabled:

[list]
  [*][b]Autolink[/b] --- loose URLs such as http://github.com are automatically turned into links
  [*][b]BBCodes[/b]
  [list=circle]
    [*][b]bold[/b], [i]italic[/i], [u]underline[/u], [s]strikethrough[/s],
    [*][color=#f05]co[/color][color=#2f2]lo[/color][color=#02f]r,[/color]
    [*][C][URL][/C], [C:123][C][/C:123], [C][YOUTUBE][/C], [C][FLOAT][/C], and [C][LIST][/C]
    [*][C][CODE][/C] with real-time syntax highlighting via [url=http://softwaremaniacs.org/soft/highlight/en/]Highlight.js[/url]
	[code]$who = "world";
printf("Hello %s\n", $who);[/code]
  [/list]
  [*][b]Censor[/b] --- the word "apple" is censored and automatically replaced with "banana"
  [*][b]Emoticons[/b] --- one emoticon :) has been added
  [*][b]FancyPants[/b] --- some typography is enhanced, e.g. (c) (tm) and "quotes"
  [*][b]Generic[/b] --- the Generic plugin provides a way to perform generic regexp-based replacements that are HTML-safe. Here, text that matches [C]/#(?<tag>[a-z0-9]+)/i[/C] is replaced with the template [C]<a href="https://twitter.com/#!/search/%23{@tag}"><xsl:apply-templates/></a>[/C] -- For example: #PHP, #fml
  [*][b]HTMLElements[/b] --- [C]<a>[/C] and [C]<b>[/C] tags are allowed, with two whitelisted attributes for [C]<a>[/C]: [C]href[/C] and [C]title[/C]. Example: <a href="https://github.com" title="GitHub - Social Coding"><b>GitHub</b></a>
  [*][b]HTMLEntities[/b] --- HTML entities such as &amp;hearts; are decoded
[/list]

The parser/renderer used on this page page has been generated by [url=https://github.com/s9e/TextFormatter/blob/master/scripts/generateLiveDemo.php]this script[/url]. It's been minified with Google Closure Compiler to 20.5 KB (8.6 KB compressed)</textarea>
		</form>
	</div>

	<div style="float:left;">
		<form><input type="checkbox" id="Autolink" checked="checked" onchange="toggle(this)"><label for="Autolink">&nbsp;Autolink</label><br><input type="checkbox" id="BBCodes" checked="checked" onchange="toggle(this)"><label for="BBCodes">&nbsp;BBCodes</label><br><input type="checkbox" id="Censor" checked="checked" onchange="toggle(this)"><label for="Censor">&nbsp;Censor</label><br><input type="checkbox" id="Emoticons" checked="checked" onchange="toggle(this)"><label for="Emoticons">&nbsp;Emoticons</label><br><input type="checkbox" id="FancyPants" checked="checked" onchange="toggle(this)"><label for="FancyPants">&nbsp;FancyPants</label><br><input type="checkbox" id="Generic" checked="checked" onchange="toggle(this)"><label for="Generic">&nbsp;Generic</label><br><input type="checkbox" id="HTMLElements" checked="checked" onchange="toggle(this)"><label for="HTMLElements">&nbsp;HTMLElements</label><br><input type="checkbox" id="HTMLEntities" checked="checked" onchange="toggle(this)"><label for="HTMLEntities">&nbsp;HTMLEntities</label><br><input type="checkbox" id="MediaEmbed" checked="checked" onchange="toggle(this)"><label for="MediaEmbed">&nbsp;MediaEmbed</label></form>
	</div>

	<div style="clear:both"></div>

	<div id="preview"></div>

	<script type="text/javascript">function aa(a){var b=document.createElement("b");b.innerHTML=a.replace(/</g,"&lt;");return b.textContent}function ba(a){var b={"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;"};return a.replace(/[<>&"]/g,function(a){return b[a]})}function ca(a){var b={"<":"&lt;",">":"&gt;","&":"&amp;"};return a.replace(/[<>&]/g,function(a){return b[a]})}function da(a){if(!/^\d+\.\d+\.\d+\.\d+$/.test(a))return!1;var b=4;for(a=a.split(".");0<=--b;)if("0"===a[b].charAt(0)||255<a[b])return!1;return!0}
function ea(a){return/^(\d*:){2,7}\d+(?:\.\d+\.\d+\.\d+)?$/.test(a)?a:!1}function l(a,b){return b.test(a)?a:!1}
function fa(a){var b=ga.urlConfig,d=n,c=ha(a.replace(/^\s+/,"").replace(/\s+$/,"")),e="";if(""!==c.v){if(!b.ea.test(c.v))return d&&p(d,"URL scheme is not allowed",{attrValue:a,scheme:c.v}),!1;e+=c.v+":"}if(""===c.q)if("file"===c.v)e+="//";else{if(""!==c.v)return!1}else{e+="//";if(!/^(?=[a-z])[-a-z0-9]{0,62}[a-z0-9](?:\.(?=[a-z])[-a-z0-9]{0,62}[a-z0-9])*$/i.test(c.q)&&!da(c.q)&&!ea(c.q.replace(/^\[(.*)\]$/,"$1",c.q)))return d&&p(d,"URL host is invalid",{attrValue:a,host:c.q}),!1;if(b.fa&&b.fa.test(c.q)||
b.la&&!b.la.test(c.q))return d&&p(d,"URL host is not allowed",{attrValue:a,host:c.q}),!1;""!==c.ca&&(e+=rawurlencode(decodeURIComponent(c.ca)),""!==c.Z&&(e+=":"+rawurlencode(decodeURIComponent(c.Z))),e+="@");e+=c.q;""!==c.$&&(e+=":"+c.$)}a=c.ja;""!==c.ba&&(a+="?"+c.ba);""!==c.X&&(a+="#"+c.X);a=a.replace(/%.?[a-f]/,function(a){return a[0].toUpperCase()},a);e+=a.replace(/[^\u0020-\u007E]+/g,encodeURIComponent).replace(/%(?![0-9A-Fa-f]{2})|[^!#-&*-;=?-Z_a-z]/g,escape);c.v||(e=e.replace(/^([^\/]*):/,
"$1%3A",e));return e}
function ha(a){a=/^(?:([a-z][-+.\w]*):)?(?:\/\/(?:([^:\/?#]*)(?::([^\/?#]*)?)?@)?(?:(\[[a-f\d:]+\]|[^:\/?#]+)(?::(\d*))?)?(?![^\/?#]))?([^?#]*)(?:\?([^#]*))?(?:#(.*))?$/i.exec(a);a={v:""<a[1]?a[1]:"",ca:""<a[2]?a[2]:"",Z:""<a[3]?a[3]:"",q:""<a[4]?a[4]:"",$:""<a[5]?a[5]:"",ja:""<a[6]?a[6]:"",ba:""<a[7]?a[7]:"",X:""<a[8]?a[8]:""};a.v=a.v.toLowerCase();a.q=a.q.replace(/[\u3002\uff0e\uff61]/g,".").replace(/\.+$/g,"");/[^\x00-\x7F]/.test(a.q)&&punycode&&(a.q=punycode.toASCII(a.q));return a}
function q(){}q.prototype.P={};q.prototype.R=[];function s(a,b,d,c){c=c||{};"attrName"in c||!a.F||(c.attrName=a.F);"tag"in c||!a.O||(c.tag=a.O);a.P[b]&&a.P[b].forEach(function(a){a(d,c)});a.R.push([b,d,c])}q.prototype.get=function(){return this.R};q.prototype.on=function(a,b){this.P[a].push(b)};q.prototype.n=function(a){this.F=a};function ia(a){s(n,"debug","Skipping end tag with no start tag",a)}function p(a,b,d){s(a,"err",b,d)}
function t(a,b,d,c){this.p=a;this.g=b;this.k=d;this.w=c;this.d={};this.V=[];isNaN(a+d+c)&&u(this)}t.prototype.H=!1;t.prototype.r=0;function u(a){a.H||(a.H=!0,a.V.forEach(function(a){u(a)}))}function w(a,b){a.g===b.g&&(1===a.p&&2===b.p&&b.k>=a.k?(a.G=b,b.N=a):2===a.p&&1===b.p&&b.k<=a.k&&(a.N=b,b.G=a))}function x(a){var b={},d;for(d in a.d)b[d]=a.d[d];return b}function ja(a,b){return a.H||a.g!==b.g||1!==b.p||2!==a.p||a.k<b.k||a.N&&a.N!==b||b.G&&b.G!==a?!1:!0}
function ka(a){return"br"===a.g||"i"===a.g||"pb"===a.g}t.prototype.n=function(a,b){this.d[a]=b};function z(a,b){a.d={};for(var d in b)a.d[d]=b[d]}
var A,C,D,G,I,J,n=new q,K=1E3,la,L,M,Q={BBCodes:{z:"[",x:/\[\/?([*BIS]|C(?:O(?:DE|LOR))?|FLOAT|LIST|MEDIA|QUOTE|U(?:RL)?|YOUTUBE)(?=[\] =:\/])/ig,u:1E4,D:"warn",s:function(a,b){var d={B:{},I:{},U:{},S:{},URL:{K:["url"]},QUOTE:{L:"author"},LIST:{L:"type"},"*":{J:"LI"},C:{},COLOR:{},FLOAT:{},CODE:{L:"lang"},MEDIA:{K:["url"]},YOUTUBE:{K:["url"],L:"url"}};b.forEach(function(c){var b=c[1][0].toUpperCase(),h=d[b]||{},g=h.J||b,k=c[0][1],f=k+c[0][0].length;":"===a.charAt(f)?(c=/^:\d*/.exec(a.substr(f))[0],
f+=c.length):c="";if("/"===a.charAt(k+1))"]"===a.charAt(f)&&""===c&&O(2,g,k,1+f-k);else{var m=1,F={},U=!1,ya=f,N,r;if(h.aa)for(N in h.aa)F[N]=h.aa[N];for(;f<P;)if(r=a.charAt(f)," "===r)++f;else{if("]"===r||"/"===r){if("/"===r&&(m=3,++f,f===P||"]"!==a.charAt(f)))return;U=!0;++f;break}var H=/^[-\w]*/.exec(a.substr(f))[0].length;if(H){if(f+H>=P)return;N=a.substr(f,H).toLowerCase();f+=H;if("="!==a.charAt(f))continue}else if("="===r&&f===ya)N=h.L||b.toLowerCase();else return;if(++f>=P)return;r=a.charAt(f);
if('"'===r||"'"===r){for(H=f+1;;){++f;f=a.indexOf(r,f);if(0>f)return;for(var E=0;"\\"===a.charAt(f-++E););if(E%2)break}r=a.substr(H,f-H).replace(/\\([\\'"])/g,"$1");++f}else{r=/[^\]]*?(?=\s*(?: \/)?\]|\s+[-\w]+=)/.exec(a.substr(f));if(!r)continue;r=r[0];f+=r.length}F[N]=r}if(U){if(1===m){var v=[];h.K&&h.K.forEach(function(a){a in F||v.push(a)});var B;if(v.length||c||h.ga){r="[/"+b+c+"]";var y=a.toUpperCase().indexOf(r,f);if(0>y){if(c||h.ga)return}else v.forEach(function(b){F[b]=a.substr(f,y-f)}),
B=O(2,g,y,r.length)}b=O(1,g,k,f-k);B&&w(b,B)}else b=O(3,g,k,f-k);z(b,F)}}})}},Censor:{x:/(?:^|\W)apple(?!\w)/gi,u:1E4,D:"warn",s:function(a,b){var d={F:"with",J:"CENSOR",M:[[/^apple$/i,"banana"]]},c=d.J,e=d.F;b.forEach(function(a){if(!d.da||!d.da.test(a[0][0])){var b=/^\W/.test(a[0][0])?1:0,k=a[0][0].substr(b);a=O(3,c,a[0][1]+b,k.length);if(d.M)for(b=0;b<d.M.length;++b){var f=d.M[b][1];if(d.M[b][0].test(k)){a.n(e,f);break}}}})}},Emoticons:{z:":)",x:/:\)/g,u:1E4,D:"warn",s:function(a,b){var d={J:"E"};
b.forEach(function(b){d.ha&&b[0][1]&&d.ha.test(a.charAt(b[0][1]-1))||O(3,d.J,b[0][1],b[0][0].length)})}},Generic:{s:function(a){[["G60D5AB76",/#([a-z0-9]+)/ig,0,["","tag"]]].forEach(function(b){var d=b[0],c=b[1],e=b[2];b=b[3];var h;for(c.lastIndex=0;h=c.exec(a);){var g=h.index,k=h[0].length,f;if(e&&""!==h[e]){var m=a.indexOf(h[e],g),F=h[e].length,U=m-g;f=ma(d,g,U,m+F,k-(U+F))}else f=O(3,d,g,k);b.forEach(function(a,b){a&&f.n(a,h[b])})}})}},HTMLElements:{z:"<",x:/<(?:\/([ab])|([ab])((?:\s+[a-z][-a-z]*(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s"'=<>`]+))?)*)\s*\/?)\s*>/ig,
u:1E4,D:"warn",s:function(a,b){var d={ka:"html"};b.forEach(function(b){var e="/"===a.charAt(b[0][1]+1),h=b[0][1],g=b[0][0].length,k=b[2-e][0].toLowerCase(),f=d.y&&d.y[k]&&d.y[k][""]?d.y[k][""]:d.ka+":"+k;if(e)O(2,f,h,g);else for(var e="/>"===b[0][0].substr(g-2)?ma(f,h,g,h+g,0):O(1,f,h,g),g=/[a-z][-a-z]*(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s"'=<>`]+))?/gi,m;m=g.exec(b[3][0]);)h=m[0].indexOf("="),0>h&&(h=m[0].length,m[0]+="="+m[0].toLowerCase()),f=m[0].substr(0,h).toLowerCase().replace(/^\s+/,"").replace("/s+$/",
""),h=m[0].substr(1+h).replace(/^\s+/,"").replace("/s+$/",""),d.y&&d.y[k]&&d.y[k][f]&&(f=d.y[k][f]),/^["']/.test(h)&&(h=h.substr(1,h.length-2)),e.n(f,aa(h))})}},Autolink:{z:"://",x:/https?:\/\/\S(?:[^\s\[\]]*(?:\[\w*\])?)+/ig,u:1E4,D:"warn",s:function(a,b){b.forEach(function(a){for(var b=a[0][0];;)if(b=b.replace(/[\s!"',.<>?]+$/,""),")"===b.substr(-1)&&b.replace(/[^(]+/g,"").length<b.replace(/[^)]+/g,"").length)b=b.substr(0,b.length-1);else break;var e=O(1,"URL",a[0][1],0);e.n("url",b);a=O(2,"URL",
a[0][1]+b.length,0);w(e,a)})}},HTMLEntities:{z:"&",x:/&(?:[a-z]+|#(?:[0-9]+|x[0-9a-f]+));/ig,u:1E4,D:"warn",s:function(a,b){b.forEach(function(a){var b=a[0][0],e=aa(b);e!==b&&O(3,"HE",a[0][1],b.length).n("char",e)})}},FancyPants:{s:function(a){function b(b,e,f,h){for(;k=e.exec(a);){var g=O(3,c,k.index+k[0].indexOf(b),1),m=O(3,c,k.index+k[0].length-1,1);g.n(d,f);m.n(d,h);g.V.push(m);g.H&&u(m)}}var d="char",c="FP",e=0<=a.indexOf("'"),h=0<=a.indexOf('"'),g,k,f,m;if(e)for(g=/[a-z]'|(?:^|\s)'(?=[a-z]|[0-9]{2})/gi;k=
g.exec(a);)tag=O(3,c,k.index+k[0].indexOf("'"),1),tag.n(d,"\u2019"),tag.r=10;if(e||h||0<=a.indexOf("x"))for(g=/[0-9](?:'s|["']? ?x(?= ?[0-9])|["'])/g;k=g.exec(a);)if(f=k.index+k[0].length-1,"x"===k[0].charAt(f)&&O(3,c,f,1).n(d,"\u00d7"),m=k[0].charAt(1),"'"===m||'"'===m)f=1+k.index,m="'s"===k[0].substr(1,2)?"\u2019":"'"===m?"\u2032":"\u2033",O(3,c,f,1).n(d,m);e&&b("'",/(?:^|\W)'.+?'(?!\w)/g,"\u2018","\u2019");h&&b('"',/(?:^|\W)".+?"(?!\w)/g,"\u201c","\u201d");if(0<=a.indexOf("...")||0<=a.indexOf("--"))for(g=
/---?|\.\.\./g;k=g.exec(a);)f=k.index,e=k[0].length,m={"--":"\u2013","---":"\u2014","...":"\u2026"}[k[0]],O(3,c,f,e).n(d,m);if(0<=a.indexOf("("))for(g=/\((?:c|r|tm)\)/gi;k=g.exec(a);)f=k.index,e=k[0].length,m={"(c)":"\u00a9","(r)":"\u00ae","(tm)":"\u2122"}[k[0].toLowerCase()],O(3,c,f,e).n(d,m)}},MediaEmbed:{z:"://",x:/\bhttps?:\/\/(?:[-.\w]+\.)?youtu(?:\.be|be\.com)\/[^["'\s]+(?!\S)/g,u:1E4,D:"warn",s:function(a,b){b.forEach(function(a){var b=a[0][0];a=O(3,"MEDIA",a[0][1],b.length);a.n("url",b);a.r=
-10})}}},R,ga={urlConfig:{ea:/^https?$/i},mediasites:{"youtube.com":"youtube","youtu.be":"youtube"}},na={e:[55],f:[63],b:0},T={B:{c:[S],j:10,h:{b:2},l:1E3,m:0,e:[51],f:[63]},I:{c:[S],j:10,h:{b:2},l:1E3,m:0,e:[51],f:[63]},U:{c:[S],j:10,h:{b:2},l:1E3,m:0,e:[51],f:[63]},S:{c:[S],j:10,h:{b:2},l:1E3,m:0,e:[51],f:[63]},URL:{d:{url:{c:[oa],o:1},title:{o:0}},c:[S],j:10,h:{b:66},l:1E3,m:1,e:[53],f:[61]},QUOTE:{d:{author:{o:0}},c:[S],j:10,h:{b:512},l:1E3,m:2,e:[55],f:[63]},LIST:{d:{type:{c:[pa,qa],o:0}},c:[S],
j:10,h:{b:672},l:1E3,m:2,e:[40],f:[63]},LI:{c:[S],j:10,h:{W:{LI:1},b:512},l:1E3,m:3,e:[55],f:[63]},C:{c:[S],j:10,h:{b:18},l:1E3,m:0,e:[0],f:[0]},COLOR:{d:{color:{c:[ra],o:1}},c:[S],j:10,h:{b:2},l:1E3,m:0,e:[51],f:[63]},FLOAT:{d:{"float":{c:[sa],o:1}},c:[S],j:10,h:{b:512},l:1E3,m:2,e:[55],f:[63]},CODE:{d:{lang:{c:[ta],o:0}},c:[S],j:10,h:{b:912},l:1E3,m:2,e:[0],f:[0]},CENSOR:{d:{"with":{o:0}},c:[S],j:10,h:{b:145},l:1E3,m:4,e:[0],f:[0]},E:{c:[S],j:10,h:{b:129},l:1E3,m:0,e:[48],f:[63]},G60D5AB76:{d:{tag:{c:[ua],
o:1}},c:[S],j:10,h:{b:66},l:1E3,m:1,e:[53],f:[61]},"html:a":{d:{href:{c:[oa],o:0},title:{o:0}},c:[S],j:10,h:{b:66},l:1E3,m:1,e:[53],f:[61]},"html:b":{c:[S],j:10,h:{b:2},l:1E3,m:0,e:[51],f:[63]},HE:{d:{"char":{o:1}},c:[S],j:10,h:{b:129},l:1E3,m:4,e:[48],f:[63]},FP:{d:{"char":{o:1}},c:[S],j:10,h:{b:129},l:1E3,m:4,e:[48],f:[63]},MEDIA:{c:[va],j:10,h:{b:81},l:1E3,m:5,e:[0],f:[0]},YOUTUBE:{d:{url:{c:[oa],o:0},id:{c:[wa],o:1},t:{c:[xa],o:0},list:{c:[wa],o:0}},T:[["url",/youtube\.com\/(?:watch.*?v=|v\/)([-\w]+)/,
["","id"]],["url",/youtu\.be\/([-\w]+)/,["","id"]],["url",/[#&?]t=(\d+)/,["","t"]],["url",/&list=([-\w]+)/,["","list"]],["url",/^([-\w]+)$/,["","id"]]],c:[za,S],j:10,h:{b:145},l:1E3,m:1,e:[0],f:[0]}},V,W,X,P,Aa=0,Y;
function Ba(a){a=a.replace(/\r\n?/g,"\n",a);a=a.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F]+/g,"",a);var b=n;b.R=[];delete b.F;delete b.O;G=0;J=!1;la={};M="";X=a;P=X.length;V=[];W=!0;Y=0;++Aa;a=Aa;for(var d in Q)if(b=Q[d],!(b.Q||b.z&&0>X.indexOf(b.z))){var c=[];if(b.x){var c=b.x,e=[],h=void 0;for(c.lastIndex=0;h=c.exec(X);){for(var g=+h.index,k=[[h[0],g]],f=0;++f<h.length;){var m=h[f];void 0===m?k.push(["",-1]):(k.push([m,X.indexOf(m,g)]),g+=m.length)}e.push(k)}c=e;e=c.length;if(!e)continue;e>b.u&&(c=c.slice(0,
b.u),e={pluginName:d,limit:b.u},"warn"===b.D&&s(n,"warn","Regexp limit exceeded. Only the allowed number of matches will be processed",e))}b.s(X,c)}Ca();if(Aa!==a)throw"The parser has been reset during execution";return M}function Da(a,b){b.T&&b.T.forEach(function(b){var c=b[0],e=b[1];b=b[2];if(c in a.d){var h;(h=e.exec(a.d[c]))&&b.forEach(function(b,d){if(""!==b&&"string"===typeof h[d]){var e=h[d];b!==c&&b in a.d||a.n(b,e)}})}});return!0}
function Ea(){var a;Z(P,0,!0);do a=M,M=M.replace(/<((?:\w+:)?\w+)[^>]*><\/\1>/g,"");while(M!==a);M=M.replace(/<\/i><i>/g,"",M);var b=J?"r":"t";a="<"+b;for(var d in la)a+=" xmlns:"+d+'="urn:s9e:TextFormatter:'+d+'"';M=a+">"+M+"</"+b+">"}
function Fa(a){J=!0;var b=a.g,d=a.k,c=a.w,e=0,h=0;a.b&512&&(e=a.p&1?2:1,h=a.p&2?2:1);var g=!1;a.p&1||(g=!0);Z(d,e,g);e=c?ca(X.substr(d,c)):"";if(a.p&1){g=b.indexOf(":");0<g&&(la[b.substr(0,g)]=0);M+="<"+b;var k=x(a),g=[],f;for(f in k)g.push([f]);g.sort(function(a,b){return a>b?1:-1});g.forEach(function(a){M+=" "+a+'="'+ba(k[a].toString())+'"'});M=3===a.p?c?M+(">"+e+"</"+b+">"):M+"/>":c?M+("><s>"+e+"</s>"):M+">"}else c&&(M+="<e>"+e+"</e>"),M+="</"+b+">";for(Y=R=d+c;h&&Y<P&&"\n"===X.charAt(Y);)--h,
++Y}function Z(a,b,d){d&&(D.b&8?b=-1:d=!1);R>=a&&d&&$();if(Y>R){var c=Math.min(a,Y);M+=X.substr(R,c-R);R=c;R>=a&&d&&$()}if(D.b&32)b=a-R,b=X.substr(R,b),/^[ \n\t]*$/.test(b)||(b="<i>"+b+"</i>"),M+=b,R=a,d&&$();else{for(var e=a,c=0;b&&--e>=R;){var h=X.charAt(e);if(" "!==h&&"\n"!==h&&"\t"!==h)break;"\n"===h&&--b;++c}a-=c;a>R&&(b=ca(X.substr(R,a-R)),D.b&128||(b=b.replace(/\n/g,"<br/>\n")),M+=b);d&&$();c&&(M+=X.substr(a,c));R=a+c}}
function Ga(a){var b=a.k;a=a.w;var d=X.substr(b,a);Z(b,0,!1);M+="<i>"+ca(d)+"</i>";J=!0;R=b+a}function $(){D.Y&&(M+="</p>",D.Y=!1)}function Ha(a,b){var d=a.g;a.b&512&&(b=Ia(b));w(O(2,d,b,0),a)}function Ia(a){for(;a>R&&-1<" \n\t".indexOf(X.charAt(a-1));)--a;return a}function Ca(){R=0;A={};C={};L=[];I=null;D=na;D.Y=!1;for(var a in T)A[a]=0,C[a]=0;do{for(;V.length;)W||(V.sort(Ja),W=!0),I=V.pop(),D.b&16&&!ja(I,L[L.length-1])&&!ka(I)||Ka();L.forEach(function(a){Ha(a,P)})}while(V.length);Ea()}
function Ka(){if(!I.H){var a=I.k,b=I.w;if(a+b>P)u(I);else if(R>a){var d;if((d=I.N)&&0<=L.indexOf(d))a=Math.max(0,a+b-R),a=O(2,d.g,R,a),w(a,d);else{if("i"===I.g&&(d=a+b-R,0<d)){O(3,"i",R,d);return}u(I)}}else if("i"===I.g)Ga(I);else if("br"===I.g)D.b&128||(Z(I.k,0,!1),M+="<br/>");else if("pb"===I.g)Z(I.k,0,!0);else if(I.p&1)if(d=I,a=d.g,b=T[a],C[a]>=b.l)p(n,"Tag limit exceeded",{tag:d,tagName:a,tagLimit:b.l}),u(d);else{var c=d,e=T[c.g],h=!0;if(e.c){n.O=c;for(var g=0;g<e.c.length;++g)if(!e.c[g](c,e)){h=
!1;break}delete n.O}if(h){a:{c=d;if(L.length&&(e=T[c.g],e.h.W&&(h=L[L.length-1],e.h.W[h.g]))){V.push(c);Ha(h,c.k);c=!0;break a}c=!1}c||(A[a]>=b.j?(p(n,"Nesting limit exceeded",{tag:d,tagName:a,nestingLimit:b.j}),u(d)):(b=T[a].m,D.e[b>>5]&1<<(b&31)?(d.b&1&&!d.G&&(a=new t(3,a,d.k,d.w),z(a,x(d)),a.b=d.b,d=a),Fa(d),La(d)):(s(n,"warn","Tag is not allowed in this context",{tag:d,tagName:a}),u(d))))}else u(d)}else Ma()}}
function Ma(){var a=I;if(A[a.g]){for(var b=[],d=L.length;0<=--d;){var c=L[d];if(ja(a,c))break;if(++G>K)throw"Fixing cost exceeded";b.push(c)}if(0>d)ia({tag:a});else{var e=G<K,h=[];b.forEach(function(b){var c=b.g;e&&(b.b&2?h.push(b):e=!1);var d=a.k;b.b&512&&(d=Ia(d));c=new t(2,c,d,0);c.b=b.b;Fa(c);Na()});Fa(a);Na();if(b.length&&G<K){c=R;for(d=V.length;0<=--d&&++G<K;){var g=V[d];if(g.k>c||g.p&1)break;for(var k=b.length;0<=--k&&++G<K;)if(ja(g,b[k])){b.splice(k,1);h[k]&&h.splice(k,1);c=Math.max(c,g.k+
g.w);break}}c>R&&Ga(new t(3,"i",R,c-R))}h.forEach(function(a){var b=O(a.p,a.g,R,0);z(b,x(a));b.r=a.r;(a=a.G)&&w(b,a)})}}}function Na(){var a=L.pop();--A[a.g];D=D.ia}function La(a){function b(a,b){for(var c=-1,d=a.length,e=Array(d);++c<d;)e[c]=a[c]&b[c];return e}var d=a.g,c=a.b,e=T[d];++C[d];3!==a.p&&(++A[d],L.push(a),a=b(e.e,e.e),c&64&&(a=b(a,D.e)),e=b(D.f,e.f),a=b(a,e),D.b&256&&(c|=256),c&256&&(c|=128),D={e:a,f:e,b:c,ia:D})}
function O(a,b,d,c){a=new t(a,b,d,c);T[b]&&(a.b=T[b].h.b);T[b]||ka(a)?T[b]&&T[b].Q?(s(n,"warn","Tag is disabled",{tag:a,tagName:b}),u(a)):0>c||0>d?u(a):(W&&V.length&&a.k>=V[V.length-1].k&&(W=!1),V.push(a)):u(a);return a}function ma(a,b,d,c,e){b=O(1,a,b,d);w(b,O(2,a,c,e));return b}function Ja(a,b){var d=a.k,c=b.k;if(d!==c)return c-d;if(a.r!==b.r)return b.r-a.r;d=a.w;c=b.w;return d&&c?d-c:d||c?d?-1:1:(d={2:0,3:1,1:2},d[b.p]-d[a.p])}
function Oa(a){return(new DOMParser).parseFromString(a,"text/xml")}var Pa=new XSLTProcessor;Pa.importStylesheet(Oa('<?xml version="1.0" encoding="utf-8"?><xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:html="urn:s9e:TextFormatter:html" exclude-result-prefixes="html"><xsl:output method="html" encoding="utf-8" indent="no"/><xsl:template match="B|I|LI|S|U|html:b|p"><xsl:element name="{translate(local-name(),\'BILSU\',\'bilsu\')}"><xsl:apply-templates/></xsl:element></xsl:template><xsl:template match="C"><code class="inline"><xsl:apply-templates/></code></xsl:template><xsl:template match="CENSOR"><xsl:choose><xsl:when test="@with"><xsl:value-of select="@with"/></xsl:when><xsl:otherwise>****</xsl:otherwise></xsl:choose></xsl:template><xsl:template match="CODE"><pre data-s9e-livepreview-postprocess="if(\'undefined\'!==typeof hljs){{var a=this.innerHTML;a in hljs._?this.innerHTML=hljs._[a]:(Object.keys&amp;&amp;7&lt;Object.keys(hljs._).length&amp;&amp;(hljs._={{}}),hljs.highlightBlock(this.firstChild),hljs._[a]=this.innerHTML)}};"><code class="{@lang}"><xsl:apply-templates/></code></pre><xsl:if test="not(following::CODE)"><script>if("undefined"===typeof hljs){var a=document.getElementsByTagName("head")[0],b=document.createElement("link");b.type="text/css";b.rel="stylesheet";b.href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/7.3/styles/github.min.css";a.appendChild(b);b=document.createElement("script");b.type="text/javascript";b.onload=function(){hljs._={};hljs.initHighlighting()};b.async=!0;b.src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/7.3/highlight.min.js";a.appendChild(b)};\x3c/script></xsl:if></xsl:template><xsl:template match="COLOR"><span style="color:{@color}"><xsl:apply-templates/></span></xsl:template><xsl:template match="E"><xsl:choose><xsl:when test=".=\':)\'"><img src="s.png" alt=":)"/></xsl:when><xsl:otherwise><xsl:value-of select="."/></xsl:otherwise></xsl:choose></xsl:template><xsl:template match="FLOAT"><div style="float:{@float}"><xsl:apply-templates/></div></xsl:template><xsl:template match="FP|HE"><xsl:value-of select="@char"/></xsl:template><xsl:template match="G60D5AB76"><a href="https://twitter.com/#!/search/%23{@tag}"><xsl:apply-templates/></a></xsl:template><xsl:template match="LIST"><xsl:choose><xsl:when test="not(@type)"><ul><xsl:apply-templates/></ul></xsl:when><xsl:when test="contains(\'upperlowerdecim\',substring(@type,1,5))"><ol style="list-style-type:{@type}"><xsl:apply-templates/></ol></xsl:when><xsl:otherwise><ul style="list-style-type:{@type}"><xsl:apply-templates/></ul></xsl:otherwise></xsl:choose></xsl:template><xsl:template match="QUOTE"><blockquote><xsl:if test="not(@author)"><xsl:attribute name="class">uncited</xsl:attribute></xsl:if><div><xsl:if test="@author"><cite><xsl:value-of select="@author"/> wrote:</cite></xsl:if><xsl:apply-templates/></div></blockquote></xsl:template><xsl:template match="URL"><a href="{@url}"><xsl:copy-of select="@title"/><xsl:apply-templates/></a></xsl:template><xsl:template match="YOUTUBE"><iframe width="240" height="180" src="http://www.youtube.com/embed/{@id}" allowfullscreen=""/></xsl:template><xsl:template match="br"><br/></xsl:template><xsl:template match="e|i|s"/><xsl:template match="html:a"><a><xsl:copy-of select="@href"/><xsl:copy-of select="@title"/><xsl:apply-templates/></a></xsl:template></xsl:stylesheet>'));
var Qa={};function S(a,b){var d;a:{d=n;if(b.d){var c,e,h=x(a);for(c in h){var g=h[c];if(b.d[c]){if(e=b.d[c],e.c){d.n(c);for(var k=0;k<e.c.length;++k)if(g=e.c[k](g,c),!1===g){delete a.d[c];break}!1!==g&&a.n(c,g);delete d.F}}else delete a.d[c]}for(c in b.d)if(e=b.d[c],!(c in a.d)&&e.o){d=!1;break a}}else z(a,{});d=!0}return d}function oa(a){return fa(a)}function pa(a){var b={A:"upper-alpha",I:"upper-roman",a:"lower-alpha",i:"lower-roman",1:"decimal"};return a in b?b[a]:a}
function qa(a){return/^[-\w+., ]+$/.test(a)?a:!1}function ra(a){return/^(?:#[0-9a-f]{3,6}|rgb\(\d{1,3}, *\d{1,3}, *\d{1,3}\)|[a-z]+)$/i.test(a)?a:!1}function sa(a){return l(a,/^(?:left|none|right)$/i)}function ta(a){return/^[-\w]+$/.test(a)?a:!1}function ua(a){return l(a,/^([a-z0-9]+)$/i)}
function va(a){var b=ga.mediasites,d;if("media"in a.d)d=a.d.media,!("id"in a.d)&&"url"in a.d&&-1===a.d.url.indexOf("://")&&a.n("id",a.d.url);else if("url"in a.d){var c=/^(?:([^:]+):)?(?:\/\/([^\/]+))?/.exec(a.d.url);if(c[1]&&b[c[1]+":"])d=b[c[1]+":"];else if(c[2]){c=c[2];do{if(b[c]){d=b[c];break}var e=c.indexOf(".");if(-1==e)break;c=c.substr(1+e)}while(""<c)}}d&&(b=a.G||a,c=a.k,d=O(3,d.toUpperCase(),c,b.k+b.w-c),z(d,x(a)),d.r=a.r);return!1}function za(a,b){return Da(a,b)}
function wa(a){return l(a,/^(?:[-\w]+)$/)}function xa(a){return l(a,/^(?:\d+)$/)}
window.s9e={TextFormatter:{disablePlugin:function(a){Q[a]&&(Q[a].Q=!0)},enablePlugin:function(a){Q[a]&&(Q[a].Q=!1)},preview:function(a,b){function d(a,b){for(var d=a.childNodes,e=b.childNodes,f=d.length,k=e.length,g,E,v=0,B=0;v<f&&v<k;){g=d[v];E=e[v];if(!c(g,E))break;++v}for(var y=Math.min(f-v,k-v);B<y;){g=d[f-(B+1)];E=e[k-(B+1)];if(!c(g,E))break;++B}g=h.createDocumentFragment();for(y=v;y<k-B;)E=e[y].cloneNode(!0),g.appendChild(E),++y;for(y=f-B;--y>=v;)a.removeChild(d[y]);B?a.insertBefore(g,a.childNodes[v]):
a.appendChild(g)}function c(a,b){if(a.nodeName!==b.nodeName||a.nodeType!==b.nodeType)return!1;if(3===a.nodeType||8===a.nodeType)return a.nodeValue!==b.nodeValue&&(a.nodeValue=b.nodeValue),!0;if(a.isEqualNode&&a.isEqualNode(b))return!0;for(var c=a.attributes,e=b.attributes,f=e.length,h=c.length;0<=--h;){var g=c[h],k=g.namespaceURI,g=g.name;b.hasAttributeNS(k,g)||a.removeAttributeNS(k,g)}for(h=f;0<=--h;)c=e[h],k=c.namespaceURI,g=c.name,c=c.value,c!==a.getAttributeNS(k,g)&&a.setAttributeNS(k,g,c);d(a,
b);return!0}for(var e=Ba(a),e=Oa(e),h=b.ownerDocument,e=h.importNode(Pa.transformToFragment(e,h),!0),g=e.querySelectorAll("[data-s9e-livepreview-postprocess]"),k=g.length;0<=--k;){var f=g[k].getAttribute("data-s9e-livepreview-postprocess");Qa[f]||(Qa[f]=new Function(f));Qa[f].call(g[k])}d(b,e)}}};
		var text,
			textareaEl = document.getElementsByTagName('textarea')[0],
			previewEl = document.getElementById('preview');

		window.setInterval(function()
		{
			if (textareaEl.value === text)
			{
				return;
			}

			text = textareaEl.value;
			s9e.TextFormatter.preview(text, previewEl);
		}, 20);

		function toggle(el)
		{
			(el.checked) ? s9e.TextFormatter.enablePlugin(el.id)
			             : s9e.TextFormatter.disablePlugin(el.id);

			text = '';
		}
	</script>
	<script type="text/javascript" src="http://cdnjs.cloudflare.com/ajax/libs/punycode/1.0.0/punycode.min.js"></script>
</body>
</html>