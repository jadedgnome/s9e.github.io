<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8" />
	<title>s9e\TextFormatter &bull; Demo</title>
	<base href="http://s9e.github.io/TextFormatter/demo.html" />
	<style type="text/css">
		#preview
		{
			font-family: sans;
			padding: 5px;
			background-color: #f8f8f8;
			border: dashed 1px #ddd;
			border-radius: 5px;
		}

		code
		{
			padding: 2px;
			background-color: #fff;
			border-radius: 3px;
			border: solid 1px #ddd;
		}
	</style>

</head>
<body>
	<div style="float:left;width:80%;max-width:800px">
		<form>
			<textarea style="width:99%" rows="15">[float=right][youtube]http://www.youtube.com/watch?v=QH2-TGUlwu4[/youtube][/float]

This is a demo of the JavaScript port of [url=https://github.com/s9e/TextFormatter/tree/master/src/ title="s9e\TextFormatter at GitHub.com"]s9e\TextFormatter[/url].

The following plugins have been enabled:

[list]
  [*][b]Autolink[/b] --- loose URLs such as http://github.com are automatically turned into links
  [*][b]BBCodes[/b]
  [list=circle]
    [*][b]bold[/b], [i]italic[/i], [u]underline[/u], [s]strikethrough[/s],
    [*][color=#f05]co[/color][color=#2f2]lo[/color][color=#02f]r,[/color]
    [*][C][URL][/C], [C:123][C][/C:123], [C][YOUTUBE][/C], [C][FLOAT][/C], and [C][LIST][/C]
    [*][C][CODE][/C] with real-time syntax highlighting via [url=http://softwaremaniacs.org/soft/highlight/en/]Highlight.js[/url]
	[code]$who = "world";
printf("Hello %s\n", $who);[/code]
  [/list]
  [*][b]Censor[/b] --- the word "apple" is censored and automatically replaced with "banana"
  [*][b]Emoticons[/b] --- one emoticon :) has been added
  [*][b]FancyPants[/b] --- some typography is enhanced, e.g. (c) (tm) and "quotes"
  [*][b]Generic[/b] --- the Generic plugin provides a way to perform generic regexp-based replacements that are HTML-safe. Here, text that matches [C]/#(?<tag>[a-z0-9]+)/i[/C] is replaced with the template [C]<a href="https://twitter.com/#!/search/%23{@tag}"><xsl:apply-templates/></a>[/C] -- For example: #PHP, #fml
  [*][b]HTMLElements[/b] --- [C]<a>[/C] and [C]<b>[/C] tags are allowed, with two whitelisted attributes for [C]<a>[/C]: [C]href[/C] and [C]title[/C]. Example: <a href="https://github.com" title="GitHub - Social Coding"><b>GitHub</b></a>
  [*][b]HTMLEntities[/b] --- HTML entities such as &amp;hearts; are decoded
[/list]

The parser/renderer used on this page page has been generated by [url=https://github.com/s9e/TextFormatter/blob/master/scripts/generateLiveDemo.php]this script[/url]. It's been minified with Google Closure Compiler to 23.7 KB (8.6 KB compressed)</textarea>
		</form>
	</div>

	<div style="float:left;">
		<form><input type="checkbox" id="Autolink" checked="checked" onchange="toggle(this)"><label for="Autolink">&nbsp;Autolink</label><br><input type="checkbox" id="BBCodes" checked="checked" onchange="toggle(this)"><label for="BBCodes">&nbsp;BBCodes</label><br><input type="checkbox" id="Censor" checked="checked" onchange="toggle(this)"><label for="Censor">&nbsp;Censor</label><br><input type="checkbox" id="Emoticons" checked="checked" onchange="toggle(this)"><label for="Emoticons">&nbsp;Emoticons</label><br><input type="checkbox" id="FancyPants" checked="checked" onchange="toggle(this)"><label for="FancyPants">&nbsp;FancyPants</label><br><input type="checkbox" id="Generic" checked="checked" onchange="toggle(this)"><label for="Generic">&nbsp;Generic</label><br><input type="checkbox" id="HTMLElements" checked="checked" onchange="toggle(this)"><label for="HTMLElements">&nbsp;HTMLElements</label><br><input type="checkbox" id="HTMLEntities" checked="checked" onchange="toggle(this)"><label for="HTMLEntities">&nbsp;HTMLEntities</label><br><input type="checkbox" id="MediaEmbed" checked="checked" onchange="toggle(this)"><label for="MediaEmbed">&nbsp;MediaEmbed</label></form>
	</div>

	<div style="clear:both"></div>

	<div id="preview"></div>

	<script type="text/javascript">function aa(a){var b=document.createElement("b");b.innerHTML=a.replace(/</g,"&lt;");return b.textContent}function ba(a){var b={"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;"};return a.replace(/[<>&"]/g,function(a){return b[a]})}function l(a){var b={"<":"&lt;",">":"&gt;","&":"&amp;"};return a.replace(/[<>&]/g,function(a){return b[a]})}function ca(a){return encodeURIComponent(a).replace(/[!'()*]/g,function(a){return"%"+a.charCodeAt(0).toString(16).toUpperCase()})}
function da(a){if(!/^\d+\.\d+\.\d+\.\d+$/.test(a))return!1;for(var b=4,c=a.split(".");0<=--b;)if("0"===c[b].charAt(0)||255<c[b])return!1;return a}function ea(a){return/^(\d*:){2,7}\d+(?:\.\d+\.\d+\.\d+)?$/.test(a)?a:!1}function m(a,b){return b.test(a)?a:!1}
function fa(a){var b=ga.urlConfig;a=ha(a.replace(/^\s+/,"").replace(/\s+$/,""));var c="";if(""!==a.H){if(!b.ia.test(a.H))return!1;c+=a.H+":"}if(""===a.u)if("file"===a.H)c+="//";else{if(""!==a.H)return!1}else{c+="//";if(!/^(?=[a-z])[-a-z0-9]{0,62}[a-z0-9](?:\.(?=[a-z])[-a-z0-9]{0,62}[a-z0-9])*$/i.test(a.u)&&!da(a.u)&&!ea(a.u.replace(/^\[(.*)\]$/,"$1",a.u))||b.ja&&b.ja.test(a.u)||b.qa&&!b.qa.test(a.u))return!1;""!==a.ga&&(c+=ca(decodeURIComponent(a.ga)),""!==a.ba&&(c+=":"+ca(decodeURIComponent(a.ba))),
c+="@");c+=a.u;""!==a.ca&&(c+=":"+a.ca)}b=a.oa;""!==a.ea&&(b+="?"+a.ea);""!==a.Z&&(b+="#"+a.Z);b=b.replace(/%.?[a-f]/,function(a){return a[0].toUpperCase()},b);c+=b.replace(/[^\u0020-\u007E]+/g,encodeURIComponent).replace(/%(?![0-9A-Fa-f]{2})|[^!#-&*-;=?-Z_a-z]/g,escape);a.H||(c=c.replace(/^([^\/]*):/,"$1%3A",c));return c}
function ha(a){a=/^(?:([a-z][-+.\w]*):)?(?:\/\/(?:([^:\/?#]*)(?::([^\/?#]*)?)?@)?(?:(\[[a-f\d:]+\]|[^:\/?#]+)(?::(\d*))?)?(?![^\/?#]))?([^?#]*)(?:\?([^#]*))?(?:#(.*))?$/i.exec(a);a={H:""<a[1]?a[1]:"",ga:""<a[2]?a[2]:"",ba:""<a[3]?a[3]:"",u:""<a[4]?a[4]:"",ca:""<a[5]?a[5]:"",oa:""<a[6]?a[6]:"",ea:""<a[7]?a[7]:"",Z:""<a[8]?a[8]:""};a.H=a.H.toLowerCase();a.u=a.u.replace(/[\u3002\uff0e\uff61]/g,".").replace(/\.+$/g,"");/[^\x00-\x7F]/.test(a.u)&&punycode&&(a.u=punycode.toASCII(a.u));return a}
function ia(){}ia.prototype={q:function(){}};function n(a,b,c,d){this.r=a;this.g=b;this.k=c;this.z=d;this.d={};this.X=[];isNaN(a+c+d)&&q(this)}n.prototype.N=!1;n.prototype.w=0;function q(a){a.N||(a.N=!0,a.X.forEach(function(a){q(a)}))}function r(a,b){a.g===b.g&&(1===a.r&&2===b.r&&b.k>=a.k?(a.L=b,b.T=a):2===a.r&&1===b.r&&b.k<=a.k&&(a.T=b,b.L=a))}function t(a){var b={},c;for(c in a.d)b[c]=a.d[c];return b}
function u(a,b){return a.N||a.g!==b.g||1!==b.r||2!==a.r||a.k<b.k||a.T&&a.T!==b||b.L&&b.L!==a?!1:!0}function ja(a){return"br"===a.g||"i"===a.g||"pb"===a.g}n.prototype.q=function(a,b){this.d[a]=b};function w(a,b){a.d={};for(var c in b)a.d[c]=b[c]}
var y,z,B,D,G,I,ka=new ia,la,J,K,P={BBCodes:{K:"[",F:/\[\/?([*BIS]|C(?:O(?:DE|LOR))?|FLOAT|LIST|MEDIA|QUOTE|U(?:RL)?|YOUTUBE)(?=[\] =:\/])/ig,G:1E4,M:"warn",y:function(a,b){var c={B:{},I:{},U:{},S:{},URL:{O:["url"]},QUOTE:{P:"author"},LIST:{P:"type"},"*":{v:"LI"},C:{},COLOR:{},FLOAT:{},CODE:{P:"lang"},MEDIA:{O:["url"]},YOUTUBE:{O:["url"],P:"url"}};b.forEach(function(b){var f=b[1][0].toUpperCase(),h=c[f]||{},g=h.v||f,k=b[0][1],e=k+b[0][0].length;":"===a.charAt(e)?(b=/^:\d*/.exec(a.substr(e))[0],e+=
b.length):b="";if("/"===a.charAt(k+1))"]"===a.charAt(e)&&""===b&&L(2,g,k,1+e-k);else{var C=1,F={},Q=!1,xa=e,M,p;if(h.da)for(M in h.da)F[M]=h.da[M];for(;e<N;)if(p=a.charAt(e)," "===p)++e;else{if("]"===p||"/"===p){if("/"===p&&(C=3,++e,e===N||"]"!==a.charAt(e)))return;Q=!0;++e;break}var H=/^[-\w]*/.exec(a.substr(e))[0].length;if(H){if(e+H>=N)return;M=a.substr(e,H).toLowerCase();e+=H;if("="!==a.charAt(e))continue}else if("="===p&&e===xa)M=h.P||f.toLowerCase();else return;if(++e>=N)return;p=a.charAt(e);
if('"'===p||"'"===p){for(H=e+1;;){++e;e=a.indexOf(p,e);if(0>e)return;for(var E=0;"\\"===a.charAt(e-++E););if(E%2)break}p=a.substr(H,e-H).replace(/\\([\\'"])/g,"$1");++e}else{p=/[^\]]*?(?=\s*(?: \/)?\]|\s+[-\w]+=)/.exec(a.substr(e));if(!p)continue;p=p[0];e+=p.length}F[M]=p}if(Q){if(1===C){var v=[];h.O&&h.O.forEach(function(a){a in F||v.push(a)});var A;if(v.length||b||h.la){p="[/"+f+b+"]";var x=a.toUpperCase().indexOf(p,e);if(0>x){if(b||h.la)return}else v.forEach(function(b){F[b]=a.substr(e,x-e)}),
A=L(2,g,x,p.length)}f=L(1,g,k,e-k);A&&r(f,A)}else f=L(3,g,k,e-k);w(f,F)}}})}},Censor:{F:/(?:^|\W)apple(?!\w)/gi,G:1E4,M:"warn",y:function(a,b){var c={x:"with",v:"CENSOR",R:[[/^apple$/i,"banana"]]},d=c.v,f=c.x;b.forEach(function(a){if(!c.ha||!c.ha.test(a[0][0])){var b=/^\W/.test(a[0][0])?1:0,k=a[0][0].substr(b);a=L(3,d,a[0][1]+b,k.length);if(c.R)for(b=0;b<c.R.length;++b){var e=c.R[b][1];if(c.R[b][0].test(k)){a.q(f,e);break}}}})}},Emoticons:{K:":)",F:/:\)/g,G:1E4,M:"warn",y:function(a,b){var c={v:"E"};
b.forEach(function(b){c.ma&&b[0][1]&&c.ma.test(a.charAt(b[0][1]-1))||L(3,c.v,b[0][1],b[0][0].length)})}},Generic:{y:function(a){[["G60D5AB76",/#([a-z0-9]+)/ig,0,["","tag"]]].forEach(function(b){var c=b[0],d=b[1],f=b[2];b=b[3];var h;for(d.lastIndex=0;h=d.exec(a);){var g=h.index,k=h[0].length,e;if(f&&""!==h[f]){var C=a.indexOf(h[f],g),F=h[f].length,Q=C-g;e=ma(c,g,Q,C+F,k-(Q+F))}else e=L(3,c,g,k);b.forEach(function(a,b){a&&e.q(a,h[b])})}})}},HTMLElements:{K:"<",F:/<(?:\/([ab])|([ab])((?:\s+[a-z][-a-z0-9]*(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s"'=<>`]+))?)*)\s*\/?)\s*>/ig,
G:1E4,M:"warn",y:function(a,b){var c={pa:"html"};b.forEach(function(b){var f="/"===a.charAt(b[0][1]+1),h=b[0][1],g=b[0][0].length,k=b[2-f][0].toLowerCase(),e=c.J&&c.J[k]&&c.J[k][""]?c.J[k][""]:c.pa+":"+k;if(f)L(2,e,h,g);else for(f="/>"===b[0][0].substr(g-2)?ma(e,h,g,h+g,0):L(1,e,h,g),b=b[3][0],h=/[a-z][-a-z0-9]*(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s"'=<>`]+))?/gi;e=h.exec(b);)O=e[0].indexOf("="),0>O&&(O=e[0].length,e[0]+="="+e[0].toLowerCase()),g=e[0].substr(0,O).toLowerCase().replace(/^\s+/,"").replace("/s+$/",
""),e=e[0].substr(1+O).replace(/^\s+/,"").replace("/s+$/",""),c.J&&c.J[k]&&c.J[k][g]&&(g=c.J[k][g]),/^["']/.test(e)&&(e=e.substr(1,e.length-2)),f.q(g,aa(e))})}},Autolink:{K:"://",F:/https?:\/\/\S(?:[^\s\[\]]*(?:\[\w*\])?)+/ig,G:1E4,M:"warn",y:function(a,b){b.forEach(function(a){for(var b=a[0][0];;)if(b=b.replace(/[\s!"',.<>?]+$/,""),")"===b.substr(-1)&&b.replace(/[^(]+/g,"").length<b.replace(/[^)]+/g,"").length)b=b.substr(0,b.length-1);else break;var f=L(1,"URL",a[0][1],0);f.q("url",b);a=L(2,"URL",
a[0][1]+b.length,0);r(f,a)})}},HTMLEntities:{K:"&",F:/&(?:[a-z]+|#(?:[0-9]+|x[0-9a-f]+));/ig,G:1E4,M:"warn",y:function(a,b){b.forEach(function(a){var b=a[0][0],f=aa(b);f!==b&&L(3,"HE",a[0][1],b.length).q("char",f)})}},FancyPants:{y:function(a){function b(){for(var b={"--":"\u2013","---":"\u2014","...":"\u2026"},c,d=/---?|\.\.\./g;c=d.exec(a);){var e=b[c[0]];L(3,g.v,+c.index,c[0].length).q(g.x,e)}}function c(b,c,d,e){for(var f;f=c.exec(a);){var h=L(3,g.v,+f.index+f[0].indexOf(b),1);f=L(3,g.v,+f.index+
f[0].length-1,1);h.q(g.x,d);f.q(g.x,e);h.X.push(f);h.N&&q(f)}}function d(a){for(var b,c=/[a-z]'|(?:^|\s)'(?=[a-z]|[0-9]{2})/gi;b=c.exec(a);)b=L(3,g.v,+b.index+b[0].indexOf("'"),1),b.q(g.x,"\u2019"),b.w=10}function f(a){for(var b,c=/[0-9](?:'s|["']? ?x(?= ?[0-9])|["'])/g;b=c.exec(a);){var d=+b.index+b[0].length-1;"x"===b[0].charAt(d)&&L(3,g.v,d,1).q(g.x,"\u00d7");var e=b[0].charAt(1);if("'"===e||'"'===e)d=+b.index+1,b="'s"===b[0].substr(1,2)?"\u2019":"'"===e?"\u2032":"\u2033",L(3,g.v,d,1).q(g.x,b)}}
function h(){for(var b={"(c)":"\u00a9","(r)":"\u00ae","(tm)":"\u2122"},c,d=/\((?:c|r|tm)\)/gi;c=d.exec(a);){var e=b[c[0].toLowerCase()];L(3,g.v,+c.index,c[0].length).q(g.x,e)}}var g={x:"char",v:"FP"},k=0<=a.indexOf("'"),e=0<=a.indexOf('"');k&&d(a);(k||e||0<=a.indexOf("x"))&&f(a);k&&c("'",/(?:^|\W)'.+?'(?!\w)/g,"\u2018","\u2019");e&&c('"',/(?:^|\W)".+?"(?!\w)/g,"\u201c","\u201d");(0<=a.indexOf("...")||0<=a.indexOf("--"))&&b();0<=a.indexOf("(")&&h()}},MediaEmbed:{K:"://",F:/\bhttps?:\/\/(?:[-.\w]+\.)?youtu(?:\.be|be\.com)\/[^["'\s]+(?!\S)/g,
G:1E4,M:"warn",y:function(a,b){b.forEach(function(a){var b=a[0][0];a=L(3,"MEDIA",a[0][1],b.length);a.q("url",b);a.w=-10})}}},O,ga={urlConfig:{ia:/^https?$/i},mediasites:{"youtube.com":"youtube","youtu.be":"youtube"}},na={e:[55],f:[63],c:32},T={B:{b:[R],n:10,j:{c:2},o:1E3,l:0,e:[51],f:[63]},I:{b:[R],n:10,j:{c:2},o:1E3,l:0,e:[51],f:[63]},U:{b:[R],n:10,j:{c:2},o:1E3,l:0,e:[51],f:[63]},S:{b:[R],n:10,j:{c:2},o:1E3,l:0,e:[51],f:[63]},URL:{d:{url:{b:[oa],p:!0},title:{p:!1}},b:[R],n:10,j:{c:258},o:1E3,l:1,
e:[53],f:[61]},QUOTE:{d:{author:{p:!1}},b:[R],n:10,j:{c:2048},o:1E3,l:2,e:[55],f:[63]},LIST:{d:{type:{b:[pa,qa],p:!1}},b:[R],n:10,j:{c:3712},o:1E3,l:2,e:[40],f:[63]},LI:{b:[R],n:10,j:{Y:{LI:1},c:2048},o:1E3,l:3,e:[55],f:[63]},C:{b:[R],n:10,j:{c:66},o:1E3,l:0,e:[0],f:[0]},COLOR:{d:{color:{b:[ra],p:!0}},b:[R],n:10,j:{c:2},o:1E3,l:0,e:[51],f:[63]},FLOAT:{d:{"float":{b:[sa],p:!0}},b:[R],n:10,j:{c:2048},o:1E3,l:2,e:[55],f:[63]},CODE:{d:{lang:{b:[ta],p:!1}},b:[R],n:10,j:{c:2128},o:1E3,l:2,e:[0],f:[0]},
CENSOR:{d:{"with":{p:!1}},b:[R],n:10,j:{c:1601},o:1E3,l:4,e:[0],f:[0]},E:{b:[R],n:10,j:{c:1537},o:1E3,l:0,e:[48],f:[63]},G60D5AB76:{d:{tag:{b:[ua],p:!0}},b:[R],n:10,j:{c:258},o:1E3,l:1,e:[53],f:[61]},"html:a":{d:{href:{b:[oa],p:!1},title:{p:!1}},b:[R],n:10,j:{c:258},o:1E3,l:1,e:[53],f:[61]},"html:b":{b:[R],n:10,j:{c:2},o:1E3,l:0,e:[51],f:[63]},HE:{d:{"char":{p:!0}},b:[R],n:10,j:{c:1537},o:1E3,l:4,e:[48],f:[63]},FP:{d:{"char":{p:!0}},b:[R],n:10,j:{c:1537},o:1E3,l:4,e:[48],f:[63]},MEDIA:{b:[va],n:10,
j:{c:321},o:1E3,l:5,e:[0],f:[0]},YOUTUBE:{d:{url:{b:[oa],p:!1},id:{b:[wa],p:!0},h:{b:[S],p:!1},m:{b:[S],p:!1},s:{b:[S],p:!1},t:{b:[S],p:!1},list:{b:[wa],p:!1}},W:[["url",/youtube\.com\/(?:watch.*?v=|v\/)([-\w]+)/,["","id"]],["url",/youtu\.be\/([-\w]+)/,["","id"]],["url",/[#&?]t=(?:(?:(\d+)h)?(\d+)m(\d+)|(\d+))/,["","h","m","s","t"]],["url",/&list=([-\w]+)/,["","list"]],["url",/^([-\w]+)$/,["","id"]]],b:[ya,R],n:10,j:{c:1601},o:1E3,l:1,e:[0],f:[0]}},U,V,W,N,za=0,X;
function Aa(a){a=a.replace(/\r\n?/g,"\n",a);a=a.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F]+/g,"",a);D=0;I=!1;la={};K="";W=a;N=W.length;U=[];V=!0;X=0;++za;a=za;for(var b in P){var c=P[b];if(!(c.V||c.K&&0>W.indexOf(c.K))){var d=[];if(c.F){var d=c.F,f=[],h=void 0;for(d.lastIndex=0;h=d.exec(W);){for(var g=+h.index,k=[[h[0],g]],e=0;++e<h.length;){var C=h[e];void 0===C?k.push(["",-1]):(k.push([C,W.indexOf(C,g)]),g+=C.length)}f.push(k)}d=f;f=d.length;if(!f)continue;f>c.G&&(d=d.slice(0,c.G))}c.y(W,d)}}Ba();if(za!==
a)throw"The parser has been reset during execution";return K}function Ca(a,b){b.W&&b.W.forEach(function(b){var d=b[0],f=b[1];b=b[2];if(d in a.d){var h;(h=f.exec(a.d[d]))&&b.forEach(function(b,c){if(""!==b&&"string"===typeof h[c]){var e=h[c];b!==d&&b in a.d||a.q(b,e)}})}});return!0}
function Da(){var a;Y(N,0,!0);do a=K,K=K.replace(/<((?:\w+:)?\w+)[^>]*><\/\1>/g,"");while(K!==a);K=K.replace(/<\/i><i>/g,"",K);var b=I?"r":"t";a="<"+b;for(var c in la)a+=" xmlns:"+c+'="urn:s9e:TextFormatter:'+c+'"';K=a+">"+K+"</"+b+">"}
function Ea(a){I=!0;var b=a.g,c=a.k,d=a.z,f=0,h=0;a.c&2048&&(f=a.r&1?2:1,h=a.r&2?2:1);var g=!1;a.r&1||(g=!0);Y(c,f,g);f=d?l(W.substr(c,d)):"";if(a.r&1){g=b.indexOf(":");0<g&&(la[b.substr(0,g)]=0);K+="<"+b;var k=t(a),g=[],e;for(e in k)g.push([e]);g.sort(function(a,b){return a>b?1:-1});g.forEach(function(a){K+=" "+a+'="'+ba(k[a].toString())+'"'});K=3===a.r?d?K+(">"+f+"</"+b+">"):K+"/>":d?K+("><s>"+f+"</s>"):K+">"}else d&&(K+="<e>"+f+"</e>"),K+="</"+b+">";for(X=O=c+d;h&&X<N&&"\n"===W.charAt(X);)--h,
++X}function Y(a,b,c){c&&(B.c&8?b=-1:c=!1);O>=a&&c&&Z();if(X>O){var d=Math.min(a,X);K+=W.substr(O,d-O);O=d;O>=a&&c&&Z()}if(B.c&128)b=a-O,b=W.substr(O,b),/^[ \n\t]*$/.test(b)||(b="<i>"+b+"</i>"),K+=b,O=a,c&&Z();else{for(var f=a,d=0;b&&--f>=O;){var h=W.charAt(f);if(" "!==h&&"\n"!==h&&"\t"!==h)break;"\n"===h&&--b;++d}a-=d;a>O&&(b=l(W.substr(O,a-O)),32===(B.c&1072)&&(b=b.replace(/\n/g,"<br/>\n")),K+=b);c&&Z();d&&(K+=W.substr(a,d));O=a+d}}
function Fa(a){var b=a.k;a=a.z;var c=W.substr(b,a);Y(b,0,!1);K+="<i>"+l(c)+"</i>";I=!0;O=b+a}function Z(){B.$&&(K+="</p>",B.$=!1)}function Ga(a,b){var c=a.g;a.c&2048&&(b=Ha(b));r(L(2,c,b,0),a)}function Ha(a){for(;a>O&&-1<" \n\t".indexOf(W.charAt(a-1));)--a;return a}function Ba(){O=0;y={};z={};J=[];G=null;B=na;B.$=!1;for(var a in T)y[a]=0,z[a]=0;do{for(;U.length;)V||(U.sort(Ia),V=!0),G=U.pop(),B.c&64&&!u(G,J[J.length-1])&&!ja(G)||Ja();J.forEach(function(a){Ga(a,N)})}while(U.length);Da()}
function Ja(){if(!G.N){var a=G.k,b=G.z;if(O>a){var c;if((c=G.T)&&0<=J.indexOf(c))a=Math.max(0,a+b-O),a=L(2,c.g,O,a),r(a,c);else{if("i"===G.g&&(c=a+b-O,0<c)){L(3,"i",O,c);return}q(G)}}else if("i"===G.g)Fa(G);else if("br"===G.g)B.c&512||(Y(G.k,0,!1),K+="<br/>");else if("pb"===G.g)Y(G.k,0,!0);else if(G.r&1)if(c=G,a=c.g,b=T[a],z[a]>=b.o)q(c);else{var d=c,f=T[d.g],h=!0;if(f.b)for(var g=0;g<f.b.length;++g)if(!f.b[g](d,f)){h=!1;break}if(h){a:{d=c;if(J.length&&(f=T[d.g],f.j.Y&&(h=J[J.length-1],f.j.Y[h.g]))){U.push(d);
Ga(h,d.k);d=!0;break a}d=!1}d||(y[a]>=b.n?q(c):(b=T[a].l,B.e[b>>5]&1<<(b&31)?(c.c&1&&!c.L&&(a=new n(3,a,c.k,c.z),w(a,t(c)),a.c=c.c,c=a),Ea(c),Ka(c)):q(c)))}else q(c)}else La()}}
function La(){var a=G;if(y[a.g]){for(var b=[],c=J.length;0<=--c;){var d=J[c];if(u(a,d))break;if(1E3<++D)throw"Fixing cost exceeded";b.push(d)}if(!(0>c)){var f=1E3>D,h=[];b.forEach(function(b){var c=b.g;f&&(b.c&2?h.push(b):f=!1);var d=a.k;b.c&2048&&(d=Ha(d));c=new n(2,c,d,0);c.c=b.c;Ea(c);Ma()});Ea(a);Ma();if(b.length&&1E3>D){d=O;for(c=U.length;0<=--c&&1E3>++D;){var g=U[c];if(g.k>d||g.r&1)break;for(var k=b.length;0<=--k&&1E3>++D;)if(u(g,b[k])){b.splice(k,1);h[k]&&h.splice(k,1);d=Math.max(d,g.k+g.z);
break}}d>O&&Fa(new n(3,"i",O,d-O))}h.forEach(function(a){var b=L(a.r,a.g,O,0);w(b,t(a));b.w=a.w;(a=a.L)&&r(b,a)})}}}function Ma(){var a=J.pop();--y[a.g];B=B.na}function Ka(a){function b(a,b){for(var c=-1,d=a.length,f=Array(d);++c<d;)f[c]=a[c]&b[c];return f}var c=a.g,d=a.c,f=T[c];++z[c];3!==a.r&&(++y[c],J.push(a),a=b(f.e,f.e),d&256&&(a=b(a,B.e)),f=b(B.f,f.f),a=b(a,f),d|=B.c&32,d&16&&(d&=-33),B={e:a,f:f,c:d,na:B})}
function L(a,b,c,d){a=new n(a,b,c,d);T[b]&&(a.c=T[b].j.c);T[b]||ja(a)?T[b]&&T[b].V?q(a):0>d||0>c||c+d>N?q(a):(V&&U.length&&a.k>=U[U.length-1].k&&(V=!1),U.push(a)):q(a);return a}function ma(a,b,c,d,f){b=L(1,a,b,c);r(b,L(2,a,d,f));return b}function Ia(a,b){var c=a.k,d=b.k;if(c!==d)return d-c;if(a.w!==b.w)return b.w-a.w;c=a.z;d=b.z;return c&&d?c-d:c||d?c?-1:1:(c={2:0,3:1,1:2},c[b.r]-c[a.r])}var Na;
Na="undefined"!==typeof DOMParser&&"undefined"!==typeof XSLTProcessor?{aa:function(){this.D=new XSLTProcessor;this.D.importStylesheet(this.Q('<?xml version="1.0" encoding="utf-8"?><xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:html="urn:s9e:TextFormatter:html" exclude-result-prefixes="html"><xsl:output method="html" encoding="utf-8" indent="no"/><xsl:template match="B|I|LI|S|U|html:b|p"><xsl:element name="{translate(local-name(),\'BILSU\',\'bilsu\')}"><xsl:apply-templates/></xsl:element></xsl:template><xsl:template match="C"><code class="inline"><xsl:apply-templates/></code></xsl:template><xsl:template match="CENSOR"><xsl:choose><xsl:when test="@with"><xsl:value-of select="@with"/></xsl:when><xsl:otherwise>****</xsl:otherwise></xsl:choose></xsl:template><xsl:template match="CODE"><pre data-s9e-livepreview-postprocess="if(\'undefined\'!==typeof hljs){{var a=this.innerHTML;a in hljs._?this.innerHTML=hljs._[a]:(Object.keys&amp;&amp;7&lt;Object.keys(hljs._).length&amp;&amp;(hljs._={{}}),hljs.highlightBlock(this.firstChild),hljs._[a]=this.innerHTML)}};"><code class="{@lang}"><xsl:apply-templates/></code></pre><xsl:if test="not(following::CODE)"><script>if("undefined"===typeof hljs){var a=document.getElementsByTagName("head")[0],b=document.createElement("link");b.type="text/css";b.rel="stylesheet";b.href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/7.3/styles/github.min.css";a.appendChild(b);b=document.createElement("script");b.type="text/javascript";b.onload=function(){hljs._={};hljs.initHighlighting()};b.async=!0;b.src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/7.3/highlight.min.js";a.appendChild(b)};\x3c/script></xsl:if></xsl:template><xsl:template match="COLOR"><span style="color:{@color}"><xsl:apply-templates/></span></xsl:template><xsl:template match="E"><xsl:choose><xsl:when test=".=\':)\'"><img src="s.png" alt=":)"/></xsl:when><xsl:otherwise><xsl:value-of select="."/></xsl:otherwise></xsl:choose></xsl:template><xsl:template match="FLOAT"><div style="float:{@float}"><xsl:apply-templates/></div></xsl:template><xsl:template match="FP|HE"><xsl:value-of select="@char"/></xsl:template><xsl:template match="G60D5AB76"><a href="https://twitter.com/#!/search/%23{@tag}"><xsl:apply-templates/></a></xsl:template><xsl:template match="LIST"><xsl:choose><xsl:when test="not(@type)"><ul><xsl:apply-templates/></ul></xsl:when><xsl:when test="contains(\'upperlowerdecim\',substring(@type,1,5))"><ol style="list-style-type:{@type}"><xsl:apply-templates/></ol></xsl:when><xsl:otherwise><ul style="list-style-type:{@type}"><xsl:apply-templates/></ul></xsl:otherwise></xsl:choose></xsl:template><xsl:template match="QUOTE"><blockquote><xsl:if test="not(@author)"><xsl:attribute name="class">uncited</xsl:attribute></xsl:if><div><xsl:if test="@author"><cite><xsl:value-of select="@author"/> wrote:</cite></xsl:if><xsl:apply-templates/></div></blockquote></xsl:template><xsl:template match="URL"><a href="{@url}"><xsl:copy-of select="@title"/><xsl:apply-templates/></a></xsl:template><xsl:template match="YOUTUBE"><iframe width="240" height="180" src="http://www.youtube.com/embed/{@id}" allowfullscreen=""/></xsl:template><xsl:template match="br"><br/></xsl:template><xsl:template match="e|i|s"/><xsl:template match="html:a"><a><xsl:copy-of select="@href"/><xsl:copy-of select="@title"/><xsl:apply-templates/></a></xsl:template></xsl:stylesheet>'))},
Q:function(a){return(new DOMParser).parseFromString(a,"text/xml")},ra:function(a,b){this.D.setParameter(null,a,b)},fa:function(a,b){return b.importNode(this.D.transformToFragment(this.Q(a),b),!0)}}:{aa:function(){var a=new ActiveXObject("MSXML2.XSLTemplate.6.0");a.stylesheet=loadXML('<?xml version="1.0" encoding="utf-8"?><xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:html="urn:s9e:TextFormatter:html" exclude-result-prefixes="html"><xsl:output method="html" encoding="utf-8" indent="no"/><xsl:template match="B|I|LI|S|U|html:b|p"><xsl:element name="{translate(local-name(),\'BILSU\',\'bilsu\')}"><xsl:apply-templates/></xsl:element></xsl:template><xsl:template match="C"><code class="inline"><xsl:apply-templates/></code></xsl:template><xsl:template match="CENSOR"><xsl:choose><xsl:when test="@with"><xsl:value-of select="@with"/></xsl:when><xsl:otherwise>****</xsl:otherwise></xsl:choose></xsl:template><xsl:template match="CODE"><pre data-s9e-livepreview-postprocess="if(\'undefined\'!==typeof hljs){{var a=this.innerHTML;a in hljs._?this.innerHTML=hljs._[a]:(Object.keys&amp;&amp;7&lt;Object.keys(hljs._).length&amp;&amp;(hljs._={{}}),hljs.highlightBlock(this.firstChild),hljs._[a]=this.innerHTML)}};"><code class="{@lang}"><xsl:apply-templates/></code></pre><xsl:if test="not(following::CODE)"><script>if("undefined"===typeof hljs){var a=document.getElementsByTagName("head")[0],b=document.createElement("link");b.type="text/css";b.rel="stylesheet";b.href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/7.3/styles/github.min.css";a.appendChild(b);b=document.createElement("script");b.type="text/javascript";b.onload=function(){hljs._={};hljs.initHighlighting()};b.async=!0;b.src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/7.3/highlight.min.js";a.appendChild(b)};\x3c/script></xsl:if></xsl:template><xsl:template match="COLOR"><span style="color:{@color}"><xsl:apply-templates/></span></xsl:template><xsl:template match="E"><xsl:choose><xsl:when test=".=\':)\'"><img src="s.png" alt=":)"/></xsl:when><xsl:otherwise><xsl:value-of select="."/></xsl:otherwise></xsl:choose></xsl:template><xsl:template match="FLOAT"><div style="float:{@float}"><xsl:apply-templates/></div></xsl:template><xsl:template match="FP|HE"><xsl:value-of select="@char"/></xsl:template><xsl:template match="G60D5AB76"><a href="https://twitter.com/#!/search/%23{@tag}"><xsl:apply-templates/></a></xsl:template><xsl:template match="LIST"><xsl:choose><xsl:when test="not(@type)"><ul><xsl:apply-templates/></ul></xsl:when><xsl:when test="contains(\'upperlowerdecim\',substring(@type,1,5))"><ol style="list-style-type:{@type}"><xsl:apply-templates/></ol></xsl:when><xsl:otherwise><ul style="list-style-type:{@type}"><xsl:apply-templates/></ul></xsl:otherwise></xsl:choose></xsl:template><xsl:template match="QUOTE"><blockquote><xsl:if test="not(@author)"><xsl:attribute name="class">uncited</xsl:attribute></xsl:if><div><xsl:if test="@author"><cite><xsl:value-of select="@author"/> wrote:</cite></xsl:if><xsl:apply-templates/></div></blockquote></xsl:template><xsl:template match="URL"><a href="{@url}"><xsl:copy-of select="@title"/><xsl:apply-templates/></a></xsl:template><xsl:template match="YOUTUBE"><iframe width="240" height="180" src="http://www.youtube.com/embed/{@id}" allowfullscreen=""/></xsl:template><xsl:template match="br"><br/></xsl:template><xsl:template match="e|i|s"/><xsl:template match="html:a"><a><xsl:copy-of select="@href"/><xsl:copy-of select="@title"/><xsl:apply-templates/></a></xsl:template></xsl:stylesheet>');
this.D=a.createProcessor()},Q:function(a){var b=new ActiveXObject("MSXML2.DOMDocument.6.0");b.async=!1;b.validateOnParse=!1;b.loadXML(a);return b},ra:function(a,b){this.D.addParameter(a,b,"")},fa:function(a,b){var c=b.createElement("div"),d=b.createDocumentFragment();this.D.input=this.Q(a);this.D.transform();for(c.innerHTML=this.D.output;c.ka;)d.appendChild(c.removeChild(c.ka));return d}};Na.aa();var Oa={};
function R(a,b){var c;a:{if(b.d){var d,f=t(a);for(c in f){var h=f[c];if(b.d[c]){if(d=b.d[c],d.b){ka.q(c);for(var g=0;g<d.b.length;++g)if(h=d.b[g](h,c),!1===h){delete a.d[c];break}!1!==h&&a.q(c,h)}}else delete a.d[c]}for(c in b.d)if(d=b.d[c],!(c in a.d)&&d.p){c=!1;break a}}else w(a,{});c=!0}return c}function oa(a){return fa(a)}function pa(a){var b={A:"upper-alpha",I:"upper-roman",a:"lower-alpha",i:"lower-roman",1:"decimal"};return a in b?b[a]:a}function qa(a){return/^[-\w+., ]+$/.test(a)?a:!1}
function ra(a){return/^(?:#[0-9a-f]{3,6}|rgb\(\d{1,3}, *\d{1,3}, *\d{1,3}\)|[a-z]+)$/i.test(a)?a:!1}function sa(a){return m(a,/^(?:left|none|right)$/i)}function ta(a){return/^[-\w]+$/.test(a)?a:!1}function ua(a){return m(a,/^([a-z0-9]+)$/i)}
function va(a){var b=ga.mediasites,c;if("media"in a.d)c=a.d.media,!("id"in a.d)&&"url"in a.d&&-1===a.d.url.indexOf("://")&&a.q("id",a.d.url);else if("url"in a.d){var d=/^(?:([^:]+):)?(?:\/\/([^\/]+))?/.exec(a.d.url);if(d[1]&&b[d[1]+":"])c=b[d[1]+":"];else if(d[2]){d=d[2];do{if(b[d]){c=b[d];break}var f=d.indexOf(".");if(-1==f)break;d=d.substr(1+f)}while(""<d)}}c&&(b=a.L||a,d=a.k,c=L(3,c.toUpperCase(),d,b.k+b.z-d),w(c,t(a)),c.w=a.w);return!1}function ya(a,b){return Ca(a,b)}
function wa(a){return m(a,/^(?:[-\w]+)$/)}function S(a){return m(a,/^(?:\d+)$/)}
window.s9e={TextFormatter:{disablePlugin:function(a){P[a]&&(P[a].V=!0)},enablePlugin:function(a){P[a]&&(P[a].V=!1)},preview:function(a,b){function c(a,b){for(var c=a.childNodes,e=b.childNodes,h=c.length,g=e.length,k,E,v=0,A=0;v<h&&v<g;){k=c[v];E=e[v];if(!d(k,E))break;++v}for(var x=Math.min(h-v,g-v);A<x;){k=c[h-(A+1)];E=e[g-(A+1)];if(!d(k,E))break;++A}k=f.createDocumentFragment();for(x=v;x<g-A;)E=e[x].cloneNode(!0),k.appendChild(E),++x;for(x=h-A;--x>=v;)a.removeChild(c[x]);A?a.insertBefore(k,a.childNodes[v]):
a.appendChild(k)}function d(a,b){if(a.nodeName!==b.nodeName||a.nodeType!==b.nodeType)return!1;if(3===a.nodeType||8===a.nodeType)return a.nodeValue!==b.nodeValue&&(a.nodeValue=b.nodeValue),!0;if(a.isEqualNode&&a.isEqualNode(b))return!0;for(var d=a.attributes,e=b.attributes,f=e.length,h=d.length;0<=--h;){var g=d[h],k=g.namespaceURI,g=g.name;b.hasAttributeNS(k,g)||a.removeAttributeNS(k,g)}for(h=f;0<=--h;)d=e[h],k=d.namespaceURI,g=d.name,d=d.value,d!==a.getAttributeNS(k,g)&&a.setAttributeNS(k,g,d);c(a,
b);return!0}for(var f=b.ownerDocument,h=Na.fa(Aa(a),f),g=h.querySelectorAll("[data-s9e-livepreview-postprocess]"),k=g.length;0<=--k;){var e=g[k].getAttribute("data-s9e-livepreview-postprocess");Oa[e]||(Oa[e]=new Function(e));Oa[e].call(g[k])}c(b,h)}}};
		var text,
			textareaEl = document.getElementsByTagName('textarea')[0],
			previewEl = document.getElementById('preview');

		window.setInterval(function()
		{
			if (textareaEl.value === text)
			{
				return;
			}

			text = textareaEl.value;
			s9e.TextFormatter.preview(text, previewEl);
		}, 20);

		function toggle(el)
		{
			(el.checked) ? s9e.TextFormatter.enablePlugin(el.id)
			             : s9e.TextFormatter.disablePlugin(el.id);

			text = '';
		}
	</script>
	<script type="text/javascript" src="http://cdnjs.cloudflare.com/ajax/libs/punycode/1.0.0/punycode.min.js"></script>
</body>
</html>