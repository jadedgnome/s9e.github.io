<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8" />
	<title>s9e\TextFormatter &bull; Demo</title>
	<base href="http://s9e.github.io/TextFormatter/demo.html" />
	<style type="text/css">
		#preview
		{
			font-family: sans;
			padding: 5px;
			background-color: #f8f8f8;
			border: dashed 1px #8af;
			border-radius: 5px;
		}

		code
		{
			padding: 2px;
			background-color: #fff;
			border-radius: 3px;
			border: solid 1px #ddd;
		}
	</style>

</head>
<body>
	<div style="float:left;width:80%;max-width:800px">
		<form>
			<textarea style="width:99%" rows="15">[float=right][youtube]http://www.youtube.com/watch?v=QH2-TGUlwu4[/youtube][/float]

This is a demo of the JavaScript port of [url=https://github.com/s9e/TextFormatter/tree/master/src/ title="s9e\TextFormatter at GitHub.com"]s9e\TextFormatter[/url].

The following plugins have been enabled:

[list]
  [*][b]Autolink[/b] --- loose URLs such as http://github.com are automatically turned into links
  [*][b]BBCodes[/b]
  [list=circle]
    [*][b]bold[/b], [i]italic[/i], [u]underline[/u], [s]strikethrough[/s],
    [*][color=#f05]co[/color][color=#2f2]lo[/color][color=#02f]r,[/color]
    [*][C][URL][/C], [C:123][C][/C:123], [C][YOUTUBE][/C], [C][FLOAT][/C], and [C][LIST][/C]
    [*][C][CODE][/C] with real-time syntax highlighting via [url=http://softwaremaniacs.org/soft/highlight/en/]Highlight.js[/url]
	[code]$who = "world";
printf("Hello %s\n", $who);[/code]
  [/list]
  [*][b]Censor[/b] --- the word "apple" is censored and automatically replaced with "banana"
  [*][b]Emoticons[/b] --- one emoticon :) has been added
  [*][b]FancyPants[/b] --- some typography is enhanced, e.g. (c) (tm) and "quotes"
  [*][b]Generic[/b] --- the Generic plugin provides a way to perform generic regexp-based replacements that are HTML-safe. Here, text that matches [C]/#(?<tag>[a-z0-9]+)/i[/C] is replaced with the template [C]<a href="https://twitter.com/#!/search/%23{@tag}"><xsl:apply-templates/></a>[/C] -- For example: #PHP, #fml
  [*][b]HTMLElements[/b] --- [C]<a>[/C] and [C]<b>[/C] tags are allowed, with two whitelisted attributes for [C]<a>[/C]: [C]href[/C] and [C]title[/C]. Example: <a href="https://github.com" title="GitHub - Social Coding"><b>GitHub</b></a>
  [*][b]HTMLEntities[/b] --- HTML entities such as &amp;hearts; are decoded
[/list]

The parser/renderer used on this page page has been generated by [url=https://github.com/s9e/TextFormatter/blob/master/scripts/generateLiveDemo.php]this script[/url]. It's been minified with Google Closure Compiler to 20.3 KB (8.3 KB compressed)</textarea>
		</form>
	</div>

	<div style="float:left;">
		<form><input type="checkbox" id="Autolink" checked="checked" onchange="toggle(this)"><label for="Autolink">&nbsp;Autolink</label><br><input type="checkbox" id="BBCodes" checked="checked" onchange="toggle(this)"><label for="BBCodes">&nbsp;BBCodes</label><br><input type="checkbox" id="Censor" checked="checked" onchange="toggle(this)"><label for="Censor">&nbsp;Censor</label><br><input type="checkbox" id="Emoticons" checked="checked" onchange="toggle(this)"><label for="Emoticons">&nbsp;Emoticons</label><br><input type="checkbox" id="FancyPants" checked="checked" onchange="toggle(this)"><label for="FancyPants">&nbsp;FancyPants</label><br><input type="checkbox" id="Generic" checked="checked" onchange="toggle(this)"><label for="Generic">&nbsp;Generic</label><br><input type="checkbox" id="HTMLElements" checked="checked" onchange="toggle(this)"><label for="HTMLElements">&nbsp;HTMLElements</label><br><input type="checkbox" id="HTMLEntities" checked="checked" onchange="toggle(this)"><label for="HTMLEntities">&nbsp;HTMLEntities</label><br><input type="checkbox" id="MediaEmbed" checked="checked" onchange="toggle(this)"><label for="MediaEmbed">&nbsp;MediaEmbed</label></form>
	</div>

	<div style="clear:both"></div>

	<div id="preview"></div>

	<script type="text/javascript">function aa(a){var b=document.createElement("b");b.innerHTML=a.replace(/</g,"&lt;");return b.textContent}
function ba(a){var b=ca.urlConfig,c=l;a=a.replace(/^\s+/,"").replace(/\s+$/,"");var d=!1,e=!0;"//"===a.substr(0,2)&&(b.V?(a=b.V+":"+a,d=!0):b.ca||(a="http:"+a,d=!0,e=!1));a=a.replace(/["'()<>[\]\x00-\x20\x7F]+/g,escape).replace(/[^\u0020-\u007E]+/g,encodeURIComponent);var f=/^([a-z\d]+):\/\/(?:[^/]*@)?([^/]+)(?:\/.*)?$/i.exec(a);if(!f)return!1;if(e&&!b.T.test(f[1]))return c&&n(c,"err","URL scheme is not allowed",{attrValue:a,scheme:f[1]}),!1;e=f[2].replace(/[\u3002\uff0e\uff61]/g,".").replace(/\.+$/g,
"");if(b.X&&b.X.test(e)||b.da&&!b.da.test(e))return c&&n(c,"err","URL host is not allowed",{attrValue:a,host:f[2]}),!1;b=a.indexOf(":");return a=d?a.substr(b+1):a.substr(0,b).toLowerCase()+a.substr(b)}function p(){}p.prototype.J={};p.prototype.N=[];function n(a,b,c,d){d=d||{};"attrName"in d||!a.A||(d.attrName=a.A);"tag"in d||!a.H||(d.tag=a.H);a.J[b]&&a.J[b].forEach(function(a){a(c,d)});a.N.push([b,c,d])}p.prototype.get=function(){return this.N};p.prototype.on=function(a,b){this.J[a].push(b)};
p.prototype.l=function(a){this.A=a};function da(a){n(l,"debug","Skipping end tag with no start tag",a)}function q(a,b,c,d){this.m=a;this.h=b;this.g=c;this.o=d;isNaN(a+c+d)&&s(this);this.b={};this.K=[]}q.prototype.z=!1;q.prototype.s=0;function s(a){a.z||(a.z=!0,a.K.forEach(function(a){s(a)}))}function t(a,b){a.h===b.h&&(1===a.m&&2===b.m&&b.g>=a.g?(a.x=b,b.G=a):2===a.m&&1===b.m&&b.g<=a.g&&(a.G=b,b.x=a))}function u(a){var b={},c;for(c in a.b)b[c]=a.b[c];return b}
function v(a,b){return a.z||a.h!==b.h||1!==b.m||2!==a.m||a.g<b.g||a.G&&a.G!==b||b.x&&b.x!==a?!1:!0}q.prototype.l=function(a,b){this.b[a]=b};function x(a,b){a.b={};for(var c in b)a.b[c]=b[c]}
var l=new p,ca={urlConfig:{T:/^https?$/i,ca:0},mediasites:{"youtube.com":"youtube","youtu.be":"youtube"}},B={B:{c:[y],i:10,e:{a:2},j:1E3,k:0,d:[51],f:[63]},I:{c:[y],i:10,e:{a:2},j:1E3,k:0,d:[51],f:[63]},U:{c:[y],i:10,e:{a:2},j:1E3,k:0,d:[51],f:[63]},S:{c:[y],i:10,e:{a:2},j:1E3,k:0,d:[51],f:[63]},URL:{b:{url:{c:[A],n:1},title:{n:0}},c:[y],i:10,e:{a:66},j:1E3,k:1,d:[53],f:[61]},QUOTE:{b:{author:{n:0}},c:[y],i:10,e:{y:{B:1,I:1,U:1,S:1,URL:1,C:1,G60D5AB76:1,"html:a":1,"html:b":1},a:512},j:1E3,k:2,d:[55],
f:[63]},LIST:{b:{type:{c:[ea,fa],n:0}},c:[y],i:10,e:{y:{B:1,I:1,U:1,S:1,URL:1,C:1,G60D5AB76:1,"html:a":1,"html:b":1},a:672},j:1E3,k:2,d:[40],f:[63]},LI:{c:[y],i:10,e:{y:{B:1,I:1,U:1,S:1,URL:1,C:1,G60D5AB76:1,"html:a":1,"html:b":1},Q:{LI:1},a:512},j:1E3,k:3,d:[55],f:[63]},C:{c:[y],i:10,e:{a:18},j:1E3,k:0,d:[0],f:[0]},COLOR:{b:{color:{c:[ga],n:1}},c:[y],i:10,e:{a:0},j:1E3,k:0,d:[51],f:[63]},FLOAT:{b:{"float":{c:[ha],n:1}},c:[y],i:10,e:{y:{B:1,I:1,U:1,S:1,URL:1,C:1,G60D5AB76:1,"html:a":1,"html:b":1},
a:512},j:1E3,k:2,d:[55],f:[63]},CODE:{b:{lang:{c:[ia],n:0}},c:[y],i:10,e:{y:{B:1,I:1,U:1,S:1,URL:1,C:1,G60D5AB76:1,"html:a":1,"html:b":1},a:912},j:1E3,k:2,d:[0],f:[0]},CENSOR:{b:{"with":{n:0}},c:[y],i:10,e:{a:145},j:1E3,k:4,d:[0],f:[0]},E:{c:[y],i:10,e:{a:129},j:1E3,k:0,d:[48],f:[63]},G60D5AB76:{b:{tag:{c:[ja],n:1}},c:[y],i:10,e:{a:66},j:1E3,k:1,d:[53],f:[61]},"html:a":{b:{href:{c:[A],n:0},title:{n:0}},c:[y],i:10,e:{a:66},j:1E3,k:1,d:[53],f:[61]},"html:b":{c:[y],i:10,e:{a:2},j:1E3,k:0,d:[51],f:[63]},
HE:{b:{"char":{n:1}},c:[y],i:10,e:{a:129},j:1E3,k:4,d:[48],f:[63]},FP:{b:{"char":{n:1}},c:[y],i:10,e:{a:129},j:1E3,k:4,d:[48],f:[63]},MEDIA:{c:[ka],i:10,e:{a:81},j:1E3,k:5,d:[0],f:[0]},YOUTUBE:{b:{url:{c:[A],n:0},id:{c:[la],n:1},t:{c:[ma],n:0}},P:[["url",/youtube\.com\/(?:watch\?.*?v=|v\/)([-0-9A-Z_a-z]+)/,["","id"]],["url",/youtu\.be\/([-0-9A-Z_a-z]+)/,["","id"]],["url",/[#&?]t=(\d+)/,["","t"]],["url",/^([-0-9A-Z_a-z]+)$/,["","id"]]],c:[na,y],i:10,e:{a:145},j:1E3,k:1,d:[0],f:[0]}},D,F,oa;
function pa(a){a=a.replace(/\r\n?/g,"\n",a);a=a.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F]+/g,"",a);var b=l;b.N=[];delete b.A;delete b.H;G=0;I=!1;qa={};J="";D=a;F=D.length;L=[];oa=Math.random();M=0;N=!1;a=oa;for(var c in P)if(b=P[c],!(b.M||b.v&&0>D.indexOf(b.v))){var d=[];if(b.r){var d=b.r,e=[],f=void 0;for(d.lastIndex=0;f=d.exec(D);){for(var k=parseInt(f.index,10),h=[[f[0],k]],g=0;++g<f.length;){var m=f[g];void 0===m?h.push(["",-1]):(h.push([m,D.indexOf(m,k)]),k+=m.length)}e.push(h)}d=e;e=d.length;if(!e)continue;
e>b.q&&(d=d.slice(0,b.q),e={pluginName:c,limit:b.q},"warn"===b.w&&n(l,"warn","Regexp limit exceeded. Only the allowed number of matches will be processed",e))}b.p(D,d)}ra();if(oa!==a)throw"The parser has been reset during execution";return J}function sa(a,b){b.P&&b.P.forEach(function(b){var d=b[0],e=b[1];b=b[2];if(d in a.b){var f;(f=e.exec(a.b[d]))&&b.forEach(function(b,c){var e=f[c];""!==b&&(b!==d&&b in a.b||a.l(b,e))})}});return!0}var I,qa,J,M;
function ta(a){var b={"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;"};return a.replace(/[<>&"]/g,function(a){return b[a]})}function ua(a){var b={"<":"&lt;",">":"&gt;","&":"&amp;"};return a.replace(/[<>&]/g,function(a){return b[a]})}function va(){var a;Q<F&&R(F,0,!0);S();do a=J,J=J.replace(/<((?:\w+:)?\w+)[^>]*><\/\1>/g,"");while(J!==a);J=J.replace(/<\/i><i>/g,"",J);var b=I?"rt":"pt";a="<"+b;for(var c in qa)a+=" xmlns:"+c+'="urn:s9e:TextFormatter:'+c+'"';J=a+">"+J+"</"+b+">"}
function wa(a){I=!0;var b=a.h,c=a.g,d=a.o,e=0,f=0;a.a&512&&(e=a.m&1?2:1,f=a.m&2?2:1);var k=!1;a.m&1||(k=!0);R(c,e,k);e=d?ua(D.substr(c,d)):"";if(a.m&1){k=b.indexOf(":");0<k&&(qa[b.substr(0,k)]=0);J+="<"+b;var h=u(a),k=[],g;for(g in h)k.push([g]);k.sort(function(a,b){return a>b?1:-1});k.forEach(function(a){J+=" "+a+'="'+ta(h[a].toString())+'"'});J=3===a.m?d?J+(">"+e+"</"+b+">"):J+"/>":d?J+("><st>"+e+"</st>"):J+">"}else d&&(J+="<et>"+e+"</et>"),J+="</"+b+">";for(M=Q=c+d;f&&M<F&&"\n"===D.charAt(M);)--f,
++M}function R(a,b,c){Q>=a&&c&&S();if(M>Q){var d=Math.min(a,M);J+=D.substr(Q,d-Q);Q=d;d===a&&c&&S()}if(T.a&32)b=a-Q,b=D.substr(Q,b),/^[ \n\t]*$/.test(b)||(b="<i>"+b+"</i>"),J+=b,Q=a,c&&S();else{var e=a,d=0;if(c&&T.L)for(;0<=--e&&"\n"===D.charAt(e);)++d;for(;b&&--e>=Q;){var f=D.charAt(e);if(" "!==f&&"\n"!==f&&"\t"!==f)break;"\n"===f&&--b;++d}a-=d;a>Q&&(b=ua(D.substr(Q,a-Q)),T.a&128||(b=b.replace(/\n/g,"<br/>\n")),J+=b);c&&S();d&&(J+=D.substr(a,d));Q=a+d}}
function xa(a){var b=a.g;a=a.o;var c=D.substr(b,a);R(b,0,!1);J+="<i>"+ua(c)+"</i>";I=!0;Q=b+a}function S(){T.L&&(J+="</p>",T.L=!1)}
var P={BBCodes:{v:"[",r:/\[\/?([*BIS]|C(?:O(?:DE|LOR))?|FLOAT|LIST|MEDIA|QUOTE|U(?:RL)?|YOUTUBE)(?=[\] =:\/])/ig,q:1E4,w:"warn",p:function(a,b){var c={B:{},I:{},U:{},S:{},URL:{D:["url"]},QUOTE:{F:"author"},LIST:{F:"type"},"*":{O:"LI"},C:{},COLOR:{},FLOAT:{},CODE:{F:"lang"},MEDIA:{D:["url"]},YOUTUBE:{D:["url"],F:"url"}};b.forEach(function(b){var e=b[1][0].toUpperCase(),f=c[e]||{},k=f.O||e,h=b[0][1],g=h+b[0][0].length;":"===a.charAt(g)?(b=/^:\d*/.exec(a.substr(g))[0],g+=b.length):b="";if("/"===a.charAt(h+
1))"]"===a.charAt(g)&&""===b&&U(2,k,h,1+g-h);else{var m=1,H={},V=!1,Fa=g,O,r;if(f.R)for(O in f.R)H[O]=f.R[O];for(;g<F;)if(r=a.charAt(g)," "===r)++g;else{if("]"===r||"/"===r){if("/"===r&&(m=3,++g,g===F||"]"!==a.charAt(g)))return;V=!0;++g;break}var K=/^[-\w]*/.exec(a.substr(g))[0].length;if(K){if(g+K>=F)return;O=a.substr(g,K).toLowerCase();g+=K;if("="!==a.charAt(g))continue}else if("="===r&&g===Fa)O=f.F||e.toLowerCase();else return;if(++g>=F)return;r=a.charAt(g);if('"'===r||"'"===r){for(K=g+1;;){++g;
g=a.indexOf(r,g);if(0>g)return;for(var E=0;"\\"===a.charAt(g-++E););if(E%2)break}r=a.substr(K,g-K).replace(/\\([\\'"])/g,"$1");++g}else{r=/[^\]]*?(?=\s*(?: \/)?\]|\s+[-\w]+=)/.exec(a.substr(g));if(!r)continue;r=r[0];g+=r.length}H[O]=r}if(V){if(1===m){var w=[];f.D&&f.D.forEach(function(a){a in H||w.push(a)});var C;if(w.length||b||f.Y){r="[/"+e+b+"]";var z=a.toUpperCase().indexOf(r,g);if(0>z){if(b||f.Y)return}else w.forEach(function(b){H[b]=a.substr(g,z-g)}),C=U(2,k,z,r.length)}e=U(1,k,h,g-h);C&&t(e,
C)}else e=U(3,k,h,g-h);x(e,H)}}})}},Censor:{r:/(?:^|\W)apple(?!\w)/gi,q:1E4,w:"warn",p:function(a,b){var c=[[/^apple$/i,"banana"]];b.forEach(function(a){var b=/^\W/.test(a[0][0])?1:0,f=a[0][0].substr(b);a=U(3,"CENSOR",a[0][1]+b,f.length);if(c)for(b=0;b<c.length;++b){var k=c[b][1];if(c[b][0].test(f)){a.l("with",k);break}}})}},Emoticons:{v:":)",r:/:\)/g,q:1E4,w:"warn",p:function(a,b){var c={O:"E"};b.forEach(function(b){c.$&&b[0][1]&&c.$.test(a.charAt(b[0][1]-1))||U(3,c.O,b[0][1],b[0][0].length)})}},
Generic:{p:function(a){[["G60D5AB76",/#([a-z0-9]+)/ig,0,["","tag"]]].forEach(function(b){var c=b[0],d=b[1],e=b[2];b=b[3];var f;for(d.lastIndex=0;f=d.exec(a);){var k=f.index,h=f[0].length,g;if(e&&""!==f[e]){var m=a.indexOf(f[e],k),H=f[e].length,V=m-k;g=ya(c,k,V,m+H,h-(V+H))}else g=U(3,c,k,h);b.forEach(function(a,b){a&&g.l(a,f[b])})}})}},HTMLElements:{v:"<",r:/<(?:\/([ab])|([ab])((?:\s+[a-z][-a-z]*(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s"'=<>`]+))?)*)\s*\/?)\s*>/ig,q:1E4,w:"warn",p:function(a,b){var c={ba:"html"};
b.forEach(function(b){var e="/"===a.charAt(b[0][1]+1),f=b[0][1],k=b[0][0].length,h=b[2-e][0].toLowerCase(),g=c.u&&c.u[h]&&c.u[h][""]?c.u[h][""]:c.ba+":"+h;if(e)U(2,g,f,k);else for(var e="/>"===b[0][0].substr(k-2)?ya(g,f,k,f+k,0):U(1,g,f,k),k=/[a-z][-a-z]*(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s"'=<>`]+))?/gi,m;m=k.exec(b[3][0]);)f=m[0].indexOf("="),0>f&&(f=m[0].length,m[0]+="="+m[0].toLowerCase()),g=m[0].substr(0,f).toLowerCase().replace(/^\s+/,"").replace("/s+$/",""),f=m[0].substr(1+f).replace(/^\s+/,"").replace("/s+$/",
""),c.u&&c.u[h]&&c.u[h][g]&&(g=c.u[h][g]),/^["']/.test(f)&&(f=f.substr(1,f.length-2)),e.l(g,aa(f))})}},Autolink:{v:"://",r:/https?:\/\/\S(?:[^\s\[\]]*(?:\[\w*\])?)+/ig,q:1E4,w:"warn",p:function(a,b){b.forEach(function(a){for(var b=a[0][0];;)if(b=b.replace(/[\s!"',.<>?]+$/,""),")"===b.substr(-1)&&b.replace(/[^(]+/g,"").length<b.replace(/[^)]+/g,"").length)b=b.substr(0,b.length-1);else break;var e=U(1,"URL",a[0][1],0);e.l("url",b);a=U(2,"URL",a[0][1]+b.length,0);t(e,a)})}},HTMLEntities:{v:"&",r:/&(?:[a-z]+|#(?:[0-9]+|x[0-9a-f]+));/ig,
q:1E4,w:"warn",p:function(a,b){b.forEach(function(a){var b=a[0][0],e=aa(b);e!==b&&U(3,"HE",a[0][1],b.length).l("char",e)})}},FancyPants:{p:function(a){function b(b,e,f,g){for(;h=e.exec(a);){var k=U(3,d,h.index+h[0].indexOf(b),1),m=U(3,d,h.index+h[0].length-1,1);k.l(c,f);m.l(c,g);k.K.push(m);k.z&&s(m)}}var c="char",d="FP",e=0<=a.indexOf("'"),f=0<=a.indexOf('"'),k,h,g,m;if(e)for(k=/[a-z]'|(?:^|\s)'(?=[a-z]|[0-9]{2})/gi;h=k.exec(a);)tag=U(3,d,h.index+h[0].indexOf("'"),1),tag.l(c,"\u2019"),tag.s=10;if(e||
f||0<=a.indexOf("x"))for(k=/[0-9](?:'s|["']? ?x(?= ?[0-9])|["'])/g;h=k.exec(a);)if(g=h.index+h[0].length-1,"x"===h[0].charAt(g)&&U(3,d,g,1).l(c,"\u00d7"),m=h[0].charAt(1),"'"===m||'"'===m)g=1+h.index,m="'s"===h[0].substr(1,2)?"\u2019":"'"===m?"\u2032":"\u2033",U(3,d,g,1).l(c,m);e&&b("'",/(?:^|\W)'.+?'(?!\w)/g,"\u2018","\u2019");f&&b('"',/(?:^|\W)".+?"(?!\w)/g,"\u201c","\u201d");if(0<=a.indexOf("...")||0<=a.indexOf("--"))for(k=/---?|\.\.\./g;h=k.exec(a);)g=h.index,e=h[0].length,m={"--":"\u2013","---":"\u2014",
"...":"\u2026"}[h[0]],U(3,d,g,e).l(c,m);if(0<=a.indexOf("("))for(k=/\((?:c|r|tm)\)/gi;h=k.exec(a);)g=h.index,e=h[0].length,m={"(c)":"\u00a9","(r)":"\u00ae","(tm)":"\u2122"}[h[0].toLowerCase()],U(3,d,g,e).l(c,m)}},MediaEmbed:{v:"://",r:/\bhttps?:\/\/(?:[-\w]+\.)*youtu(?:\.be|be\.com)\/[^["'\s]+(?!\S)/g,q:1E4,w:"warn",p:function(a,b){b.forEach(function(a){var b=a[0][0];a=U(3,"MEDIA",a[0][1],b.length);a.l("url",b);a.s=-10})}}},W,X,T,G,Y,Z=1E3,$,Q,za={d:[55],f:[63],a:0};
function Aa(a,b){var c=a.h;a.a&512&&(b=Ba(b));t(U(2,c,b,0),a)}function Ba(a){for(;a>Q&&-1<" \n\t".indexOf(D.charAt(a-1));)--a;return a}function ra(){Q=0;W={};X={};$=[];Y=null;T=za;T.L=!1;for(var a in B)W[a]=0,X[a]=0;do{for(;L.length;)N||(L.sort(Ca),N=!0),Y=L.pop(),T.a&16&&!v(Y,$[$.length-1])||Da();$.forEach(function(a){Aa(a,F)})}while(L.length);va()}
function Da(){if(!Y.z){var a=Y.g,b=Y.o;if(a+b>F)s(Y);else if(Q>a){var c;if((c=Y.G)&&0<=$.indexOf(c))a=Math.max(0,a+b-Q),a=U(2,c.h,Q,a),t(a,c);else{if("i"===Y.h&&(c=a+b-Q,0<c)){U(3,"i",Q,c);return}s(Y)}}else if("i"===Y.h)xa(Y);else if("br"===Y.h)T.a&128||(R(Y.g,0,!1),J+="<br/>");else if("pb"===Y.h)R(Y.g,0,!0);else if(Y.m&1)if(c=Y,a=c.h,b=B[a],X[a]>=b.j)n(l,"err","Tag limit exceeded",{tag:c,tagName:a,tagLimit:b.j}),s(c);else{var d=c,e=B[d.h],f=!0;if(e.c){l.H=d;for(var k=0;k<e.c.length;++k)if(!e.c[k](d,
e)){f=!1;break}delete l.H}if(f){a:{d=c;if($.length&&(f=d.h,k=B[f],k.e.y)){var e=$[$.length-1],h=e.h;if(k.e.y[h]){h!==f&&G<Z&&(f=Ea(e,d.g+d.o),d.K.push(f),d.z&&s(f));++G;L.push(d);Aa(e,d.g);d=!0;break a}}d=!1}if(!d){a:{d=c;if($.length&&(e=B[d.h],e.e.Q&&(f=$[$.length-1],e.e.Q[f.h]))){L.push(d);Aa(f,d.g);d=!0;break a}d=!1}d=d||!1}d||(W[a]>=b.i?(n(l,"err","Nesting limit exceeded",{tag:c,tagName:a,nestingLimit:b.i}),s(c)):(b=B[a].k,T.d[b>>5]&1<<(b&31)?(c.a&1&&!c.x&&(a=new q(3,a,c.g,c.o),x(a,u(c)),a.a=
c.a,c=a),wa(c),Ga(c)):(n(l,"warn","Tag is not allowed in this context",{tag:c,tagName:a}),s(c))))}else s(c)}else Ha()}}
function Ha(){var a=Y;if(W[a.h]){for(var b=[],c=$.length;0<=--c;){var d=$[c];if(v(a,d))break;if(++G>Z)throw"Fixing cost exceeded";b.push(d)}if(0>c)da({tag:a});else{var e=G<Z,f=[];b.forEach(function(b){var c=b.h;e&&(b.a&2?f.push(b):e=!1);var d=a.g;b.a&512&&(d=Ba(d));c=new q(2,c,d,0);c.a=b.a;wa(c);Ia()});wa(a);Ia();if(b.length&&G<Z){d=Q;for(c=L.length;0<=--c&&++G<Z;){var k=L[c];if(k.g>d||k.m&1)break;for(var h=b.length;0<=--h&&++G<Z;)if(v(k,b[h])){b.splice(h,1);f[h]&&f.splice(h,1);d=Math.max(d,k.g+k.o);
break}}d>Q&&xa(new q(3,"i",Q,d-Q))}f.forEach(function(a){var b=Ea(a,Q);(a=a.x)&&t(b,a)})}}}function Ia(){var a=$.pop();--W[a.h];T=T.aa}function Ga(a){function b(a,b){for(var c=-1,d=a.length,e=Array(d);++c<d;)e[c]=a[c]&b[c];return e}var c=a.h,d=a.a,e=B[c];++X[c];3!==a.m&&(++W[c],$.push(a),a=b(e.d,e.d),d&64&&(a=b(a,T.d)),e=b(T.f,e.f),a=b(a,e),T.a&256&&(d|=256),d&256&&(d|=128),T={d:a,f:e,a:d,aa:T})}var L,N;function Ea(a,b){var c=U(a.m,a.h,b,0);x(c,u(a));c.s=a.s;return c}
function U(a,b,c,d){a=new q(a,b,c,d);B[b]&&(a.a=B[b].e.a);B[b]||"i"===b||"br"===b||"pb"===b?B[b].M?(n(l,"warn","Tag is disabled",{tag:a,tagName:b}),s(a)):0>d||0>c?s(a):(L.length&&c>L[L.length-1].g&&(N=!1),L.push(a)):s(a);return a}function ya(a,b,c,d,e){b=U(1,a,b,c);t(b,U(2,a,d,e));return b}function Ca(a,b){var c=a.g,d=b.g;if(c!==d)return d-c;if(a.s!==b.s)return b.s-a.s;c=a.o;d=b.o;return c&&d?c-d:c||d?c?-1:1:(c={2:0,3:1,1:2},c[b.m]-c[a.m])}var Ja=new XSLTProcessor;
Ja.importStylesheet((new DOMParser).parseFromString('<?xml version="1.0" encoding="utf-8"?><xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:html="urn:s9e:TextFormatter:html" exclude-result-prefixes="html"><xsl:output method="html" encoding="utf-8" indent="no"/><xsl:template match="p"><p><xsl:apply-templates/></p></xsl:template><xsl:template match="br"><br/></xsl:template><xsl:template match="et|i|st"/><xsl:template match="B|html:b"><b><xsl:apply-templates/></b></xsl:template><xsl:template match="I"><i><xsl:apply-templates/></i></xsl:template><xsl:template match="U"><u><xsl:apply-templates/></u></xsl:template><xsl:template match="S"><s><xsl:apply-templates/></s></xsl:template><xsl:template match="URL"><a href="{@url}"><xsl:copy-of select="@title"/><xsl:apply-templates/></a></xsl:template><xsl:template match="QUOTE"><blockquote><xsl:if test="not(@author)"><xsl:attribute name="class">uncited</xsl:attribute></xsl:if><div><xsl:if test="@author"><cite><xsl:value-of select="@author"/> wrote:</cite></xsl:if><xsl:apply-templates/></div></blockquote></xsl:template><xsl:template match="LIST"><xsl:choose><xsl:when test="not(@type)"><ul><xsl:apply-templates/></ul></xsl:when><xsl:when test="contains(\'upperlowerdecim\',substring(@type,1,5))"><ol style="list-style-type:{@type}"><xsl:apply-templates/></ol></xsl:when><xsl:otherwise><ul style="list-style-type:{@type}"><xsl:apply-templates/></ul></xsl:otherwise></xsl:choose></xsl:template><xsl:template match="LI"><li><xsl:apply-templates/></li></xsl:template><xsl:template match="C"><code class="inline"><xsl:apply-templates/></code></xsl:template><xsl:template match="COLOR"><span style="color:{@color}"><xsl:apply-templates/></span></xsl:template><xsl:template match="FLOAT"><div style="float:{@float}"><xsl:apply-templates/></div></xsl:template><xsl:template match="CODE"><pre data-s9e-livepreview-postprocess="if(\'undefined\'!==typeof hljs){{var a=this.innerHTML;a in hljs._?this.innerHTML=hljs._[a]:(Object.keys&amp;&amp;7&lt;Object.keys(hljs._).length&amp;&amp;(hljs._={{}}),hljs.highlightBlock(this.firstChild),hljs._[a]=this.innerHTML)}};"><code class="{@lang}"><xsl:apply-templates/></code></pre><xsl:if test="not(following::CODE)"><script>if("undefined"===typeof hljs){var a=document.getElementsByTagName("head")[0],b=document.createElement("link");b.type="text/css";b.rel="stylesheet";b.href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/7.3/styles/github.min.css";a.appendChild(b);b=document.createElement("script");b.type="text/javascript";b.onload=function(){hljs._={};hljs.initHighlighting()};b.async=!0;b.src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/7.3/highlight.min.js";a.appendChild(b)};\x3c/script></xsl:if></xsl:template><xsl:template match="CENSOR">****</xsl:template><xsl:template match="CENSOR[@with]"><xsl:value-of select="@with"/></xsl:template><xsl:template match="E"><xsl:choose><xsl:when test=".=\':)\'"><img src="s.png" alt=":)"/></xsl:when><xsl:otherwise><xsl:value-of select="."/></xsl:otherwise></xsl:choose></xsl:template><xsl:template match="G60D5AB76"><a href="https://twitter.com/#!/search/%23{@tag}"><xsl:apply-templates/></a></xsl:template><xsl:template match="html:a"><a><xsl:copy-of select="@href"/><xsl:copy-of select="@title"/><xsl:apply-templates/></a></xsl:template><xsl:template match="FP|HE"><xsl:value-of select="@char"/></xsl:template><xsl:template match="YOUTUBE"><iframe width="240" height="180" src="http://www.youtube.com/embed/{@id}" allowfullscreen=""/></xsl:template></xsl:stylesheet>',"text/xml"));
var Ka={};function y(a,b){var c;a:{c=l;if(b.b){var d,e;for(d in b.b)e=b.b[d],e.Z&&a.l(d,e.Z(d));var f=u(a);for(d in f){var k=f[d];if(b.b[d]){if(e=b.b[d],e.c){c.l(d);for(var h=0;h<e.c.length;++h)if(k=e.c[h](k,d),!1===k){delete a.b[d];break}!1!==k&&a.l(d,k);delete c.A}}else delete a.b[d]}for(d in b.b)if(e=b.b[d],!(d in a.b))if(void 0!==e.W)a.l(d,e.W);else if(e.n){c=!1;break a}}else x(a,{});c=!0}return c}function A(a){return ba(a)}
function ea(a){a:for(var b=[[/^1$/,"decimal"],[/^a$/,"lower-alpha"],[/^A$/,"upper-alpha"],[/^i$/,"lower-roman"],[/^I$/,"upper-roman"]],c=-1,d=b.length;++c<d;)if(b[c][0].test(a)){a=b[c][1];break a}return a}function fa(a){return/^[-\w+., ]+$/.test(a)?a:!1}function ga(a){return/^(?:#[0-9a-f]{3,6}|rgb\(\d{1,3}, *\d{1,3}, *\d{1,3}\)|[a-z]+)$/i.test(a)?a:!1}function ha(a){return/^(?:left|none|right)$/i.test(a)?a:!1}function ia(a){return/^[-\w]+$/.test(a)?a:!1}
function ja(a){return/^([a-z0-9]+)$/i.test(a)?a:!1}function ka(a){var b=ca.mediasites,c;if("media"in a.b)c=a.b.media,!("id"in a.b)&&"url"in a.b&&-1===a.b.url.indexOf("://")&&a.l("id",a.b.url);else if("url"in a.b){var d=/^(?:([^:]+):)?(?:\/\/([^\/]+))?/.exec(a.b.url);if(d[1]&&b[d[1]+":"])c=b[d[1]+":"];else if(d[2]){d=d[2];do{if(b[d]){c=b[d];break}var e=d.indexOf(".");if(-1==e)break;d=d.substr(1+e)}while(""<d)}}c&&(b=a.x||a,d=a.g,x(U(3,c.toUpperCase(),d,b.g+b.o-d),u(a)));return!1}
function na(a,b){return sa(a,b)}function la(a){return/^(?:[-0-9A-Z_a-z]+)$/.test(a)?a:!1}function ma(a){return/^(?:\d+)$/.test(a)?a:!1}
window.s9e={TextFormatter:{disablePlugin:function(a){P[a]&&(P[a].M=!0)},enablePlugin:function(a){P[a]&&(P[a].M=!1)},preview:function(a,b){function c(a,b){for(var c=a.childNodes,e=b.childNodes,g=c.length,k=e.length,h,E,w=0,C=0;w<g&&w<k;){h=c[w];E=e[w];if(!d(h,E))break;++w}for(var z=Math.min(g-w,k-w);C<z;){h=c[g-(C+1)];E=e[k-(C+1)];if(!d(h,E))break;++C}h=f.createDocumentFragment();for(z=w;z<k-C;)E=e[z].cloneNode(!0),h.appendChild(E),++z;for(z=g-C;--z>=w;)a.removeChild(c[z]);C?a.insertBefore(h,a.childNodes[w]):
a.appendChild(h)}function d(a,b){if(a.nodeName!==b.nodeName||a.nodeType!==b.nodeType)return!1;if(3===a.nodeType)return a.nodeValue!==b.nodeValue&&(a.nodeValue=b.nodeValue),!0;if(a.isEqualNode&&a.isEqualNode(b))return!0;for(var d=a.attributes,e=b.attributes,f=e.length,g=d.length;0<=--g;){var h=d[g],k=h.namespaceURI,h=h.name;b.hasAttributeNS(k,h)||a.removeAttributeNS(k,h)}for(g=f;0<=--g;)d=e[g],k=d.namespaceURI,h=d.name,d=d.value,d!==a.getAttributeNS(k,h)&&a.setAttributeNS(k,h,d);c(a,b);return!0}for(var e=
pa(a),e=(new DOMParser).parseFromString(e,"text/xml"),f=b.ownerDocument,e=f.importNode(Ja.transformToFragment(e,f),!0),k=e.querySelectorAll("[data-s9e-livepreview-postprocess]"),h=k.length;0<=--h;){var g=k[h].getAttribute("data-s9e-livepreview-postprocess");Ka[g]||(Ka[g]=new Function(g));Ka[g].call(k[h])}c(b,e)}}};
		var text,
			textareaEl = document.getElementsByTagName('textarea')[0],
			previewEl = document.getElementById('preview');

		window.setInterval(function()
		{
			if (textareaEl.value === text)
			{
				return;
			}

			text = textareaEl.value;
			s9e.TextFormatter.preview(text, previewEl);
		}, 20);

		function toggle(el)
		{
			(el.checked) ? s9e.TextFormatter.enablePlugin(el.id)
			             : s9e.TextFormatter.disablePlugin(el.id);

			text = '';
		}
	</script>
</body>
</html>